{"version":3,"file":"bundles/14d44db70ea60b163e50/bundle.js","mappings":";UACIA,EADAC,ECAAC,EACAC,ECDAC,iLCCJ,SAASC,EAAgBC,EAAGC,EAAGC,GAC7B,OAAQD,GAAI,OAAcA,MAAOD,EAAIG,OAAOC,eAAeJ,EAAGC,EAAG,CAC/DI,MAAOH,EACPI,YAAY,EACZC,cAAc,EACdC,UAAU,IACPR,EAAEC,GAAKC,EAAGF,CACjB,qKCPA,SAASS,EAAYP,EAAGD,GACtB,GAAI,WAAY,OAAQC,KAAOA,EAAG,OAAOA,EACzC,IAAIF,EAAIE,EAAEQ,OAAOD,aACjB,QAAI,IAAWT,EAAG,CAChB,IAAIW,EAAIX,EAAEY,KAAKV,EAAGD,GAAK,WACvB,GAAI,WAAY,OAAQU,GAAI,OAAOA,EACnC,MAAM,IAAIE,UAAU,+CACtB,CACA,OAAQ,WAAaZ,EAAIa,OAASC,QAAQb,EAC5C,uOCRA,SAASc,EAAcd,GACrB,IAAIS,GAAI,OAAYT,EAAG,UACvB,MAAO,WAAY,OAAQS,GAAKA,EAAIA,EAAI,EAC1C,gFCLA,SAASM,EAAQC,GAGf,OAAOD,EAAU,mBAAqBP,QAAU,iBAAmBA,OAAOS,SAAW,SAAUD,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqBR,QAAUQ,EAAEE,cAAgBV,QAAUQ,IAAMR,OAAOW,UAAY,gBAAkBH,CACpH,EAAGD,EAAQC,EACb,qGCNAI,EAAQ,EACR,WACI,OAAQC,KAAKC,SACjB,kICLA,SAMC,WACG,aAEI,EAMA,WAIJ,IAAIC,EAAO,WAAY,EACnBC,EAAgB,YAChBC,SAAeC,SAAWF,UAA0BE,OAAOC,YAAcH,GACzE,kBAAkBI,KAAKF,OAAOC,UAAUE,WAGxCC,EAAa,CACb,QACA,QACA,OACA,OACA,SAGAC,EAAiB,CAAC,EAClBC,EAAgB,KAGpB,SAASC,EAAWC,EAAKC,GACrB,IAAIC,EAASF,EAAIC,GACjB,GAA2B,mBAAhBC,EAAOC,KACd,OAAOD,EAAOC,KAAKH,GAEnB,IACI,OAAOI,SAASnB,UAAUkB,KAAK3B,KAAK0B,EAAQF,EAChD,CAAE,MAAOpC,GAEL,OAAO,WACH,OAAOwC,SAASnB,UAAUoB,MAAMA,MAAMH,EAAQ,CAACF,EAAKM,WACxD,CACJ,CAER,CAGA,SAASC,IACDC,QAAQC,MACJD,QAAQC,IAAIJ,MACZG,QAAQC,IAAIJ,MAAMG,QAASF,WAG3BF,SAASnB,UAAUoB,MAAMA,MAAMG,QAAQC,IAAK,CAACD,QAASF,aAG1DE,QAAQE,OAAOF,QAAQE,OAC/B,CAIA,SAASC,EAAWV,GAKhB,MAJmB,UAAfA,IACAA,EAAa,cAGNO,UAAYlB,IAEG,UAAfW,GAA0BV,EAC1BgB,OACwBK,IAAxBJ,QAAQP,GACRF,EAAWS,QAASP,QACJW,IAAhBJ,QAAQC,IACRV,EAAWS,QAAS,OAEpBnB,EAEf,CAIA,SAASwB,IAKL,IAHA,IAAIC,EAAQC,KAAKC,WAGRzC,EAAI,EAAGA,EAAIqB,EAAWqB,OAAQ1C,IAAK,CACxC,IAAI0B,EAAaL,EAAWrB,GAC5BwC,KAAKd,GAAe1B,EAAIuC,EACpBzB,EACA0B,KAAKG,cAAcjB,EAAYa,EAAOC,KAAKI,KACnD,CAMA,GAHAJ,KAAKN,IAAMM,KAAKK,aAGLZ,UAAYlB,GAAiBwB,EAAQC,KAAKM,OAAOC,OACxD,MAAO,kCAEf,CAIA,SAASC,EAAgCtB,GACrC,OAAO,kBACQO,UAAYlB,IACnBuB,EAAsBrC,KAAKuC,MAC3BA,KAAKd,GAAYI,MAAMU,KAAMT,WAErC,CACJ,CAIA,SAASkB,EAAqBvB,EAAYwB,EAAQC,GAE9C,OAAOf,EAAWV,IACXsB,EAAgClB,MAAMU,KAAMT,UACvD,CAEA,SAASqB,EAAOR,EAAMS,GAEpB,IASIC,EAMAC,EAMAC,EArBAC,EAAOjB,KAuBPkB,EAAa,WAOjB,SAASC,EAAuBC,GAC5B,IAAIC,GAAaxC,EAAWuC,IAAa,UAAUE,cAEnD,UAAW7C,SAAWF,GAAkB2C,EAAxC,CAGA,IAEI,YADAzC,OAAO8C,aAAaL,GAAcG,EAEtC,CAAE,MAAOG,GAAS,CAGlB,IACI/C,OAAOgD,SAASC,OACdC,mBAAmBT,GAAc,IAAMG,EAAY,GACzD,CAAE,MAAOG,GAAS,CAZwC,CAa9D,CAEA,SAASI,IACL,IAAIC,EAEJ,UAAWpD,SAAWF,GAAkB2C,EAAxC,CAEA,IACIW,EAAcpD,OAAO8C,aAAaL,EACtC,CAAE,MAAOM,GAAS,CAGlB,UAAWK,IAAgBtD,EACvB,IACI,IAAImD,EAASjD,OAAOgD,SAASC,OACzBI,EAAaH,mBAAmBT,GAChCa,EAAWL,EAAOM,QAAQF,EAAa,MACzB,IAAdC,IACAF,EAAc,WAAWI,KACrBP,EAAOQ,MAAMH,EAAWD,EAAW5B,OAAS,IAC9C,GAEV,CAAE,MAAOsB,GAAS,CAQtB,YAJiC3B,IAA7BoB,EAAKX,OAAOuB,KACZA,OAAchC,GAGXgC,CAzBmD,CA0B9D,CAEA,SAASM,IACL,UAAW1D,SAAWF,GAAkB2C,EAAxC,CAGA,IACIzC,OAAO8C,aAAaa,WAAWlB,EACnC,CAAE,MAAOM,GAAS,CAGlB,IACI/C,OAAOgD,SAASC,OACdC,mBAAmBT,GAAc,0CACvC,CAAE,MAAOM,GAAS,CAXwC,CAY9D,CAEA,SAASa,EAAeC,GACpB,IAAIvC,EAAQuC,EAIZ,GAHqB,iBAAVvC,QAA2DF,IAArCoB,EAAKX,OAAOP,EAAMuB,iBAC/CvB,EAAQkB,EAAKX,OAAOP,EAAMuB,gBAET,iBAAVvB,GAAsBA,GAAS,GAAKA,GAASkB,EAAKX,OAAOC,OAChE,OAAOR,EAEP,MAAM,IAAIrC,UAAU,6CAA+C4E,EAE3E,CAhFoB,iBAATlC,EACTc,GAAc,IAAMd,EACK,iBAATA,IAChBc,OAAarB,GAqFfoB,EAAKb,KAAOA,EAEZa,EAAKX,OAAS,CAAE,MAAS,EAAG,MAAS,EAAG,KAAQ,EAAG,KAAQ,EACvD,MAAS,EAAG,OAAU,GAE1BW,EAAKd,cAAgBU,GAAWJ,EAEhCQ,EAAKhB,SAAW,WACZ,OAAiB,MAAbe,EACKA,EACkB,MAAhBD,EACFA,EAEAD,CAEb,EAEAG,EAAKsB,SAAW,SAAUxC,EAAOyC,GAO7B,OANAxB,EAAYqB,EAAetC,IACX,IAAZyC,GACArB,EAAuBH,GAIpBlB,EAAsBrC,KAAKwD,EACtC,EAEAA,EAAKwB,gBAAkB,SAAU1C,GAC7BgB,EAAesB,EAAetC,GACzB6B,KACDX,EAAKsB,SAASxC,GAAO,EAE7B,EAEAkB,EAAKyB,WAAa,WACd1B,EAAY,KACZmB,IACArC,EAAsBrC,KAAKwD,EAC/B,EAEAA,EAAK0B,UAAY,SAASH,GACtBvB,EAAKsB,SAAStB,EAAKX,OAAOsC,MAAOJ,EACrC,EAEAvB,EAAK4B,WAAa,SAASL,GACvBvB,EAAKsB,SAAStB,EAAKX,OAAOC,OAAQiC,EACtC,EAEAvB,EAAK6B,QAAU,WAMX,GALI/D,IAAkBkC,IAClBH,EAAiBuB,EAAetD,EAAckB,aAElDH,EAAsBrC,KAAKwD,GAEvBlC,IAAkBkC,EAClB,IAAK,IAAI8B,KAAajE,EACpBA,EAAeiE,GAAWD,SAGpC,EAGAhC,EAAiBuB,EACbtD,EAAgBA,EAAckB,WAAa,QAE/C,IAAI+C,EAAepB,IACC,MAAhBoB,IACAhC,EAAYqB,EAAeW,IAE/BlD,EAAsBrC,KAAKwD,EAC7B,EAQAlC,EAAgB,IAAI6B,GAENqC,UAAY,SAAmB7C,GACzC,GAAqB,iBAATA,GAAqC,iBAATA,GAA+B,KAATA,EAC1D,MAAM,IAAI1C,UAAU,kDAGxB,IAAIwF,EAASpE,EAAesB,GAO5B,OANK8C,IACDA,EAASpE,EAAesB,GAAQ,IAAIQ,EAChCR,EACArB,EAAcoB,gBAGf+C,CACX,EAGA,IAAIC,SAAe1E,SAAWF,EAAiBE,OAAOiB,SAAMG,EAiB5D,OAhBAd,EAAcqE,WAAa,WAMvB,cALW3E,SAAWF,GACfE,OAAOiB,MAAQX,IAClBN,OAAOiB,IAAMyD,GAGVpE,CACX,EAEAA,EAAcsE,WAAa,WACvB,OAAOvE,CACX,EAGAC,EAAuB,QAAIA,EAEpBA,CACX,OA3VyB,6DAMzB,CATA,6LCgBO,IAAKuE,EAAiB,SAAjBA,GAAiB,OAAjBA,EAAiB,cAAjBA,EAAiB,YAAjBA,CAAiB,MAKtB,MAAMC,EAAU,IAAIC,EAAAA,GAAc,UAAW,4BAOvCC,EAAc,IAAID,EAAAA,GAAc,OAAQ,yBAMxCE,EAAa,IAAIF,EAAAA,GAAc,aAAc,2ICxBnD,IAAKG,EAAW,SAAXA,GAAW,OAAXA,EAAW,cAAXA,EAAW,yBAAXA,EAAW,6BAAXA,CAAW,MAMhB,MAAMC,EAAqB,gMCA3B,MAAMC,EAMF5F,WAAAA,CACa6F,EACAC,GAEhB,GADF,KAFkBD,OAAAA,EAAiB,KACjBC,SAAAA,GAEX/D,KAAK+D,WAAa/D,KAAK8D,OACxB,MAAM,IAAIE,MAAM,oDAExB,CAEA,QAAW5D,GACP,OAAIJ,KAAK8D,OACE9D,KAAK8D,OAET9D,KAAK+D,QAChB,CAEA,WAAWE,GACP,OAAKjE,KAAK8D,OAGH9D,KAAK+D,SAFD,IAGf,CAEA,SAAWG,GACP,MAAMA,EAAQ,CAAClE,KAAKI,MACd6D,EAAUjE,KAAKiE,QAErB,OADIA,GAASC,EAAMC,KAAKF,GACjBC,CACX,CAEOE,OAAAA,CAAQC,GACX,OAAOrE,KAAKI,OAASiE,GAAOrE,KAAKiE,UAAYI,CACjD,CAIOC,MAAAA,CAAUrF,GACb,IAAIoF,EAOJ,OANIrE,KAAKI,OACLiE,EAAMpF,aAAG,EAAHA,EAAMe,KAAKI,QAEhBiE,GAAOrE,KAAKiE,UACbI,EAAMpF,aAAG,EAAHA,EAAMe,KAAKiE,UAEdI,CACX,CAEOE,UAAAA,CAAWC,GACd,IAAIC,GAAW,EAOf,OANIzE,KAAKI,OACLqE,EAAWD,EAAIE,SAAS1E,KAAKI,QAE5BqE,GAAYzE,KAAKiE,UAClBQ,EAAWD,EAAIE,SAAS1E,KAAKiE,UAE1BQ,CACX,EAGG,MAAME,UAA4Ed,EAAsB5F,WAAAA,IAAA2G,GAAA,SAAAA,IAAAhI,EAAAA,EAAAA,GAAA,uBAClF,EAAK,CAEvBiI,iBAAAA,CAAkBC,GACrB9E,KAAK8E,eAAiBA,CAC1B,CAEA,QAAW1E,GACP,OAAIJ,KAAK8D,SAAW9D,KAAK8E,eACd9E,KAAK8D,OAET9D,KAAK+D,QAChB,EAOG,MAAMP,UAA0DK,EAE5D5F,WAAAA,CAAY6F,EAAWC,GAE1B,GADAgB,MAAMjB,EAAQC,IACT/D,KAAK+D,SACN,MAAM,IAAIC,MAAM,kCAExB,CAEA,QAAW5D,GACP,OAAOJ,KAAK+D,QAChB,CAEA,WAAWE,GACP,OAAOjE,KAAK8D,MAChB,gOCvBJkB,IAAAA,cAAyB,SAAU9F,EAAY+F,EAAUC,GACrD,OAAO,YAAmCN,GAElC5E,KAAKmF,QACLP,EAAKQ,QAAQpF,KAAKmF,QAUtB,MANmB,UAAfjG,GACe,SAAfA,GACe,UAAfA,GACe,SAAfA,GACe,UAAfA,EAGOO,QAAQP,MAAe0F,GAEvBnF,QAAQC,OAAOkF,EAG9B,CACJ,EA4CO,MAAM1B,EA5Bb,SAASmC,EAAkBF,GACvB,MAAMD,EA7CgB,eA6C6BrF,IAAXsF,EAAuB,GAAK,IAAIA,KAClEG,EAAeN,IAAAA,UAAmBE,GAmBxC,YAjB8BrF,IAA1ByF,EAAaC,WAEbD,EAAaH,OAASA,EACtBG,EAAaC,SAAYC,IAErB,MAAMC,EAAcJ,GAAmBF,QAAAA,EAAU,IAAMK,GAOvD,OAHAC,EAAYtF,cAAgBmF,EAAanF,cAEzCsF,EAAY3C,UACL2C,CAAW,EAEtBH,EAAa/C,SAASyC,IAAAA,OAAgBU,OAAO,IAG1CJ,CACX,CAMsBD,GAYf,MAAMM,EAGF1H,WAAAA,CACc2H,EACjBxF,IACFxD,EAAAA,EAAAA,GAAA,yBAFmBgJ,OAAAA,EAGjB5F,KAAKI,KAAOA,EAAO,GACvB,CAEOT,KAAAA,IAASkG,GACZ7F,KAAK4F,OAAOjG,MAAMK,KAAKI,QAASyF,EACpC,CAEOxF,KAAAA,IAASwF,GACZ7F,KAAK4F,OAAOvF,MAAML,KAAKI,QAASyF,EACpC,CAEOC,IAAAA,IAAQD,GACX7F,KAAK4F,OAAOE,KAAK9F,KAAKI,QAASyF,EACnC,CAEOE,IAAAA,IAAQF,GACX7F,KAAK4F,OAAOG,KAAK/F,KAAKI,QAASyF,EACnC,CAEOG,KAAAA,IAASH,GACZ7F,KAAK4F,OAAOI,MAAMhG,KAAKI,QAASyF,EACpC,yzCC9KJ,MAAMI,EAAU,IAAIC,IAQb,SAASC,EAAkBC,GAa9B,OAVKA,aAA2BzI,SAC5ByI,EAAMA,EAAIC,YAITJ,EAAQK,IAAIF,IACbH,EAAQM,IAAIH,EAAKA,GAIdH,EAAQO,IAAIJ,EACvB,CASO,SAASK,EAAaC,EAAmBC,GAC5C,MAAMC,EAAeD,QAAAA,EAAmB,IAAIE,gBAC5C,IAAK,MAAOC,EAAKzC,KAAQrH,OAAO+J,QAAQL,GAChCrC,UACI2C,MAAMC,QAAQ5C,GACdA,EAAI6C,SAASC,IACTP,EAAaQ,OAAON,EAAKnJ,OAAOwJ,GAAG,IAGvCP,EAAaQ,OAAON,EAAKnJ,OAAO0G,KAI5C,OAAOuC,CACX,CAOO,SAASS,EAAavD,EAAgBC,EAAkBuD,GAC3D,MAAMC,EAAMC,EAAAA,EAAA,GACLF,GAAI,IACP,CAACvD,GAAWuD,EAAKxD,KAGrB,cADOyD,EAAOzD,GACPyD,CACX,CAWO,SAASE,EAAaC,GACzB,MAAM3J,EAAuC,CAAC,EACxC2I,EAAS,IAAIG,gBAAgBa,GACnC,IAAK,MAAMZ,KAAOJ,EAAOiB,OAAQ,CAC7B,MAAMtD,EAAMqC,EAAOkB,OAAOd,GAC1B/I,EAAE+I,GAAsB,IAAfzC,EAAInE,OAAemE,EAAI,GAAKA,CACzC,CACA,OAAOtG,CACX,CAUO,SAAS8J,EAAUC,EAAsBC,GAC5C,IAAK,MAAMjB,KAAOiB,EAAW,CACzB,IAAKA,EAAUC,eAAelB,GAC1B,SAEJ,MAAM5J,EAAQ6K,EAAUjB,GACpB5J,UAGJ4K,EAAeA,EAAaG,QAAQnB,EAAKnF,mBAAmBzE,IAChE,CACA,OAAO4K,CACX,CAYO,SAASI,EAAiBC,EAAYC,EAA4CC,GACrF,IAAI7K,EACJ,GAAI6K,GACA,IAAK7K,EAAI2K,EAAMjI,OAAS,EAAG1C,GAAK,EAAGA,IAC/B,GAAI4K,EAAGD,EAAM3K,GAAIA,EAAG2K,GAEhB,OADAA,EAAMG,OAAO9K,EAAG,IACT,OAIf,IAAKA,EAAI,EAAGA,EAAI2K,EAAMjI,OAAQ1C,IAC1B,GAAI4K,EAAGD,EAAM3K,GAAIA,EAAG2K,GAEhB,OADAA,EAAMG,OAAO9K,EAAG,IACT,EAInB,OAAO,CACX,CAkBO,SAAS+K,EAAmBtJ,EAAa0I,GAC5C,IAAK,MAAMb,KAAOa,EACd,IAAK1I,EAAI+I,eAAelB,GACpB,MAAM,IAAI9C,MAAM,yBAA2B8C,EAGvD,CAQO,SAAS0B,EAAYvJ,GACxB,OAAOwJ,KAAKC,MAAMD,KAAKE,UAAU1J,GACrC,CAUO,SAAS2J,EAAYC,EAAQC,GAMhC,GAAID,IAAMC,EACN,OAAO,EAGX,UAAWD,UAAaC,EACpB,OAAO,EAIX,GAAiB,iBAAND,GAAkBE,MAAMF,IAAME,MAAMD,GAC3C,OAAO,EAKX,GAAU,OAAND,GAAoB,OAANC,EACd,OAAOD,IAAMC,EAIjB,KAAMD,aAAa7L,QACf,OAAO,EAIX,GAAI6L,EAAE5K,cAAgB6K,EAAE7K,aAAe4K,EAAE3K,YAAc4K,EAAE5K,UACrD,OAAO,EAIX,GAAI2K,aAAaG,QAAUH,aAAaI,KACpC,OAAOJ,EAAExC,aAAeyC,EAAEzC,WAI9B,GAAIW,MAAMC,QAAQ4B,GAAI,CAClB,GAAIA,EAAE3I,SAAW4I,EAAE5I,OACf,OAAO,EAGX,IAAK,IAAI1C,EAAI,EAAGA,EAAIqL,EAAE3I,OAAQ1C,IAC1B,IAAKoL,EAAYC,EAAErL,GAAIsL,EAAEtL,IACrB,OAAO,CAGnB,KAAO,CAEH,IAAK,MAAM0L,KAAKJ,EACZ,GAAIA,EAAEd,eAAekB,KAAOL,EAAEb,eAAekB,GACzC,OAAO,EAKf,IAAK,MAAMA,KAAKL,EACZ,GAAIC,EAAEd,eAAekB,KAAOL,EAAEb,eAAekB,KAAON,EAAYC,EAAEK,GAAIJ,EAAEI,IACpE,OAAO,CAGnB,CACA,OAAO,CACX,CAWO,SAASC,EAAwBlK,GACpC,GAAmB,iBAARA,EAAkB,OAAOA,EAGpC,GAAIA,SAAqC+H,MAAMC,QAAQhI,GAAM,OAAOA,EAEpE,MAAMmK,EAAyB,GAC/B,IAAK,MAAOC,EAAGlC,KAAMnK,OAAO+J,QAAQ9H,GAChCmK,EAAMjF,KAAK,CAACkF,EAAGF,EAAwBhC,KAM3C,OAFAiC,EAAME,MAAK,CAACC,EAAGC,IAAMC,EAAqBF,EAAE,GAAIC,EAAE,MAE3CJ,CACX,CAQO,SAASM,EAASxM,GACrB,MAAwB,iBAAVA,GAAsByM,SAASzM,EACjD,CAQO,SAAS0M,EAAkBxD,GAC9B,MAAmB,iBAARA,EACAyD,IAAYzD,EAAI0D,UAAU,OAAO7B,QAAQ8B,EAAwB,KAErE,EACX,CAMO,SAASC,EAA6B5D,GACzC,MAAmB,iBAARA,EACAA,EAAI6B,QAAQ,mBAAoB,IAEpC,EACX,CAEO,SAAS6B,EAAU1D,GAGtB,OACIwD,EAAkBxD,EAAI6D,eAEjBhC,QAAQ,mEAAoE,IAE5EgC,aAEb,CAYA,MAAMF,EAAyB,8EAExB,SAASG,EAAaC,GACzB,OAAOA,EAAOlC,QAAQ,sBAAuB,OACjD,CAQO,SAASmC,EAAaC,GACzB,OAAOH,EAAaG,GAAMpC,QAAQ,QAAS,MAAMA,QAAQ,MAAO,IACpE,CAKO,SAASqC,EAAsBC,GAClC,OAAIA,SAAAA,EAAKC,SAAS,KACPD,EAAIrI,MAAM,GAAI,GAEdqI,CAEf,CAKO,SAASE,EAASC,EAAYxN,GACjC,OAAO,IAAIyN,SAASC,IAChBC,WAAWD,EAASF,EAAIxN,EAAM,GAEtC,CASO4N,eAAeC,EAAe7H,EAAoB9C,EAAc4K,GACnE,MAAMC,EAAQhC,KAAKiC,MACnB,IACI,aAAaF,GACjB,CAAE,QACE,MAAMG,EAAMlC,KAAKiC,MACjBhI,EAAO7C,MAAM,WAAWD,UAAa+K,EAAMF,MAC/C,CACJ,CASO,SAASG,EAAmBlI,EAAoB9C,EAAc4K,GACjE,MAAMC,EAAQhC,KAAKiC,MACnB,IACI,OAAOF,GACX,CAAE,QACE,MAAMG,EAAMlC,KAAKiC,MACjBhI,EAAO7C,MAAM,WAAWD,UAAa+K,EAAMF,MAC/C,CACJ,CAYO,SAASI,EAAkBhH,GAC9B,OAAOA,OACX,CAQO,SAASiH,IACZ,OAAOX,QAAQY,eACnB,CAEOT,eAAeU,EAClBC,EACArD,GAEA,IAAK,MAAMrK,KAAK0N,QACNrD,QAASrK,EAEvB,CAEO,SAAS2N,EAActD,GAC1B,OAAOuC,QAAQC,QAAQxC,IAC3B,CAoBO,SAASuD,EAAwBC,GACpC,OAAOC,KACFC,GACUF,EAAUE,IAErB,CACIC,SAAS,EACTC,OAAQ,EACRC,WAAY,IACZC,WAAY,MAGxB,CAWO,MAAMC,EAAmB,MAC5B,IAAI/F,EAAM,GACV,IAAK,IAAIgG,EAAI,GAAMA,GAAK,IAAMA,IAC1BhG,GAAOzI,OAAO0O,aAAaD,GAE/B,OAAOhG,CACV,EAN+B,GAkBzB,SAASkG,EAAYC,EAAWC,EAAWC,EAAWN,GACzD,OAAOI,EAAEG,OAAOF,EAAGC,EAAS,GAChC,CAUO,SAASE,EAAaH,EAAWC,EAAWN,GAO/C,MAAMS,EAAMC,OAAOJ,EAASvM,QACd,IAAA4M,EAAd,GAAIN,GAAKI,EACL,OAA8B,QAA9BE,EAAOL,EAAS7O,OAAO4O,GAAK,UAAE,IAAAM,EAAAA,EAAI,GAGtC,IAAIC,EAAIP,EAAII,EACR9P,EAAIc,OAAO4O,EAAII,GAAO,EAU1B,OALI9P,EAAI,IACJiQ,GAAKF,OAAOG,KAAKC,IAAInQ,IACrBA,EAAIc,OAAOgP,GAAO,GAGfD,EAAaI,EAAGN,GAAYA,EAAS3P,EAChD,CAUO,SAASoQ,EAAaX,EAAWE,EAAWN,GAC/C,MAAMS,EAAMC,OAAOJ,EAASvM,QAc5B,IAAIqH,EAASsF,OAAO,GACpB,IAAK,IAAIrP,EAAI+O,EAAErM,OAAS,EAAGiN,EAAIN,OAAO,GAAIrP,GAAK,EAAGA,IAAK2P,IAAK,CACxD,MAAMC,EAAYb,EAAEc,WAAW7P,GAAKiP,EAASY,WAAW,GAIxD9F,GAAUsF,OAAO,EAAIO,GAAaR,GAAOO,CAC7C,CACA,OAAO5F,CACX,CAWO,SAAS+F,EAAsB/D,EAAWC,EAAWiD,EAAWN,GACnE,MAAMoB,EAAOP,KAAKQ,IAAIjE,EAAErJ,OAAQsJ,EAAEtJ,QAC5BuN,EAAQP,EAAaZ,EAAY/C,EAAGgE,EAAMd,GAAWA,GACrDiB,EAAQR,EAAaZ,EAAY9C,EAAG+D,EAAMd,GAAWA,GACrDkB,GAAOF,EAAQC,GAASb,OAAO,GAIrC,OAAIc,IAAQF,GAASE,GAAOD,EACjBf,EAAagB,EAAKlB,GAAYA,EAAS,GAG3CE,EAAagB,EAAKlB,EAC7B,CAUO,SAASmB,EAAWrB,EAAWE,EAAWN,GAC7C,OAAOQ,EAAaO,EAAaX,EAAGE,GAAYI,OAAO,GAAIJ,EAC/D,CAUO,SAASoB,EAAWtB,EAAWE,EAAWN,GAC7C,OAAOQ,EAAaO,EAAaX,EAAGE,GAAYI,OAAO,GAAIJ,EAC/D,CASO,SAAShD,EAAqBF,EAAWC,GAG5C,OAAID,EAAIC,GACI,EACDD,EAAIC,EACJ,EAEA,CAEf,CAQO,SAASsE,EACZC,EACAC,EACAC,GAAgB,GAEhB,IAAK,MAAOC,EAAWC,KAAgBnR,OAAO+J,QAAQiH,GAC9CD,EAAOG,aAAsBlR,QAAUmR,EACvCL,EAAkBC,EAAOG,GAAYC,GAGpCA,SAAuDF,GACxDG,GAAQL,EAAQG,EAAWC,GAInC,OAAOJ,CACX,CAEA,SAASM,EAAgCC,GAA4B,IAAAC,EACjE,OAAqD,QAArDA,EAAO9K,EAAAA,GAAYa,OAAegK,EAAME,qBAAa,IAAAD,EAAAA,GAAK,CAC9D,CAMO,SAASE,EAAmCC,EAAmBC,GAClE,OAAON,EAAgCM,GAASN,EAAgCK,EACpF,CAEO,SAASE,EAAuBC,GACnC,MAAO,CAAClL,EAAAA,EAAYmL,KAAMnL,EAAAA,EAAYoL,aAAarK,SAASmK,EAChE,CAMO,SAASG,EAAgBnG,EAAcC,EAAcmG,EAAKA,CAACC,EAAOC,IAAmBD,IAAOC,GAC/F,GAAItG,EAAEuG,OAAStG,EAAEsG,KAAM,OAAO,EAC9B,IAAK,MAAO/F,EAAG6F,KAAOrG,EAAG,CACrB,MAAMsG,EAAKrG,EAAEtC,IAAI6C,GACjB,QAAWxJ,IAAPsP,IAAqBF,EAAGC,EAAIC,GAAK,OAAO,CAChD,CACA,OAAO,CACX,CAEA,SAASE,EAAwBnS,GAC7B,OAAIA,aAAiBgJ,IAEVoJ,EAAqBpS,GACrB8J,MAAMC,QAAQ/J,GAEdA,EAAMqS,KAAKpI,GAAMkI,EAAwBlI,KAEzCjK,CAEf,CAMO,SAASoS,EAAqBC,GACjC,MAAMC,EAAY,IAAItJ,IAEtB,IAAK,MAAOY,EAAK5J,KAAUqS,EACvBC,EAAUjJ,IAAIO,EAAKuI,EAAwBnS,IAG/C,OAAOF,OAAOyS,YAAYD,EAAUzI,UACxC,CAEO,SAAS2I,GAA4CC,GACxD,MAAgB,cAATA,GAAiC,cAATA,GAAiC,gBAATA,CAC3D,CAEO,SAASvB,GAAuDnP,EAAQ0Q,EAASzS,GACpF,GAAIwS,GAAWC,GACX,MAAM,IAAI3L,MAAM,6CAGpB/E,EAAI0Q,GAAQzS,CAChB,CAEO,SAAS0S,GAAmBtB,GAC/B,QAASoB,GAAWpB,EAAMuB,UAAYH,GAAWpB,EAAMwB,SAAWJ,GAAWpB,EAAMyB,UACvF,CAEO,MAAMC,WAA6B9J,IAC/BjI,WAAAA,CAAoBgS,GACvBlL,QAAQ,KADekL,cAAAA,CAE3B,CAMOC,WAAAA,CAAYpJ,GAKf,OAJK9G,KAAKsG,IAAIQ,IACV9G,KAAKuG,IAAIO,EAAK9G,KAAKiQ,iBAGhBjQ,KAAKwG,IAAIM,EACpB,6DChwBJ,MAAMqJ,EAAQ,EAAQ,iCAEhBC,EAAmB,CACxB,kBACA,kDACA,iDACA,0BAGD,MAAMC,UAAmBrM,MACxB,WAAA/F,CAAYqS,GACXvL,QAEIuL,aAAmBtM,OACtBhE,KAAKuQ,cAAgBD,IACnBA,WAAWA,KAEbtQ,KAAKuQ,cAAgB,IAAIvM,MAAMsM,GAC/BtQ,KAAKuQ,cAAcC,MAAQxQ,KAAKwQ,OAGjCxQ,KAAKI,KAAO,aACZJ,KAAKsQ,QAAUA,CAChB,EAGD,MAWMG,EAAS,CAACnO,EAAOoO,IAAY,IAAI/F,SAAQ,CAACC,EAAS+F,KACxDD,EAAU,CACTE,gBAAiB,OACjBC,QAAS,MACNH,GAGJ,MAAMI,EAAYX,EAAMW,UAAUJ,GAElCI,EAAUhF,SAAQhB,UACjB,IACCF,QAActI,EAAMyO,GACrB,CAAE,MAAO/K,GACR,KAAMA,aAAiBhC,OAEtB,YADA2M,EAAO,IAAIjT,UAAU,0BAA0BsI,sCAIhD,GAAIA,aAAiBqK,EACpBS,EAAUE,OACVL,EAAO3K,EAAMuK,oBACP,GAAIvK,aAAiBtI,YAvBRuT,EAuBqCjL,EAAMsK,SAvB3BF,EAAiB1L,SAASuM,IAwB7DH,EAAUE,OACVL,EAAO3K,OACD,CAnCsB,EAACA,EAAO+K,EAAeL,KAEtD,MAAMQ,EAAcR,EAAQG,SAAWE,EAAgB,GAEvD/K,EAAM+K,cAAgBA,EACtB/K,EAAMkL,YAAcA,CACR,EA8BTC,CAAwBnL,EAAO+K,EAAeL,GAE9C,UACOA,EAAQE,gBAAgB5K,EAC/B,CAAE,MAAOA,GAER,YADA2K,EAAO3K,EAER,CAEK8K,EAAUX,MAAMnK,IACpB2K,EAAOG,EAAUM,YAEnB,CACD,CAxCqBH,KAwCrB,GACC,IAGHI,EAAOlT,QAAUsS,EAEjBY,EAAOlT,QAAP,QAAyBsS,EAEzBY,EAAOlT,QAAQkS,WAAaA,6CCpF5BgB,EAAOlT,QAAU,EAAjB,oFCAA,IAAImT,EAAiB,EAAQ,+CAE7BnT,EAAQ2S,UAAY,SAASJ,GAC3B,IAAIa,EAAWpT,EAAQoT,SAASb,GAChC,OAAO,IAAIY,EAAeC,EAAU,CAChCxF,QAAS2E,IAAYA,EAAQ3E,SAAW2E,EAAQG,UAAYW,KAC5DC,MAAOf,GAAWA,EAAQe,MAC1BC,aAAchB,GAAWA,EAAQgB,cAEvC,EAEAvT,EAAQoT,SAAW,SAASb,GAC1B,GAAIA,aAAmB1J,MACrB,MAAO,GAAG2K,OAAOjB,GAGnB,IAAIkB,EAAO,CACTf,QAAS,GACT7E,OAAQ,EACRC,WAAY,IACZC,WAAYsF,IACZK,WAAW,GAEb,IAAK,IAAI/K,KAAO4J,EACdkB,EAAK9K,GAAO4J,EAAQ5J,GAGtB,GAAI8K,EAAK3F,WAAa2F,EAAK1F,WACzB,MAAM,IAAIlI,MAAM,yCAIlB,IADA,IAAIuN,EAAW,GACN/T,EAAI,EAAGA,EAAIoU,EAAKf,QAASrT,IAChC+T,EAASpN,KAAKnE,KAAK8R,cAActU,EAAGoU,IAYtC,OATIlB,GAAWA,EAAQ3E,UAAYwF,EAASrR,QAC1CqR,EAASpN,KAAKnE,KAAK8R,cAActU,EAAGoU,IAItCL,EAASjI,MAAK,SAASC,EAAEC,GACvB,OAAOD,EAAIC,CACb,IAEO+H,CACT,EAEApT,EAAQ2T,cAAgB,SAAShG,EAAS8F,GACxC,IAAIG,EAAUH,EAAc,UACvB5E,KAAK+E,SAAW,EACjB,EAEAC,EAAUhF,KAAKiF,MAAMF,EAAS/E,KAAKQ,IAAIoE,EAAK3F,WAAY,GAAKe,KAAKkF,IAAIN,EAAK5F,OAAQF,IAGvF,OAFAkG,EAAUhF,KAAKmF,IAAIH,EAASJ,EAAK1F,WAGnC,EAEA/N,EAAQiU,KAAO,SAASnT,EAAKyR,EAAS2B,GAMpC,GALI3B,aAAmB1J,QACrBqL,EAAU3B,EACVA,EAAU,OAGP2B,EAEH,IAAK,IAAIvL,KADTuL,EAAU,GACMpT,EACU,mBAAbA,EAAI6H,IACbuL,EAAQlO,KAAK2C,GAKnB,IAAK,IAAItJ,EAAI,EAAGA,EAAI6U,EAAQnS,OAAQ1C,IAAK,CACvC,IAAI2B,EAAWkT,EAAQ7U,GACnB8U,EAAWrT,EAAIE,GAEnBF,EAAIE,GAAU,SAAsBmT,GAClC,IAAIC,EAAWpU,EAAQ2S,UAAUJ,GAC7B9L,EAAWoC,MAAM9I,UAAUgE,MAAMzE,KAAK8B,UAAW,GACjDiT,EAAW5N,EAAK6N,MAEpB7N,EAAKT,MAAK,SAASuO,GACbH,EAAGpC,MAAMuC,KAGTA,IACFnT,UAAU,GAAKgT,EAAGnB,aAEpBoB,EAASlT,MAAMU,KAAMT,WACvB,IAEAgT,EAAGzG,SAAQ,WACTwG,EAAShT,MAAML,EAAK2F,EACtB,GACF,EAAExF,KAAKH,EAAKqT,GACZrT,EAAIE,GAAQuR,QAAUA,CACxB,CACF,qDCnGA,SAASY,EAAeC,EAAUb,GAET,kBAAZA,IACTA,EAAU,CAAE3E,QAAS2E,IAGvB1Q,KAAK2S,kBAAoBlK,KAAKC,MAAMD,KAAKE,UAAU4I,IACnDvR,KAAK4S,UAAYrB,EACjBvR,KAAK6S,SAAWnC,GAAW,CAAC,EAC5B1Q,KAAK8S,cAAgBpC,GAAWA,EAAQgB,cAAgBF,IACxDxR,KAAK+S,IAAM,KACX/S,KAAKgT,QAAU,GACfhT,KAAKiT,UAAY,EACjBjT,KAAKkT,kBAAoB,KACzBlT,KAAKmT,oBAAsB,KAC3BnT,KAAKoT,SAAW,KAChBpT,KAAKqT,gBAAkB,KACvBrT,KAAKsT,OAAS,KAEVtT,KAAK6S,SAAS9G,UAChB/L,KAAKuT,gBAAkBvT,KAAK4S,UAAU1Q,MAAM,GAEhD,CACAmP,EAAOlT,QAAUmT,EAEjBA,EAAepT,UAAUsV,MAAQ,WAC/BxT,KAAKiT,UAAY,EACjBjT,KAAK4S,UAAY5S,KAAK2S,kBAAkBzQ,MAAM,EAChD,EAEAoP,EAAepT,UAAU8S,KAAO,WAC1BhR,KAAKoT,UACPK,aAAazT,KAAKoT,UAEhBpT,KAAKsT,QACPG,aAAazT,KAAKsT,QAGpBtT,KAAK4S,UAAkB,GACvB5S,KAAKuT,gBAAkB,IACzB,EAEAjC,EAAepT,UAAUiS,MAAQ,SAASuC,GAKxC,GAJI1S,KAAKoT,UACPK,aAAazT,KAAKoT,WAGfV,EACH,OAAO,EAET,IAAIgB,GAAc,IAAIzK,MAAO0K,UAC7B,GAAIjB,GAAOgB,EAAc1T,KAAKqT,iBAAmBrT,KAAK8S,cAGpD,OAFA9S,KAAKgT,QAAQ7O,KAAKuO,GAClB1S,KAAKgT,QAAQ5N,QAAQ,IAAIpB,MAAM,qCACxB,EAGThE,KAAKgT,QAAQ7O,KAAKuO,GAElB,IAAIV,EAAUhS,KAAK4S,UAAUgB,QAC7B,QAAgB/T,IAAZmS,EAAuB,CACzB,IAAIhS,KAAKuT,gBAKP,OAAO,EAHPvT,KAAKgT,QAAQ1K,OAAO,EAAGtI,KAAKgT,QAAQ9S,OAAS,GAC7C8R,EAAUhS,KAAKuT,gBAAgBrR,OAAO,EAI1C,CAEA,IAAIjB,EAAOjB,KAqBX,OApBAA,KAAKsT,OAASzI,YAAW,WACvB5J,EAAKgS,YAEDhS,EAAKkS,sBACPlS,EAAKmS,SAAWvI,YAAW,WACzB5J,EAAKkS,oBAAoBlS,EAAKgS,UAChC,GAAGhS,EAAKiS,mBAEJjS,EAAK4R,SAASpB,OACdxQ,EAAKmS,SAAS3B,SAIpBxQ,EAAK8R,IAAI9R,EAAKgS,UAChB,GAAGjB,GAEChS,KAAK6S,SAASpB,OACdzR,KAAKsT,OAAO7B,SAGT,CACT,EAEAH,EAAepT,UAAU4N,QAAU,SAAS1D,EAAIyL,GAC9C7T,KAAK+S,IAAM3K,EAEPyL,IACEA,EAAW7B,UACbhS,KAAKkT,kBAAoBW,EAAW7B,SAElC6B,EAAWC,KACb9T,KAAKmT,oBAAsBU,EAAWC,KAI1C,IAAI7S,EAAOjB,KACPA,KAAKmT,sBACPnT,KAAKoT,SAAWvI,YAAW,WACzB5J,EAAKkS,qBACP,GAAGlS,EAAKiS,oBAGVlT,KAAKqT,iBAAkB,IAAIpK,MAAO0K,UAElC3T,KAAK+S,IAAI/S,KAAKiT,UAChB,EAEA3B,EAAepT,UAAU6V,IAAM,SAAS3L,GACtC3I,QAAQC,IAAI,4CACZM,KAAK8L,QAAQ1D,EACf,EAEAkJ,EAAepT,UAAU+M,MAAQ,SAAS7C,GACxC3I,QAAQC,IAAI,8CACZM,KAAK8L,QAAQ1D,EACf,EAEAkJ,EAAepT,UAAU+M,MAAQqG,EAAepT,UAAU6V,IAE1DzC,EAAepT,UAAU8V,OAAS,WAChC,OAAOhU,KAAKgT,OACd,EAEA1B,EAAepT,UAAU+V,SAAW,WAClC,OAAOjU,KAAKiT,SACd,EAEA3B,EAAepT,UAAUkT,UAAY,WACnC,GAA4B,IAAxBpR,KAAKgT,QAAQ9S,OACf,OAAO,KAOT,IAJA,IAAIgU,EAAS,CAAC,EACV9C,EAAY,KACZ+C,EAAiB,EAEZ3W,EAAI,EAAGA,EAAIwC,KAAKgT,QAAQ9S,OAAQ1C,IAAK,CAC5C,IAAIwI,EAAQhG,KAAKgT,QAAQxV,GACrB8S,EAAUtK,EAAMsK,QAChB8D,GAASF,EAAO5D,IAAY,GAAK,EAErC4D,EAAO5D,GAAW8D,EAEdA,GAASD,IACX/C,EAAYpL,EACZmO,EAAiBC,EAErB,CAEA,OAAOhD,CACT,g8sDC9JA,IAAIiD,EAAO,EAAQ,wCAMnB,IAAIC,EAAatL,OAAOhM,OAAO2K,KAAK0M,GAAM9E,KAJ1C,SAAsBnJ,GACpB,OAAOA,EAAI6B,QAAQ,yBAA0B,OAC/C,IAE4DsM,KAAK,KAAM,KAEvE,SAASC,EAAWC,GAClB,OAAOJ,EAAKI,EACd,CAMApD,EAAOlT,QAJP,SAAqBiI,GACnB,OAAOA,EAAI6B,QAAQqM,EAAYE,EACjC,2CCLI/V,OAAO8C,cACPvE,OAAO2K,KAAKlJ,OAAO8C,cAAc2F,SAASJ,IAClCA,EAAI4N,WAAW,cACfjW,OAAO8C,aAAaa,WAAW0E,EACnC,uCCSP,SAAU6N,EAAoBlW,EAAQgD,EAAU5B,GAE/C,IAAI+U,EAAQ,GASRC,EAAiB,CACnBC,SAAU,SAIVC,QAAS,CACP,YAAe,GACf,eAAiB,EACjB,eAAiB,EACjB,aAAe,GAIjBC,GAAI,GAGJC,GAAI,SAAStW,EAAMmV,GAOjB,IAAI7S,EAAOjB,KACX6K,YAAW,WACTiJ,EAAG7S,EAAKtC,GACV,GAAG,EACL,EAEAuW,QAAS,SAAS9U,EAAMgI,EAAIsI,GAC1BkE,EAAMzQ,KAAK,CAAC/D,KAAMA,EAAMgI,GAAIA,EAAIsI,QAASA,GAC3C,EAEAyE,aAAc,SAAS/M,GACrBwM,EAAMzQ,KAAK,CAAC/D,KAAM,KAAMgI,GAAIA,GAC9B,GAMEgN,EAAY,WAAY,EAC5BA,EAAUlX,UAAY2W,EAItBO,EAAY,IAAIA,EAIhB,IAAIC,EAAU,GAYd,SAASC,EAAGrW,EAAKsW,GACf,cAActW,IAAQsW,CACxB,CAwFA,IAAIC,EAAa,kBAGbC,EAAiBZ,EAAeE,QAAQW,YAAcF,EAAWG,MAAM,KAAO,GAClFd,EAAee,eAAiBH,EAwBhC,IAAII,EAAapU,EAASqU,gBAStBC,EAA8C,QAAtCF,EAAWG,SAAS/L,cAchC,SAASgM,IACP,MAAsC,mBAA3BxU,EAASwU,cAGXxU,EAASwU,cAAc1W,UAAU,IAC/BwW,EACFtU,EAASyU,gBAAgBzY,KAAKgE,EAAU,6BAA8BlC,UAAU,IAEhFkC,EAASwU,cAAc3W,MAAMmC,EAAUlC,UAElD,CASA,IAAI4W,EAAU,CACZC,KAAMH,EAAc,cAItBb,EAAUJ,GAAG7Q,MAAK,kBACTgS,EAAQC,IACjB,IAIA,IAAIC,EAAS,CACXC,MAAOH,EAAQC,KAAKE,OA8CtB,SAASC,EAAwBC,EAAMhE,EAAUiE,EAAOC,GACtD,IACIJ,EACAK,EACAC,EACAC,EAJAC,EAAM,YAKNC,EAAMd,EAAc,OACpBe,EAjCN,WAEE,IAAIA,EAAOvV,EAASuV,KAQpB,OANKA,KAEHA,EAAOf,EAAcF,EAAQ,MAAQ,SAChCkB,MAAO,GAGPD,CACT,CAsBaE,GAEX,GAAIC,SAASV,EAAO,IAGlB,KAAOA,MACLG,EAAOX,EAAc,QAChBmB,GAAKV,EAAYA,EAAUD,GAASK,GAAOL,EAAQ,GACxDM,EAAIM,YAAYT,GA0CpB,OAtCAN,EAAQL,EAAc,UAChBV,KAAO,WACbe,EAAMc,GAAK,IAAMN,GAIfE,EAAKC,KAAaD,EAAND,GAAYM,YAAYf,GACtCU,EAAKK,YAAYN,GAEbT,EAAMgB,WACRhB,EAAMgB,WAAWC,QAAUf,EAE3BF,EAAMe,YAAY5V,EAAS+V,eAAehB,IAE5CO,EAAIK,GAAKN,EAELE,EAAKC,OAEPD,EAAKV,MAAMmB,WAAa,GAExBT,EAAKV,MAAMoB,SAAW,SACtBb,EAAchB,EAAWS,MAAMoB,SAC/B7B,EAAWS,MAAMoB,SAAW,SAC5B7B,EAAWwB,YAAYL,IAGzBL,EAAMnE,EAASuE,EAAKP,GAEhBQ,EAAKC,MAAQD,EAAKW,YACpBX,EAAKW,WAAWC,YAAYZ,GAC5BnB,EAAWS,MAAMoB,SAAWb,EAG5BhB,EAAWgC,cAEXd,EAAIY,WAAWC,YAAYb,KAGpBJ,CACX,CAaA,SAASmB,EAAS1X,GAChB,OAAOA,EAAK6H,QAAQ,YAAY,SAAS7B,EAAK2R,GAC5C,MAAO,IAAMA,EAAG9N,aAClB,IAAGhC,QAAQ,OAAQ,OACrB,CAsDA,SAAS+P,EAAgBC,EAAO/a,GAC9B,IAAIM,EAAIya,EAAM/X,OAEd,GAAI,QAASzB,GAAU,aAAcA,EAAOyZ,IAAK,CAE/C,KAAO1a,KACL,GAAIiB,EAAOyZ,IAAIC,SAASL,EAASG,EAAMza,IAAKN,GAC1C,OAAO,EAGX,OAAO,CACT,CAEK,GAAI,oBAAqBuB,EAAQ,CAGpC,IADA,IAAI2Z,EAAgB,GACb5a,KACL4a,EAAcjU,KAAK,IAAM2T,EAASG,EAAMza,IAAM,IAAMN,EAAQ,KAG9D,OAAOqZ,EAAwB,eAD/B6B,EAAgBA,EAAc7D,KAAK,SAC4B,4CAA4C,SAASqC,GAClH,MAAiD,aA3DvD,SAAuBR,EAAMiC,EAAQ1I,GACnC,IAAIpI,EAEJ,GAAI,qBAAsB9I,EAAQ,CAChC8I,EAAS+Q,iBAAiB7a,KAAKgB,EAAQ2X,EAAMiC,GAC7C,IAAI5Y,EAAUhB,EAAOgB,QAEN,OAAX8H,EACEoI,IACFpI,EAASA,EAAOgR,iBAAiB5I,IAG/BlQ,GAEFA,EADaA,EAAQuG,MAAQ,QAAU,OACvBvI,KAAKgC,EAAS,sFAGpC,MACE8H,GAAU8Q,GAAUjC,EAAKoC,cAAgBpC,EAAKoC,aAAa7I,GAG7D,OAAOpI,CACT,CAqCakR,CAAc7B,EAAM,KAAM,WACnC,GACF,CACA,OAAO/W,CACT,CAYA,SAAS6Y,EAAStY,GAChB,OAAOA,EAAK6H,QAAQ,oBAAoB,SAAS7B,EAAK2R,EAAIY,GACxD,OAAOZ,EAAKY,EAAGrX,aACjB,IAAG2G,QAAQ,KAAM,GACnB,CAnNAmN,EAAUJ,GAAG5P,SAAQ,kBACZiR,EAAOC,KAChB,IAoUA,IAAIsC,EAAe/D,EAAeE,QAAQW,YAAcF,EAAWvL,cAAc0L,MAAM,KAAO,GAa9F,SAASkD,EAAOzQ,EAAI0Q,GAClB,OAAO,WACL,OAAO1Q,EAAG9I,MAAMwZ,EAAMvZ,UACxB,CACF,CA0DA,SAASwZ,EAAapJ,EAAMqJ,EAAU5C,EAAMlZ,EAAO+b,GAEjD,IAAIC,EAASvJ,EAAKwJ,OAAO,GAAG7X,cAAgBqO,EAAKzN,MAAM,GACrD+V,GAAStI,EAAO,IAAM8F,EAAclB,KAAK2E,EAAS,KAAOA,GAAQvD,MAAM,KAGzE,OAAIL,EAAG0D,EAAU,WAAa1D,EAAG0D,EAAU,aAnL7C,SAAmBf,EAAOe,EAAU9b,EAAO+b,GAIzC,GAHAA,GAAgB3D,EAAG2D,EAAe,cAAuBA,GAGpD3D,EAAGpY,EAAO,aAAc,CAC3B,IAAIqK,EAASyQ,EAAgBC,EAAO/a,GACpC,IAAKoY,EAAG/N,EAAQ,aACd,OAAOA,CAEX,CAaA,IAVA,IAAI6R,EAAW5b,EAAG6b,EAAa1J,EAAM2J,EASjCC,EAAQ,CAAC,YAAa,QAAS,SAC3BlD,EAAOC,OAASiD,EAAMrZ,QAC5BkZ,GAAY,EACZ/C,EAAOF,QAAUF,EAAcsD,EAAM3F,SACrCyC,EAAOC,MAAQD,EAAOF,QAAQG,MAIhC,SAASkD,IACHJ,WACK/C,EAAOC,aACPD,EAAOF,QAElB,CAGA,IADAkD,EAAcpB,EAAM/X,OACf1C,EAAI,EAAGA,EAAI6b,EAAa7b,IAQ3B,GAPAmS,EAAOsI,EAAMza,GACb8b,EAASjD,EAAOC,MAAM3G,KAjVb,GAmVIA,GAnVM3N,QAmVA,OACjB2N,EAAO+I,EAAS/I,IAGd0G,EAAOC,MAAM3G,KAAU9P,EAAW,CAKpC,GAAKoZ,GAAkB3D,EAAGpY,EAAO,aAqB/B,OADAsc,IACoB,QAAbR,GAAqBrJ,EAjB5B,IACE0G,EAAOC,MAAM3G,GAAQzS,CACvB,CAAE,MAAOL,GAAI,CAMb,GAAIwZ,EAAOC,MAAM3G,KAAU2J,EAEzB,OADAE,IACoB,QAAbR,GAAqBrJ,CASlC,CAGF,OADA6J,KACO,CACT,CAuGWC,CAAUxB,EAAOe,EAAU9b,EAAO+b,GAlD7C,SAAsBhB,EAAOhZ,EAAKmX,GAChC,IAAIsD,EAEJ,IAAK,IAAIlc,KAAKya,EACZ,GAAIA,EAAMza,KAAMyB,EAGd,OAAa,IAATmX,EACK6B,EAAMza,GAMX8X,EAHJoE,EAAOza,EAAIgZ,EAAMza,IAGJ,YAEJqb,EAAOa,EAAMtD,GAAQnX,GAIvBya,EAGX,OAAO,CACT,CA+BWC,CADP1B,GAAStI,EAAO,IAAOiJ,EAAarE,KAAK2E,EAAS,KAAOA,GAAQvD,MAAM,KAC5CqD,EAAU5C,EAEzC,CAgDA,SAASwD,EAAajK,EAAMzS,EAAO+b,GACjC,OAAOF,EAAapJ,EAAM9P,EAAWA,EAAW3C,EAAO+b,EACzD,CA1IApE,EAAegF,aAAejB,EA+F9B/D,EAAe+E,aAAeb,EA6C9BlE,EAAe+E,aAAeA,EAqB9BxE,EAAUF,QAAQ,gBAAiB0E,EAAa,gBAAiB,KAAK,KA0DrD/E,EAAeiF,WAAavD,GAsBlC,gGAAgG,SAASH,GAClH,IAAIO,EACAoD,EAAQ3D,EAAK4D,WACjBrD,EAAMoD,EAAM,GAAGE,WAAaF,EAAM,GAAGE,WACrC7E,EAAUF,QAAQ,eAAgByB,EAAK,CAACuD,QAAS,CAAC,kBACpD,GAAG,GAoCH,IAAIC,EAAYtF,EAAeE,QAAQW,YAAc,4BAA4BC,MAAM,KAAO,CAAC,GAAG,IAGlGd,EAAeuF,UAAYD,EAuB3B,IAAIE,EAAY,QAAS5b,GAAU,aAAcA,EAAOyZ,IACpDoC,EAAY,gBAAiB7b,EACjC2W,EAAUF,QAAQ,WAAYmF,GAAaC,GAiB3ClF,EAAUF,QAAQ,cAAc,WAC9B,GAAIE,EAAU+C,SACZ,OAAOyB,EAAa,SAAU,aAE9B,IAAIW,EAAKtE,EAAc,KAIvB,OAHAsE,EAAGjE,MAAMiB,QAAU4C,EAAS5F,KAAK,wBAGxBgG,EAAGjE,MAAMpW,SAAYuB,EAAS+Y,eAAiB3a,GAAa4B,EAAS+Y,aAAe,EAEjG,IAsBApF,EAAUF,QAAQ,UAAW0E,EAAa,YAAa,OAAO,IA4B9D,IAAIa,EAAS,SAAS9K,GACpB,IAEI6G,EAFAtW,EAASia,EAASja,OAClBwa,EAAUjc,EAAOkc,QAGrB,QAAuB,IAAZD,EACT,OAAO7a,EAGT,IAAK8P,EACH,OAAO,EAST,IAFA6G,GAHA7G,EAAOA,EAAK1H,QAAQ,KAAM,KAGdA,QAAQ,KAAM,KAAK3G,cAAgB,WAEnCoZ,EACV,MAAO,IAAM/K,EAGf,IAAK,IAAInS,EAAI,EAAGA,EAAI0C,EAAQ1C,IAAK,CAE/B,IAAI2H,EAASgV,EAAS3c,GAGtB,GAFe2H,EAAO7D,cAAgB,IAAMkV,KAE5BkE,EACd,MAAO,KAAOvV,EAAO8E,cAAgB,IAAM0F,CAE/C,CAEA,OAAO,CACT,EAEAkF,EAAe4F,OAASA,EAoExB,IAoTIG,EAGEC,EAvTF7B,EAAWnE,EAAemE,SAAW,SAASrJ,EAAM1Q,EAAKmX,GAC3D,OAA0B,IAAtBzG,EAAK3N,QAAQ,KACRyY,EAAO9K,KAGW,IAAvBA,EAAK3N,QAAQ,OAEf2N,EAAO+I,EAAS/I,IAEb1Q,EAII8Z,EAAapJ,EAAM1Q,EAAKmX,GAHxB2C,EAAapJ,EAAM,OAK9B,EAsfA,SAASuF,EAAQ4F,EAASnc,GAExB,GAAuB,iBAAZmc,EACT,IAAK,IAAIhU,KAAOgU,EACVF,EAAWE,EAAShU,IACtBoO,EAAQpO,EAAKgU,EAAShU,QAGrB,CAGL,IAAIiU,GADJD,EAAUA,EAAQ7Q,eACa0L,MAAM,KACjCqF,EAAO5F,EAAU2F,EAAiB,IAOtC,GAJgC,IAA5BA,EAAiB7a,SACnB8a,EAAOA,EAAKD,EAAiB,UAGX,IAATC,EAMT,OAAO5F,EAGTzW,EAAuB,mBAATA,EAAsBA,IAASA,EAGb,IAA5Boc,EAAiB7a,OACnBkV,EAAU2F,EAAiB,IAAMpc,IAG7ByW,EAAU2F,EAAiB,KAAS3F,EAAU2F,EAAiB,cAAeE,UAChF7F,EAAU2F,EAAiB,IAAM,IAAIE,QAAQ7F,EAAU2F,EAAiB,MAG1E3F,EAAU2F,EAAiB,IAAIA,EAAiB,IAAMpc,GA1N5D,SAAoB0W,GAClB,IAAI6F,EAAYrF,EAAWqF,UACvBC,EAAc/F,EAAUL,QAAQoG,aAAe,GAQnD,GANIpF,IACFmF,EAAYA,EAAUE,SAKpBhG,EAAUL,QAAQsG,cAAe,CACnC,IAAIC,EAAO,IAAItS,OAAO,UAAYmS,EAAc,gBAChDD,EAAYA,EAAUjT,QAAQqT,EAAM,KAAOH,EAAc,OAC3D,CAEI/F,EAAUL,QAAQwG,gBAEhBlG,EAAQnV,OAAS,IACnBgb,GAAa,IAAMC,EAAc9F,EAAQd,KAAK,IAAM4G,IAElDpF,EACFF,EAAWqF,UAAUE,QAAUF,EAE/BrF,EAAWqF,UAAYA,EAG7B,CAoMIM,CAAW,EAAI7c,IAAiB,IAATA,EAAiB,GAAK,OAASoc,EAAiBxG,KAAK,OAG5Ea,EAAUqG,SAASX,EAASnc,EAC9B,CAEA,OAAOyW,CACT,CAvhBAA,EAAUF,QAAQ,cAAe8D,EAAS,aAAc,CAACkB,QAAS,CAAC,gBAmBnE9E,EAAUF,QAAQ,WAAW,WAC3B,IACEwG,GAAkB,EACpB,IACEA,IAAoBzS,KAAKP,MAHb,2BAId,CAAE,MAAO7L,GACP,CAEF,SAAUoM,KAAKiC,KACbjC,KAAK/K,WACL+K,KAAK/K,UAAUyd,aACf1S,KAAK/K,UAAU0d,QACfF,EACJ,IAmBAtG,EAAUF,QAAQ,eAAe,WAC/B,SAAU7V,SAASnB,YAAamB,SAASnB,UAAUkB,KACrD,IAmBAgW,EAAUF,QAAQ,aAAa,WAC7B,SAAUlY,OAAO2K,MACf3K,OAAO6e,QACP7e,OAAO8e,gBACP9e,OAAO+e,qBACP/e,OAAOgf,UACPhf,OAAOif,UACPjf,OAAOkf,cACPlf,OAAOmf,0BACPnf,OAAOC,gBACPD,OAAOof,kBACPpf,OAAOqf,MACPrf,OAAOsf,QACPtf,OAAOuf,kBACX,IAqBAnH,EAAUF,QAAQ,gBAAgB,WAChC,IAAI3N,EAAQiV,EACZ,IACEA,EAAoB/d,EAAOoB,UAC3BpB,EAAOoB,UAAY,MACnB0H,OAAqC,IAArB9I,EAAOoB,UACvBpB,EAAOoB,UAAY2c,CACrB,CAAE,MAAO3f,GACP,OAAO,CACT,CACA,OAAO0K,CACT,IAoBA6N,EAAUF,QAAQ,cAAelO,MAAM9I,WACrC8I,MAAM9I,UAAUue,YAChBzV,MAAM9I,UAAUwe,MAChB1V,MAAM9I,UAAUye,MAChB3V,MAAM9I,UAAU0e,WAChB5V,MAAM9I,UAAUyJ,MAChBX,MAAM9I,UAAU6I,SAChBC,MAAM9I,UAAU2e,QAChB7V,MAAM8V,MACN9V,MAAM+V,KAoBR3H,EAAUF,QAAQ,oBAChBzW,EAAOyH,KAAOzH,EAAOue,KAAOve,EAAOwe,SAAWxe,EAAOye,UA2BvD9H,EAAUF,QAAQ,YAAY,WAC5B,MAAO,YAAazW,GAGpB,YAAaA,EAAOkM,SACpB,WAAYlM,EAAOkM,SACnB,QAASlM,EAAOkM,SAChB,SAAUlM,EAAOkM,UAKf,IAAIlM,EAAOkM,SAAQ,SAAS7N,GAAK8N,EAAU9N,CAAG,IACpB,mBAAZ8N,GAHf,IACKA,CAIR,IAoBAwK,EAAUF,QAAQ,eAAgBvX,OAAOwf,eACvCxf,OAAOyf,KACPzf,OAAOO,UAAUmf,aACjB1f,OAAOO,UAAUof,QACjB3f,OAAOO,UAAUwW,YACjB/W,OAAOO,UAAUsM,UACjB7M,OAAOO,UAAUwG,WAyBnB0Q,EAAUF,QAAQ,QAASzT,EAASyU,mBAAqBzU,EAASyU,gBAAgB,6BAA8B,OAAOqH,eA4BnH3C,EANGtF,EAJDuF,EAAmB,CAAC,EAAG7S,eAIF,cAAiBsN,EAAGuF,EAAgBpd,KAAM,aAMpD,SAAS+f,EAAQC,GAC5B,OAASA,KAAYD,GAAWlI,EAAGkI,EAAOvf,YAAYC,UAAUuf,GAAW,YAC7E,EAPa,SAASD,EAAQC,GAC5B,OAAO5C,EAAgBpd,KAAK+f,EAAQC,EACtC,EAoDJ5I,EAAe6I,GAAK,CAAC,EA0BrB7I,EAAeI,GAAK,SAAS6F,EAAShH,GAE/B9T,KAAK0d,GAAG5C,KACX9a,KAAK0d,GAAG5C,GAAW,IAIrB9a,KAAK0d,GAAG5C,GAAS3W,KAAK2P,GAGlBsB,EAAUpN,eAAe8S,IAE3BjQ,YAAW,WACTuK,EAAUqG,SAASX,EAAS1F,EAAU0F,GACxC,GAAG,EAEP,EAeAjG,EAAe4G,SAAW,SAASX,EAAS6C,GAC1C,GAAK3d,KAAK0d,GAAG5C,GAAb,CAIA,IAAI8C,EAAM5d,KAAK0d,GAAG5C,GAGlBjQ,YAAW,WACT,IAAIrN,EACJ,IAAKA,EAAI,EAAGA,EAAIogB,EAAI1d,OAAQ1C,KAC1BsW,EAAK8J,EAAIpgB,IACNmgB,EAEP,GAAG,UAGI3d,KAAK0d,GAAG5C,EAdf,CAeF,EA6HA1F,EAAUJ,GAAG7Q,MAAK,WAChB0Q,EAAeK,QAAUA,CAC3B,IA6BAE,EAAUF,QAAQ,WAAYzT,EAASoc,eAAeC,WAAW,2CAA4C,QAkB7G1I,EAAUF,QAAQ,cAAc,WAC9B,IAAI3N,GAAS,EACb,IACEA,EAAS,4BAA6B9I,GACwB,IAA5Dsf,wBAAwBC,+BAC5B,CACA,MAAOnhB,GAAI,CACX,OAAO0K,CACT,IAmBA6N,EAAUF,QAAQ,aAAa,WAE7B,IAGE,MAAoB,0BADd,IAAI+I,IAAI,yBACHC,IACb,CAAE,MAAOrhB,GACP,OAAO,CACT,CACF,IAsBAuY,EAAUF,QAAQ,kBAAmB,oBAAqBzW,GAmB1D2W,EAAUF,QAAQ,OAAQ,mBAAoBzW,GAAU,oBAAqB,IAAI0f,gBAoBjF,IAAIC,EAASpF,EAAS,SAAUva,GAChC2W,EAAUF,QAAQ,WAAY8D,EAAS,SAAUoF,IAqBjDhJ,EAAUF,QAAQ,UAAW,YAAae,EAAc,WAqBxDb,EAAUF,QAAQ,OAAQ,SAAUzW,GAAU,UAAWgK,MAAQ,cAAeA,MAmBhF2M,EAAUF,QAAQ,QAAS,UAAWzW,GAsCtC2W,EAAUF,QAAQ,gBAAgB,WAChC,IAAI4B,EAAM,YACV,IAGE,OAFAvV,aAAa8c,QAAQvH,EAAKA,GAC1BvV,aAAaa,WAAW0U,IACjB,CACT,CAAE,MAAOja,GACP,OAAO,CACT,CACF,IA6BAuY,EAAUF,QAAQ,iBAAkB,mBAAoBzW,GAqBxD2W,EAAUF,QAAQ,YAAY,WAC5B,IAAI8D,EAAW,uBAAwBva,EACnC6f,EAAa,iBAAkB7f,EAEnC,OAAI2W,EAAUL,QAAQW,aACbsD,GAEFsF,CACT,IA10DA,WACE,IAAIC,EACAzD,EACA0D,EACAjX,EACAkX,EAEA1D,EAEJ,IAAK,IAAI2D,KAAc9J,EACrB,GAAIA,EAAM5M,eAAe0W,GAAa,CAUpC,GATAH,EAAe,IACfzD,EAAUlG,EAAM8J,IAQJte,OACVme,EAAapa,KAAK2W,EAAQ1a,KAAK6J,eAE3B6Q,EAAQpK,SAAWoK,EAAQpK,QAAQwJ,SAAWY,EAAQpK,QAAQwJ,QAAQha,QAExE,IAAKse,EAAW,EAAGA,EAAW1D,EAAQpK,QAAQwJ,QAAQha,OAAQse,IAC5DD,EAAapa,KAAK2W,EAAQpK,QAAQwJ,QAAQsE,GAAUvU,eAS1D,IAHA1C,EAAS+N,EAAGwF,EAAQ1S,GAAI,YAAc0S,EAAQ1S,KAAO0S,EAAQ1S,GAGxDqW,EAAU,EAAGA,EAAUF,EAAare,OAAQue,IAUf,KAFhC1D,EAPcwD,EAAaE,GAOI9I,MAAM,MAEhBzV,OACnBkV,EAAU2F,EAAiB,IAAMxT,GAG5B6N,EAAU2F,EAAiB,OAAO3F,EAAU2F,EAAiB,KAAS3F,EAAU2F,EAAiB,cAAeE,WACnH7F,EAAU2F,EAAiB,IAAM,IAAIE,QAAQ7F,EAAU2F,EAAiB,MAG1E3F,EAAU2F,EAAiB,IAAIA,EAAiB,IAAMxT,GAGxD8N,EAAQlR,MAAMoD,EAAS,GAAK,OAASwT,EAAiBxG,KAAK,KAE/D,CAEJ,CAkxDAoK,UAEO9J,EAAeK,eACfL,EAAeM,aAGtB,IAAK,IAAI3X,EAAI,EAAGA,EAAI4X,EAAUJ,GAAG9U,OAAQ1C,IACvC4X,EAAUJ,GAAGxX,KAIfmX,EAAmBS,UAAYA,CAKhC,CAn7DA,CAm7DE3W,OAAQA,OAAQgD,4ICh8DZ,SAASmd,EAAoB7c,GAGhC,MAKM8c,EALW9c,EAAS+c,KAAKC,UAAU,GAKdpJ,MAAM,KAE3BpO,EAAS,CACXxF,SAAUid,mBAAmBH,EAAU,IACvCnY,OAAmB,CAAC,GAMxB,OAHImY,EAAU3e,OAAS,IACnBqH,EAAOb,QAASe,EAAAA,EAAAA,IAAaoX,EAAU,KAEpCtX,CACX,CAEO,SAAS0X,EAAQld,GACpB,OAAO0F,EAAAA,EAAAA,IAAa1F,EAASmd,OAAOH,UAAU,GAClD,IClCII,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBxf,IAAjByf,EACH,OAAOA,EAAanhB,QAGrB,IAAIkT,EAAS8N,EAAyBE,GAAY,CACjDjI,GAAIiI,EACJE,QAAQ,EACRphB,QAAS,CAAC,GAUX,OANAqhB,EAAoBH,GAAU5hB,KAAK4T,EAAOlT,QAASkT,EAAQA,EAAOlT,QAASihB,GAG3E/N,EAAOkO,QAAS,EAGTlO,EAAOlT,OACf,CAGAihB,EAAoBK,EAAID,EC5BxBJ,EAAoBM,KAAO,WAC1B,MAAM,IAAI1b,MAAM,iCACjB,ECFAob,EAAoBO,KAAO,CAAC,ECA5BP,EAAoBQ,EAAI,CAAC,EACzBR,EAAoBS,EAAKC,IACxB9iB,OAAO2K,KAAKyX,EAAoBQ,GAAGrQ,KAAKzI,IACvCsY,EAAoBQ,EAAE9Y,GAAKgZ,EAAQ,GAClC,ECHHV,EAAoB5S,EAAK6E,IACxB,IAAI0O,EAAS1O,GAAUA,EAAO2O,WAC7B,IAAO3O,EAAiB,QACxB,IAAM,EAEP,OADA+N,EAAoBrS,EAAEgT,EAAQ,CAAExW,EAAGwW,IAC5BA,CAAM,E1BNVvjB,EAAWQ,OAAO8e,eAAkB7c,GAASjC,OAAO8e,eAAe7c,GAASA,GAASA,EAAa,UAQtGmgB,EAAoBriB,EAAI,SAASG,EAAO+iB,GAEvC,GADU,EAAPA,IAAU/iB,EAAQ8C,KAAK9C,IAChB,EAAP+iB,EAAU,OAAO/iB,EACpB,GAAoB,iBAAVA,GAAsBA,EAAO,CACtC,GAAW,EAAP+iB,GAAa/iB,EAAM8iB,WAAY,OAAO9iB,EAC1C,GAAW,GAAP+iB,GAAoC,mBAAf/iB,EAAMgjB,KAAqB,OAAOhjB,CAC5D,CACA,IAAIijB,EAAKnjB,OAAO6e,OAAO,MACvBuD,EAAoBtiB,EAAEqjB,GACtB,IAAIC,EAAM,CAAC,EACX7jB,EAAiBA,GAAkB,CAAC,KAAMC,EAAS,CAAC,GAAIA,EAAS,IAAKA,EAASA,IAC/E,IAAI,IAAI6jB,EAAiB,EAAPJ,GAAY/iB,EAAyB,iBAAXmjB,KAAyB9jB,EAAeyF,QAAQqe,GAAUA,EAAU7jB,EAAS6jB,GACxHrjB,OAAO+e,oBAAoBsE,GAASnZ,SAASJ,GAASsZ,EAAItZ,GAAO,IAAO5J,EAAM4J,KAI/E,OAFAsZ,EAAa,QAAI,IAAM,EACvBhB,EAAoBrS,EAAEoT,EAAIC,GACnBD,CACR,E2BxBAf,EAAoBrS,EAAI,CAAC5O,EAASmiB,KACjC,IAAI,IAAIxZ,KAAOwZ,EACXlB,EAAoBrhB,EAAEuiB,EAAYxZ,KAASsY,EAAoBrhB,EAAEI,EAAS2I,IAC5E9J,OAAOC,eAAekB,EAAS2I,EAAK,CAAE3J,YAAY,EAAMqJ,IAAK8Z,EAAWxZ,IAE1E,ECNDsY,EAAoBmB,EAAI,CAAC,EAGzBnB,EAAoBviB,EAAKijB,GACjBnV,QAAQ6V,IAAIxjB,OAAO2K,KAAKyX,EAAoBmB,GAAGE,QAAO,CAAChV,EAAU3E,KACvEsY,EAAoBmB,EAAEzZ,GAAKgZ,EAASrU,GAC7BA,IACL,KCNJ2T,EAAoBsB,EAAKZ,GAEjB,WAAaV,EAAoBuB,IAAM,KAAO,CAAC,KAAO,SAAS,KAAO,0BAA0B,KAAO,kBAAkB,KAAO,kBAAkB,KAAO,mBAAmB,KAAO,kBAAkB,KAAO,OAAO,KAAO,cAAcb,IAAYA,GAAW,MCFvQV,EAAoBwB,SAAYd,GAExB,WAAaV,EAAoBuB,IAAM,IAAM,CAAC,KAAO,SAAS,KAAO,cAAcb,GAAW,OCHtGV,EAAoBuB,EAAI,IAAM,uBCA9BvB,EAAoByB,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAO9gB,MAAQ,IAAIX,SAAS,cAAb,EAChB,CAAE,MAAOxC,GACR,GAAsB,iBAAX4B,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxB2gB,EAAoBrhB,EAAI,CAACkB,EAAK0Q,IAAU3S,OAAOkB,UAAU8J,eAAevK,KAAKwB,EAAK0Q,GhCA9ElT,EAAa,CAAC,EACdC,EAAoB,eAExB0iB,EAAoB2B,EAAI,CAACxW,EAAKyW,EAAMla,EAAKgZ,KACxC,GAAGrjB,EAAW8N,GAAQ9N,EAAW8N,GAAKpG,KAAK6c,OAA3C,CACA,IAAIC,EAAQC,EACZ,QAAWrhB,IAARiH,EAEF,IADA,IAAIqa,EAAU1f,SAAS2f,qBAAqB,UACpC5jB,EAAI,EAAGA,EAAI2jB,EAAQjhB,OAAQ1C,IAAK,CACvC,IAAI+O,EAAI4U,EAAQ3jB,GAChB,GAAG+O,EAAE8U,aAAa,QAAU9W,GAAOgC,EAAE8U,aAAa,iBAAmB3kB,EAAoBoK,EAAK,CAAEma,EAAS1U,EAAG,KAAO,CACpH,CAEG0U,IACHC,GAAa,GACbD,EAASxf,SAASwU,cAAc,WAEzBqL,QAAU,QACjBL,EAAOjP,QAAU,IACboN,EAAoBmC,IACvBN,EAAOO,aAAa,QAASpC,EAAoBmC,IAElDN,EAAOO,aAAa,eAAgB9kB,EAAoBoK,GAExDma,EAAOQ,IAAMlX,GAEd9N,EAAW8N,GAAO,CAACyW,GACnB,IAAIU,EAAmB,CAACC,EAAMrT,KAE7B2S,EAAOW,QAAUX,EAAOY,OAAS,KACjCpO,aAAazB,GACb,IAAI8P,EAAUrlB,EAAW8N,GAIzB,UAHO9N,EAAW8N,GAClB0W,EAAOtJ,YAAcsJ,EAAOtJ,WAAWC,YAAYqJ,GACnDa,GAAWA,EAAQ5a,SAASkB,GAAQA,EAAGkG,KACpCqT,EAAM,OAAOA,EAAKrT,EAAM,EAExB0D,EAAUnH,WAAW6W,EAAiBtiB,KAAK,UAAMS,EAAW,CAAE0V,KAAM,UAAWxH,OAAQkT,IAAW,MACtGA,EAAOW,QAAUF,EAAiBtiB,KAAK,KAAM6hB,EAAOW,SACpDX,EAAOY,OAASH,EAAiBtiB,KAAK,KAAM6hB,EAAOY,QACnDX,GAAczf,SAASsgB,KAAK1K,YAAY4J,EApCkB,CAoCX,EiCvChD7B,EAAoBtiB,EAAKqB,IACH,oBAAXZ,QAA0BA,OAAOykB,aAC1ChlB,OAAOC,eAAekB,EAASZ,OAAOykB,YAAa,CAAE9kB,MAAO,WAE7DF,OAAOC,eAAekB,EAAS,aAAc,CAAEjB,OAAO,GAAO,ECL9DkiB,EAAoB6C,IAAO5Q,IAC1BA,EAAO6Q,MAAQ,GACV7Q,EAAO8Q,WAAU9Q,EAAO8Q,SAAW,IACjC9Q,GCHR+N,EAAoBjY,EAAI,CAAChJ,EAASikB,EAAcC,EAAgBC,KAE/D,IAAIC,EAAMC,MAAMpD,EAAoBlW,EAAI,WAAakW,EAAoBuB,IAAM,IAAM0B,EAAiB,SAClGI,EAAW,IAAOF,EACpBrC,MAAMrX,GAAOA,EAAE6Z,gBACfxC,MAAMyC,GAAWC,YAAYC,YAAYF,EAAOL,KAChDpC,MAAMvC,GAAS3gB,OAAO8lB,OAAO3kB,EAASwf,EAAIoF,SAAS5kB,WACrD,OAAOokB,EAAIrC,MAAMvC,GACgC,mBAArCiF,YAAYI,qBAEfJ,YAAYI,qBAAqBrF,EAAK2E,GAC3CpC,MACCvC,GAAS3gB,OAAO8lB,OAAO3kB,EAASwf,EAAIoF,SAAS5kB,WAC7CtB,IACA,GAAuC,qBAApC8gB,EAAIsF,QAAQzc,IAAI,gBAElB,OADA/G,QAAQsG,KAAK,oMAAqMlJ,GAC3M4lB,IAER,MAAM5lB,CAAC,IAIJ4lB,KACN,QCvBH,IAAIS,EACA9D,EAAoByB,EAAEsC,gBAAeD,EAAY9D,EAAoByB,EAAE9e,SAAW,IACtF,IAAIN,EAAW2d,EAAoByB,EAAEpf,SACrC,IAAKyhB,GAAazhB,IACbA,EAAS2hB,eAAkE,WAAjD3hB,EAAS2hB,cAAcC,QAAQ/hB,gBAC5D4hB,EAAYzhB,EAAS2hB,cAAc3B,MAC/ByB,GAAW,CACf,IAAI/B,EAAU1f,EAAS2f,qBAAqB,UAC5C,GAAGD,EAAQjhB,OAEV,IADA,IAAI1C,EAAI2jB,EAAQjhB,OAAS,EAClB1C,GAAK,KAAO0lB,IAAc,aAAavkB,KAAKukB,KAAaA,EAAY/B,EAAQ3jB,KAAKikB,GAE3F,CAID,IAAKyB,EAAW,MAAM,IAAIlf,MAAM,yDAChCkf,EAAYA,EAAUjb,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KAC1GmX,EAAoBlW,EAAIga,EAAY,aClBpC,MACE,QAAmC,IAAxB9D,EAAqC,CAC9C,IAAIkE,EAAelE,EAAoBsB,EACnC6C,EAAgBnE,EAAoBviB,EACpC2mB,EAAW,CAAC,EACZC,EAAW,CAAC,EAIhBrE,EAAoBsB,EAAI,SAAUZ,GAEhC,OADawD,EAAaxD,IAGvB0D,EAASxb,eAAe8X,GAAW,IAAM0D,EAAS1D,GAAW,GAElE,EACAV,EAAoBviB,EAAI,SAAUijB,GAEhC,OADayD,EAAczD,GACb4D,OAAM,SAAU1d,GAC5B,IAAI6K,EAAU4S,EAASzb,eAAe8X,GAAW2D,EAAS3D,GAAW,EACrE,GAAIjP,EAAU,EAAG,CACf,IAAI8S,EAAUL,EAAaxD,GAQ3B,MAPA9Z,EAAMsK,QACJ,iBACAwP,EACA,8BACA6D,EACA,IACF3d,EAAM4d,QAAUD,EACV3d,CACR,CACA,OAAO,IAAI2E,SAAQ,SAAUC,GAE3BC,YAAW,WACT,IACIgZ,EAAmB5a,KAAKiC,MAE5BsY,EAAS1D,GAAW+D,EACpBJ,EAAS3D,GAAWjP,EAAU,EAC9BjG,EAAQwU,EAAoBviB,EAAEijB,GAChC,GAjCG,IAkCL,GACF,GACF,CACF,CACD,EA7CD,SCAA,GAAwB,oBAAbre,SAAX,CACA,IAkDIqiB,EAAkBhE,GACd,IAAInV,SAAQ,CAACC,EAAS+F,KAC5B,IAAIuN,EAAOkB,EAAoBwB,SAASd,GACpCiE,EAAW3E,EAAoBlW,EAAIgV,EACvC,GAlBmB,EAACA,EAAM6F,KAE3B,IADA,IAAIC,EAAmBviB,SAAS2f,qBAAqB,QAC7C5jB,EAAI,EAAGA,EAAIwmB,EAAiB9jB,OAAQ1C,IAAK,CAChD,IACIymB,GADAC,EAAMF,EAAiBxmB,IACR6jB,aAAa,cAAgB6C,EAAI7C,aAAa,QACjE,GAAe,eAAZ6C,EAAIC,MAAyBF,IAAa/F,GAAQ+F,IAAaF,GAAW,OAAOG,CACrF,CACA,IAAIE,EAAoB3iB,SAAS2f,qBAAqB,SACtD,IAAQ5jB,EAAI,EAAGA,EAAI4mB,EAAkBlkB,OAAQ1C,IAAK,CACjD,IAAI0mB,EAEJ,IADID,GADAC,EAAME,EAAkB5mB,IACT6jB,aAAa,gBAChBnD,GAAQ+F,IAAaF,EAAU,OAAOG,CACvD,GAMIG,CAAenG,EAAM6F,GAAW,OAAOnZ,IAtDrB,EAACkV,EAASiE,EAAUO,EAAQ1Z,EAAS+F,KAC3D,IAAI4T,EAAU9iB,SAASwU,cAAc,QAErCsO,EAAQJ,IAAM,aACdI,EAAQhP,KAAO,WACX6J,EAAoBmC,KACvBgD,EAAQC,MAAQpF,EAAoBmC,IAmBrCgD,EAAQ3C,QAAU2C,EAAQ1C,OAjBJvT,IAGrB,GADAiW,EAAQ3C,QAAU2C,EAAQ1C,OAAS,KAChB,SAAfvT,EAAMiH,KACT3K,QACM,CACN,IAAI6Z,EAAYnW,GAASA,EAAMiH,KAC3BmP,EAAWpW,GAASA,EAAMP,QAAUO,EAAMP,OAAOmQ,MAAQ6F,EACzDrR,EAAM,IAAI1O,MAAM,qBAAuB8b,EAAU,cAAgB2E,EAAY,KAAOC,EAAW,KACnGhS,EAAItS,KAAO,iBACXsS,EAAIiS,KAAO,wBACXjS,EAAI6C,KAAOkP,EACX/R,EAAIkR,QAAUc,EACVH,EAAQ5M,YAAY4M,EAAQ5M,WAAWC,YAAY2M,GACvD5T,EAAO+B,EACR,GAGD6R,EAAQrG,KAAO6F,EAGXO,EACHA,EAAO3M,WAAWiN,aAAaL,EAASD,EAAOO,aAE/CpjB,SAASsgB,KAAK1K,YAAYkN,EAEb,EAqBbO,CAAiBhF,EAASiE,EAAU,KAAMnZ,EAAS+F,EAAO,IAIxDoU,EAAqB,CACxB,KAAM,GAGP3F,EAAoBmB,EAAEyE,QAAU,CAAClF,EAASrU,KAEtCsZ,EAAmBjF,GAAUrU,EAAStH,KAAK4gB,EAAmBjF,IACzB,IAAhCiF,EAAmBjF,IAFX,CAAC,KAAO,EAAE,KAAO,GAEsBA,IACtDrU,EAAStH,KAAK4gB,EAAmBjF,GAAWgE,EAAehE,GAASI,MAAK,KACxE6E,EAAmBjF,GAAW,CAAC,IAC5BjjB,IAEH,aADOkoB,EAAmBjF,GACpBjjB,CAAC,IAET,EAODuiB,EAAoBQ,EAAEoF,QAAWlF,IAChC,KAAKV,EAAoBrhB,EAAEgnB,EAAoBjF,SAA4CjgB,IAAhCklB,EAAmBjF,KAA2B,qBAAqBnhB,KAAKmhB,GAAU,CAC5IiF,EAAmBjF,GAAW,KAC9B,IAAImF,EAAOxjB,SAASwU,cAAc,QAClCgP,EAAK3D,QAAU,QACXlC,EAAoBmC,IACvB0D,EAAKzD,aAAa,QAASpC,EAAoBmC,IAEhD0D,EAAKd,IAAM,UACXc,EAAKC,GAAK,QACVD,EAAK/G,KAAOkB,EAAoBlW,EAAIkW,EAAoBwB,SAASd,GACjEre,SAASsgB,KAAK1K,YAAY4N,EAC3B,EA7F0C,YCA3C7F,EAAoB5V,EAAI/H,SAAS0jB,SAAWlkB,KAAKc,SAASmc,KAK1D,IAAIkH,EAAkB,CACrB,KAAM,GAGPhG,EAAoBmB,EAAEpT,EAAI,CAAC2S,EAASrU,KAElC,IAAI4Z,EAAqBjG,EAAoBrhB,EAAEqnB,EAAiBtF,GAAWsF,EAAgBtF,QAAWjgB,EACtG,GAA0B,IAAvBwlB,EAGF,GAAGA,EACF5Z,EAAStH,KAAKkhB,EAAmB,QAC3B,CAGL,IAAIC,EAAU,IAAI3a,SAAQ,CAACC,EAAS+F,IAAY0U,EAAqBD,EAAgBtF,GAAW,CAAClV,EAAS+F,KAC1GlF,EAAStH,KAAKkhB,EAAmB,GAAKC,GAGtC,IAAI/a,EAAM6U,EAAoBlW,EAAIkW,EAAoBsB,EAAEZ,GAEpD9Z,EAAQ,IAAIhC,MAgBhBob,EAAoB2B,EAAExW,GAfF+D,IACnB,GAAG8Q,EAAoBrhB,EAAEqnB,EAAiBtF,KAEf,KAD1BuF,EAAqBD,EAAgBtF,MACRsF,EAAgBtF,QAAWjgB,GACrDwlB,GAAoB,CACtB,IAAIZ,EAAYnW,IAAyB,SAAfA,EAAMiH,KAAkB,UAAYjH,EAAMiH,MAChEoO,EAAUrV,GAASA,EAAMP,QAAUO,EAAMP,OAAO0T,IACpDzb,EAAMsK,QAAU,iBAAmBwP,EAAU,cAAgB2E,EAAY,KAAOd,EAAU,IAC1F3d,EAAM5F,KAAO,iBACb4F,EAAMuP,KAAOkP,EACbze,EAAM4d,QAAUD,EAChB0B,EAAmB,GAAGrf,EACvB,CACD,GAEwC,SAAW8Z,EAASA,EAE/D,CACD,EAKFV,EAAoBQ,EAAEzS,EAAK2S,IAC1B,IAAKV,EAAoBrhB,EAAEqnB,EAAiBtF,SAAyCjgB,IAA7BulB,EAAgBtF,GAAiC,CACxGsF,EAAgBtF,GAAW,KAC3B,IAAImF,EAAOxjB,SAASwU,cAAc,QAElCgP,EAAK3D,QAAU,QACXlC,EAAoBmC,IACvB0D,EAAKzD,aAAa,QAASpC,EAAoBmC,IAEhD0D,EAAKd,IAAM,UACXc,EAAKC,GAAK,SACVD,EAAK/G,KAAOkB,EAAoBlW,EAAIkW,EAAoBsB,EAAEZ,GAC1Dre,SAASsgB,KAAK1K,YAAY4N,EAC3B,GAUD,IAAIM,EAAuB,CAACC,EAA4BnR,KACvD,IAGIgL,EAAUS,GAHT2F,EAAUC,EAAaC,GAAWtR,EAGhB7W,EAAI,EAC3B,GAAGioB,EAASG,MAAMxO,GAAgC,IAAxBgO,EAAgBhO,KAAa,CACtD,IAAIiI,KAAYqG,EACZtG,EAAoBrhB,EAAE2nB,EAAarG,KACrCD,EAAoBK,EAAEJ,GAAYqG,EAAYrG,IAGhD,GAAGsG,EAAsBA,EAAQvG,EAClC,CAEA,IADGoG,GAA4BA,EAA2BnR,GACrD7W,EAAIioB,EAASvlB,OAAQ1C,IACzBsiB,EAAU2F,EAASjoB,GAChB4hB,EAAoBrhB,EAAEqnB,EAAiBtF,IAAYsF,EAAgBtF,IACrEsF,EAAgBtF,GAAS,KAE1BsF,EAAgBtF,GAAW,CAC5B,EAIG+F,EAAqB5kB,KAA8B,wBAAIA,KAA8B,yBAAK,GAC9F4kB,EAAmB3e,QAAQqe,EAAqBnmB,KAAK,KAAM,IAC3DymB,EAAmB1hB,KAAOohB,EAAqBnmB,KAAK,KAAMymB,EAAmB1hB,KAAK/E,KAAKymB,QCnGvFzG,EAAoBmC,QAAK1hB,EvCArBlD,EAAqB,CACxB,KAAQ,CACP,KACA,KACA,KACA,OAGFyiB,EAAoBmB,EAAEuF,QAAWhG,IAChC,IAAIiG,EAASppB,EAAmBmjB,GAChC9Y,MAAMC,QAAQ8e,IAAWA,EAAOxW,IAAI6P,EAAoBS,EAAE,6MwCkB3D/U,eAAekb,KAAWva,GACtB,IAAK,MAAMwa,KAAQxa,EACf,UACUwa,CACV,CAAE,MAAOppB,GACLqG,EAAAA,EAAO8C,MAAMnJ,EACjB,CAER,CAbAqpB,EAAQ,uCAGRA,EAAQ,oCAqER,MAAMC,EAzDN,WACI,IAAK1nB,OAAO2W,UAER,OADAlS,EAAAA,EAAO8C,MAAM,yDACN,EAOXvH,OAAO2W,UAAUF,QAAQ,2BAA2B,SAAAkR,EAAA,MAAoD,mBAAzB,QAArBA,EAAO3nB,OAAOkM,eAAO,IAAAyb,GAAW,QAAXA,EAAdA,EAAgBloB,iBAAS,IAAAkoB,OAAA,EAAzBA,EAA2BC,QAAsB,IAElH5nB,OAAO2W,UAAUF,QAAQ,qBAAqB,SAAAoR,EAAA,MAA4C,mBAAjB,QAArBA,EAAO7nB,OAAOkM,eAAO,IAAA2b,OAAA,EAAdA,EAAgBC,WAAyB,IAEpG9nB,OAAO2W,UAAUF,QAAQ,wBAAwB,SAAAsR,EAAA,MAA+C,mBAApB,QAArBA,EAAO/nB,OAAOkM,eAAO,IAAA6b,OAAA,EAAdA,EAAgBjb,cAA4B,IAE1G9M,OAAO2W,UAAUF,QACb,gBACA,SAAAuR,EAAAC,EAAA,OAAmB,QAAbD,EAAAhoB,OAAOuK,cAAM,IAAAyd,OAAA,EAAbA,EAAevoB,cAAiF,QAAnEwoB,EAAC1pB,OAAOmf,yBAAyB1d,OAAOuK,OAAO9K,UAAW,iBAAS,IAAAwoB,IAAlEA,EAAoElgB,IAAG,IAG/G/H,OAAO2W,UAAUF,QAAQ,qBAAqB,SAAAyR,EAAA,MAA4C,mBAAlB,QAApBA,EAAOloB,OAAOzB,cAAM,IAAA2pB,OAAA,EAAbA,EAAelX,YAA0B,IAMpGhR,OAAO2W,UAAUF,QAAQ,iBAAiB,SAAA0R,EAAA,MAAwC,mBAAhB,QAAlBA,EAAOnoB,OAAOL,YAAI,IAAAwoB,OAAA,EAAXA,EAAavoB,UAAwB,IAI5FI,OAAO2W,UAAUF,QAAQ,QAAQ,IAA6B,iBAAhB0N,aAA0D,mBAAvBA,YAAYiE,SAI7FpoB,OAAO2W,UAAUF,QAAQ,iBAAiB,IAAMzW,OAAOqoB,kBAEvD,MAAMC,EAAc/pB,OAAO2K,KAAKlJ,OAAO2W,WAEvC,IAAI4R,GAAkB,EACtB,IAAK,MAAMlM,KAAWiM,EAAa,CAC/B,QAAkClnB,IAA9BpB,OAAO2W,UAAU0F,GAKjB,OAJA5X,EAAAA,EAAO8C,MACH,mGACA8U,IAEG,GAEuB,IAA9Brc,OAAO2W,UAAU0F,KACjB5X,EAAAA,EAAO8C,MAAM,gCAAiC8U,GAE9CkM,GAAkB,EAE1B,CACA,OAAOA,CACX,CAEyBC,IAQzBnc,kBACQoc,EAAAA,EAAAA,YACM,sFAIV,MAAM,iBACFC,EAAgB,gBAChBC,EAAe,gBACfC,EAAe,WACfC,EAAU,aACVC,EAAY,UACZC,EAAS,QACTC,EAAO,YACPC,EAAW,YACXC,EAAW,UACXC,EAAS,wBACTC,EAAuB,GACvBC,EAAE,6BACFC,SACM,+FAQV,UAEU/B,EAAQmB,GAEd,MAAMa,GAAYpJ,EAAAA,EAAAA,GAAoBngB,OAAOsD,UAQ7C,KAFwBimB,EAAUthB,OAAOuhB,eAAiBD,EAAUjmB,SAAS7B,OAAS,GAEhE,CAClB,MAAMgoB,EAAQ,mBAAmBvpB,KAAKD,UAAUE,aAAeH,OAAO0pB,SAChEC,EAAY,UAAUzpB,KAAKD,UAAUE,WAC3C,IAAIspB,GAASE,KACkE,IAAvE3mB,SAASC,OAAOM,QAAQ,0CAExB,YADAvD,OAAOsD,SAASmc,KAAO,gBAInC,CAGAmJ,IAEA,MAAMgB,EAAoBf,UACpBtB,EAAQqC,GAId,MAAMC,EAAqBlB,IAGrBmB,EAAsBhB,IAEtBiB,EAAmBhB,UAEnBxB,EAAQwC,EAAkBD,GAEhC,MAAME,EAAqBf,UACrB1B,EAAQyC,GACd,MAAMC,EAAqBf,UACrB3B,EAAQ0C,GAEd,IAAIC,EAAgBxC,GACfwC,GAAiBlqB,OAAO8C,eACzBonB,EAAgB1N,QAAQxc,OAAO8C,aAAaqnB,QAAQ,oCAMnDD,SACK,IAAIhe,SAAc,CAACC,EAAS+F,KAC9BzN,EAAAA,EAAO8C,MAAM,yCAEb6hB,GAAwB,KAChBppB,OAAO8C,cACP9C,OAAO8C,aAAa8c,QAAQ,iCAAkC1gB,QAAO,IAEzEuF,EAAAA,EAAOxD,IAAI,yCACXkL,GAAS,IACV8Y,MAAM/S,EAAO,IAIxB,UAEU0X,CACV,CAAE,MAAOriB,GAEL,OAAIA,aAAiB6iB,YAEVjB,EAAUE,EAAG,uBAAwB,CACxCA,EAAG,sBACHA,EAAG,4BAA6B,CAC5BxX,QAAStK,EAAMsK,SAAWwX,EAAG,kCAIlCF,EAAUE,EAAG,4BACxB,OAMMY,QACAD,QACAD,QACAD,QAKAvC,EAAQsC,SAIRb,EAAQO,EAAUthB,OAC5B,CAAE,MAAOgM,GACLxP,EAAAA,EAAO8C,MAAM0M,SAGPkV,EAAUE,EAAG,uBAAwB,CACvCC,EAA6BrV,EAAKoV,EAAG,uCAE7C,CACJ,EAEA7c,GAAQyY,OAAOhR,IAAQ,IAAAoW,EAKnB5lB,EAAAA,EAAO8C,MAAM0M,GAGbjR,SAASuV,KAAKV,MAAMyS,eAAe,UACnC,MAAMC,EAASvnB,SAASwU,cAAc,UAGtC+S,EAAgB,QAAI,GACpBA,EAAOvH,IAAM0E,EAAmB,6BAA+B,mCAC/D6C,EAAO1S,MAAM2S,MAAQ,OACrBD,EAAO1S,MAAM4S,OAAS,OACtBF,EAAO1S,MAAM6S,SAAW,WACxBH,EAAO1S,MAAM8S,IAAM,IACnBJ,EAAO1S,MAAM5H,KAAO,IACpBsa,EAAO1S,MAAM3H,MAAQ,IACrBqa,EAAO1S,MAAM+S,OAAS,IACtBL,EAAO1S,MAAMgT,OAAS,IACe,QAArCR,EAAArnB,SAAS8nB,eAAe,qBAAa,IAAAT,GAArCA,EAAuCzR,YAAY2R,EAAO","sources":["webpack://soc-connect/webpack/runtime/create fake namespace object","webpack://soc-connect/webpack/runtime/load script","webpack://soc-connect/webpack/runtime/chunk preload trigger","webpack://soc-connect/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://soc-connect/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://soc-connect/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://soc-connect/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://soc-connect/./node_modules/@formatjs/intl-segmenter/should-polyfill.js","webpack://soc-connect/./node_modules/loglevel/lib/loglevel.js","webpack://soc-connect/./node_modules/matrix-js-sdk/src/@types/location.ts","webpack://soc-connect/./node_modules/matrix-js-sdk/src/@types/read_receipts.ts","webpack://soc-connect/./node_modules/matrix-js-sdk/src/NamespacedValue.ts","webpack://soc-connect/./node_modules/matrix-js-sdk/src/logger.ts","webpack://soc-connect/./node_modules/matrix-js-sdk/src/utils.ts","webpack://soc-connect/./node_modules/p-retry/index.js","webpack://soc-connect/./node_modules/retry/index.js","webpack://soc-connect/./node_modules/retry/lib/retry.js","webpack://soc-connect/./node_modules/retry/lib/retry_operation.js","webpack://soc-connect/./node_modules/unhomoglyph/index.js","webpack://soc-connect/./src/vector/localstorage-fix.ts","webpack://soc-connect/./src/vector/modernizr.js","webpack://soc-connect/./src/vector/url_utils.ts","webpack://soc-connect/webpack/bootstrap","webpack://soc-connect/webpack/runtime/amd define","webpack://soc-connect/webpack/runtime/amd options","webpack://soc-connect/webpack/runtime/chunk preload function","webpack://soc-connect/webpack/runtime/compat get default export","webpack://soc-connect/webpack/runtime/define property getters","webpack://soc-connect/webpack/runtime/ensure chunk","webpack://soc-connect/webpack/runtime/get javascript chunk filename","webpack://soc-connect/webpack/runtime/get mini-css chunk filename","webpack://soc-connect/webpack/runtime/getFullHash","webpack://soc-connect/webpack/runtime/global","webpack://soc-connect/webpack/runtime/hasOwnProperty shorthand","webpack://soc-connect/webpack/runtime/make namespace object","webpack://soc-connect/webpack/runtime/node module decorator","webpack://soc-connect/webpack/runtime/wasm loading","webpack://soc-connect/webpack/runtime/publicPath","webpack://soc-connect/webpack/runtime/compat","webpack://soc-connect/webpack/runtime/css loading","webpack://soc-connect/webpack/runtime/jsonp chunk loading","webpack://soc-connect/webpack/runtime/nonce","webpack://soc-connect/./src/vector/index.ts"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"soc-connect:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var chunkToChildrenMap = {\n\t\"5385\": [\n\t\t1869,\n\t\t3323,\n\t\t1709,\n\t\t2702\n\t]\n};\n__webpack_require__.f.preload = (chunkId) => {\n\tvar chunks = chunkToChildrenMap[chunkId];\n\tArray.isArray(chunks) && chunks.map(__webpack_require__.G);\n};","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shouldPolyfill = shouldPolyfill;\nfunction shouldPolyfill() {\n    return !Intl.Segmenter;\n}\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","/*\nCopyright 2021 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n// Types for MSC3488 - m.location: Extending events with location data\nimport { type EitherAnd } from \"matrix-events-sdk\";\n\nimport { UnstableValue } from \"../NamespacedValue.ts\";\nimport { type M_TEXT } from \"./extensible_events.ts\";\n\nexport enum LocationAssetType {\n    Self = \"m.self\",\n    Pin = \"m.pin\",\n}\n\nexport const M_ASSET = new UnstableValue(\"m.asset\", \"org.matrix.msc3488.asset\");\nexport type MAssetContent = { type: LocationAssetType };\n/**\n * The event definition for an m.asset event (in content)\n */\nexport type MAssetEvent = EitherAnd<{ [M_ASSET.name]: MAssetContent }, { [M_ASSET.altName]: MAssetContent }>;\n\nexport const M_TIMESTAMP = new UnstableValue(\"m.ts\", \"org.matrix.msc3488.ts\");\n/**\n * The event definition for an m.ts event (in content)\n */\nexport type MTimestampEvent = EitherAnd<{ [M_TIMESTAMP.name]: number }, { [M_TIMESTAMP.altName]: number }>;\n\nexport const M_LOCATION = new UnstableValue(\"m.location\", \"org.matrix.msc3488.location\");\n\nexport type MLocationContent = {\n    uri: string;\n    description?: string | null;\n};\n\nexport type MLocationEvent = EitherAnd<\n    { [M_LOCATION.name]: MLocationContent },\n    { [M_LOCATION.altName]: MLocationContent }\n>;\n\nexport type MTextEvent = EitherAnd<{ [M_TEXT.name]: string }, { [M_TEXT.altName]: string }>;\n\n/* From the spec at:\n * https://github.com/matrix-org/matrix-doc/blob/matthew/location/proposals/3488-location.md\n{\n    \"type\": \"m.room.message\",\n    \"content\": {\n        \"body\": \"Matthew was at geo:51.5008,0.1247;u=35 as of Sat Nov 13 18:50:58 2021\",\n        \"msgtype\": \"m.location\",\n        \"geo_uri\": \"geo:51.5008,0.1247;u=35\",\n        \"m.location\": {\n            \"uri\": \"geo:51.5008,0.1247;u=35\",\n            \"description\": \"Matthew's whereabouts\",\n        },\n        \"m.asset\": {\n            \"type\": \"m.self\"\n        },\n        \"m.text\": \"Matthew was at geo:51.5008,0.1247;u=35 as of Sat Nov 13 18:50:58 2021\",\n        \"m.ts\": 1636829458432,\n    }\n}\n*/\ntype OptionalTimestampEvent = MTimestampEvent | undefined;\n/**\n * The content for an m.location event\n */\nexport type MLocationEventContent = MLocationEvent & MAssetEvent & MTextEvent & OptionalTimestampEvent;\n\nexport type LegacyLocationEventContent = {\n    body: string;\n    msgtype: string;\n    geo_uri: string;\n};\n\n/**\n * Possible content for location events as sent over the wire\n */\nexport type LocationEventWireContent = Partial<LegacyLocationEventContent & MLocationEventContent>;\n\nexport type ILocationContent = MLocationEventContent & LegacyLocationEventContent;\n","/*\nCopyright 2022 Šimon Brandner <simon.bra.ag@gmail.com>\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nexport enum ReceiptType {\n    Read = \"m.read\",\n    FullyRead = \"m.fully_read\",\n    ReadPrivate = \"m.read.private\",\n}\n\nexport const MAIN_ROOM_TIMELINE = \"main\";\n\nexport interface Receipt {\n    ts: number;\n    thread_id?: string;\n}\n\nexport interface WrappedReceipt {\n    eventId: string;\n    data: Receipt;\n}\n\nexport interface CachedReceipt {\n    type: ReceiptType;\n    userId: string;\n    data: Receipt;\n}\n\nexport type ReceiptCache = Map<string, CachedReceipt[]>;\n\nexport interface ReceiptContent {\n    [eventId: string]: {\n        [key in ReceiptType | string]: {\n            [userId: string]: Receipt;\n        };\n    };\n}\n\n// We will only hold a synthetic receipt if we do not have a real receipt or the synthetic is newer.\n// map: receipt type → user Id → receipt\nexport type Receipts = Map<string, Map<string, [real: WrappedReceipt | null, synthetic: WrappedReceipt | null]>>;\n\nexport type CachedReceiptStructure = {\n    eventId: string;\n    receiptType: string | ReceiptType;\n    userId: string;\n    receipt: Receipt;\n    synthetic: boolean;\n};\n","/*\nCopyright 2021 - 2022 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nimport { type Optional } from \"matrix-events-sdk/lib/types\";\n\n/**\n * Represents a simple Matrix namespaced value. This will assume that if a stable prefix\n * is provided that the stable prefix should be used when representing the identifier.\n */\nexport class NamespacedValue<S extends string, U extends string> {\n    // Stable is optional, but one of the two parameters is required, hence the weird-looking types.\n    // Goal is to to have developers explicitly say there is no stable value (if applicable).\n    public constructor(stable: S, unstable: U);\n    public constructor(stable: S, unstable?: U);\n    public constructor(stable: null | undefined, unstable: U);\n    public constructor(\n        public readonly stable?: S | null,\n        public readonly unstable?: U,\n    ) {\n        if (!this.unstable && !this.stable) {\n            throw new Error(\"One of stable or unstable values must be supplied\");\n        }\n    }\n\n    public get name(): U | S {\n        if (this.stable) {\n            return this.stable;\n        }\n        return this.unstable!;\n    }\n\n    public get altName(): U | S | null | undefined {\n        if (!this.stable) {\n            return null;\n        }\n        return this.unstable;\n    }\n\n    public get names(): (U | S)[] {\n        const names = [this.name];\n        const altName = this.altName;\n        if (altName) names.push(altName);\n        return names;\n    }\n\n    public matches(val: string): boolean {\n        return this.name === val || this.altName === val;\n    }\n\n    // this desperately wants https://github.com/microsoft/TypeScript/pull/26349 at the top level of the class\n    // so we can instantiate `NamespacedValue<string, _, _>` as a default type for that namespace.\n    public findIn<T>(obj: any): Optional<T> {\n        let val: T | undefined = undefined;\n        if (this.name) {\n            val = obj?.[this.name];\n        }\n        if (!val && this.altName) {\n            val = obj?.[this.altName];\n        }\n        return val;\n    }\n\n    public includedIn(arr: any[]): boolean {\n        let included = false;\n        if (this.name) {\n            included = arr.includes(this.name);\n        }\n        if (!included && this.altName) {\n            included = arr.includes(this.altName);\n        }\n        return included;\n    }\n}\n\nexport class ServerControlledNamespacedValue<S extends string, U extends string> extends NamespacedValue<S, U> {\n    private preferUnstable = false;\n\n    public setPreferUnstable(preferUnstable: boolean): void {\n        this.preferUnstable = preferUnstable;\n    }\n\n    public get name(): U | S {\n        if (this.stable && !this.preferUnstable) {\n            return this.stable;\n        }\n        return this.unstable!;\n    }\n}\n\n/**\n * Represents a namespaced value which prioritizes the unstable value over the stable\n * value.\n */\nexport class UnstableValue<S extends string, U extends string> extends NamespacedValue<S, U> {\n    // Note: Constructor difference is that `unstable` is *required*.\n    public constructor(stable: S, unstable: U) {\n        super(stable, unstable);\n        if (!this.unstable) {\n            throw new Error(\"Unstable value must be supplied\");\n        }\n    }\n\n    public get name(): U {\n        return this.unstable!;\n    }\n\n    public get altName(): S {\n        return this.stable!;\n    }\n}\n","/*\nCopyright 2018 André Jaenisch\nCopyright 2019, 2021 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nimport loglevel from \"loglevel\";\n\n/** Backwards-compatibility hack to expose `log` to applications that might still be relying on it. */\ninterface LoggerWithLogMethod extends Logger {\n    /**\n     * Output debug message to the logger.\n     *\n     * @param msg - Data to log.\n     *\n     * @deprecated prefer {@link Logger.debug}.\n     */\n    log(...msg: any[]): void;\n}\n\n/** Logger interface used within the js-sdk codebase */\nexport interface Logger extends BaseLogger {\n    /**\n     * Create a child logger.\n     *\n     * This child will use the `methodFactory` of the parent, so any log extensions applied to the parent\n     * at the time of calling `getChild` will be applied to the child as well.\n     * It will NOT apply changes to the parent's `methodFactory` after the child was created.\n     * Those changes need to be applied to the child manually.\n     *\n     * @param namespace - name to add to the current logger to generate the child. Some implementations of `Logger`\n     *    use this as a prefix; others use a different mechanism.\n     */\n    getChild(namespace: string): Logger;\n}\n\n/** The basic interface for a logger which doesn't support children */\nexport interface BaseLogger {\n    /**\n     * Output trace message to the logger, with stack trace.\n     *\n     * @param msg - Data to log.\n     */\n    trace(...msg: any[]): void;\n\n    /**\n     * Output debug message to the logger.\n     *\n     * @param msg - Data to log.\n     */\n    debug(...msg: any[]): void;\n\n    /**\n     * Output info message to the logger.\n     *\n     * @param msg - Data to log.\n     */\n    info(...msg: any[]): void;\n\n    /**\n     * Output warn message to the logger.\n     *\n     * @param msg - Data to log.\n     */\n    warn(...msg: any[]): void;\n\n    /**\n     * Output error message to the logger.\n     *\n     * @param msg - Data to log.\n     */\n    error(...msg: any[]): void;\n}\n\n// This is to demonstrate, that you can use any namespace you want.\n// Namespaces allow you to turn on/off the logging for specific parts of the\n// application.\n// An idea would be to control this via an environment variable (on Node.js).\n// See https://www.npmjs.com/package/debug to see how this could be implemented\n// Part of #332 is introducing a logging library in the first place.\nconst DEFAULT_NAMESPACE = \"matrix\";\n\n// because rageshakes in react-sdk hijack the console log, also at module load time,\n// initializing the logger here races with the initialization of rageshakes.\n// to avoid the issue, we override the methodFactory of loglevel that binds to the\n// console methods at initialization time by a factory that looks up the console methods\n// when logging so we always get the current value of console methods.\nloglevel.methodFactory = function (methodName, logLevel, loggerName) {\n    return function (this: PrefixedLogger, ...args): void {\n        /* eslint-disable @typescript-eslint/no-invalid-this */\n        if (this.prefix) {\n            args.unshift(this.prefix);\n        }\n        /* eslint-enable @typescript-eslint/no-invalid-this */\n        const supportedByConsole =\n            methodName === \"error\" ||\n            methodName === \"warn\" ||\n            methodName === \"trace\" ||\n            methodName === \"info\" ||\n            methodName === \"debug\";\n        /* eslint-disable no-console */\n        if (supportedByConsole) {\n            return console[methodName](...args);\n        } else {\n            return console.log(...args);\n        }\n        /* eslint-enable no-console */\n    };\n};\n\n/**\n * Implementation of {@link Logger} based on `loglevel`.\n */\ninterface PrefixedLogger extends loglevel.Logger, LoggerWithLogMethod {\n    prefix?: string;\n}\n\n/**\n * Internal utility function: gets a {@link Logger} based on `loglevel`.\n *\n * Child loggers produced by {@link Logger.getChild} add the name of the child logger as a prefix on each log line.\n *\n * @param prefix Prefix to add to each logged line. If undefined, no prefix will be added.\n */\nfunction getPrefixedLogger(prefix?: string): PrefixedLogger {\n    const loggerName = DEFAULT_NAMESPACE + (prefix === undefined ? \"\" : `-${prefix}`);\n    const prefixLogger = loglevel.getLogger(loggerName) as PrefixedLogger;\n\n    if (prefixLogger.getChild === undefined) {\n        // This is a new loglevel Logger which has not been turned into a PrefixedLogger yet.\n        prefixLogger.prefix = prefix;\n        prefixLogger.getChild = (childPrefix): Logger => {\n            // create the new child logger\n            const childLogger = getPrefixedLogger((prefix ?? \"\") + childPrefix);\n            // Assign the methodFactory from the parent logger.\n            // This is useful if we add extensions to the parent logger that modifies\n            // its methodFactory. (An example extension is: storing each log to a rageshake db)\n            childLogger.methodFactory = prefixLogger.methodFactory;\n            // Rebuild the child logger with the new methodFactory.\n            childLogger.rebuild();\n            return childLogger;\n        };\n        prefixLogger.setLevel(loglevel.levels.DEBUG, false);\n    }\n\n    return prefixLogger;\n}\n\n/**\n * Drop-in replacement for `console` using {@link https://www.npmjs.com/package/loglevel|loglevel}.\n * Can be tailored down to specific use cases if needed.\n */\nexport const logger = getPrefixedLogger() as LoggerWithLogMethod;\n\n/**\n * A \"span\" for grouping related log lines together.\n *\n * The current implementation just adds the name at the start of each log line.\n *\n * This offers a lighter-weight alternative to 'child' loggers returned by {@link Logger#getChild}. In particular,\n * it's not possible to apply individual filters to the LogSpan such as setting the verbosity level. On the other hand,\n * no reference to the LogSpan is retained in the logging framework, so it is safe to make lots of them over the course\n * of an application's life and just drop references to them when the job is done.\n */\nexport class LogSpan implements BaseLogger {\n    private readonly name;\n\n    public constructor(\n        private readonly parent: BaseLogger,\n        name: string,\n    ) {\n        this.name = name + \":\";\n    }\n\n    public trace(...msg: any[]): void {\n        this.parent.trace(this.name, ...msg);\n    }\n\n    public debug(...msg: any[]): void {\n        this.parent.debug(this.name, ...msg);\n    }\n\n    public info(...msg: any[]): void {\n        this.parent.info(this.name, ...msg);\n    }\n\n    public warn(...msg: any[]): void {\n        this.parent.warn(this.name, ...msg);\n    }\n\n    public error(...msg: any[]): void {\n        this.parent.error(this.name, ...msg);\n    }\n}\n","/*\nCopyright 2015, 2016, 2019, 2023 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n/**\n * This is an internal module.\n */\n\nimport unhomoglyph from \"unhomoglyph\";\nimport promiseRetry from \"p-retry\";\nimport { type Optional } from \"matrix-events-sdk\";\n\nimport { type IEvent, type MatrixEvent } from \"./models/event.ts\";\nimport { M_TIMESTAMP } from \"./@types/location.ts\";\nimport { ReceiptType } from \"./@types/read_receipts.ts\";\nimport { type BaseLogger } from \"./logger.ts\";\n\nconst interns = new Map<string, string>();\n\n/**\n * Internalises a string, reusing a known pointer or storing the pointer\n * if needed for future strings.\n * @param str - The string to internalise.\n * @returns The internalised string.\n */\nexport function internaliseString(str: string): string {\n    // Unwrap strings before entering the map, if we somehow got a wrapped\n    // string as our input. This should only happen from tests.\n    if ((str as unknown) instanceof String) {\n        str = str.toString();\n    }\n\n    // Check the map to see if we can store the value\n    if (!interns.has(str)) {\n        interns.set(str, str);\n    }\n\n    // Return any cached string reference\n    return interns.get(str)!;\n}\n\n/**\n * Encode a dictionary of query parameters.\n * Omits any undefined/null values.\n * @param params - A dict of key/values to encode e.g.\n * `{\"foo\": \"bar\", \"baz\": \"taz\"}`\n * @returns The encoded string e.g. foo=bar&baz=taz\n */\nexport function encodeParams(params: QueryDict, urlSearchParams?: URLSearchParams): URLSearchParams {\n    const searchParams = urlSearchParams ?? new URLSearchParams();\n    for (const [key, val] of Object.entries(params)) {\n        if (val !== undefined && val !== null) {\n            if (Array.isArray(val)) {\n                val.forEach((v) => {\n                    searchParams.append(key, String(v));\n                });\n            } else {\n                searchParams.append(key, String(val));\n            }\n        }\n    }\n    return searchParams;\n}\n\nexport type QueryDict = Record<string, string[] | string | number | boolean | undefined>;\n\n/**\n * Replace a stable parameter with the unstable naming for params\n */\nexport function replaceParam(stable: string, unstable: string, dict: QueryDict): QueryDict {\n    const result = {\n        ...dict,\n        [unstable]: dict[stable],\n    };\n    delete result[stable];\n    return result;\n}\n\n/**\n * Decode a query string in `application/x-www-form-urlencoded` format.\n * @param query - A query string to decode e.g.\n * foo=bar&via=server1&server2\n * @returns The decoded object, if any keys occurred multiple times\n * then the value will be an array of strings, else it will be an array.\n * This behaviour matches Node's qs.parse but is built on URLSearchParams\n * for native web compatibility\n */\nexport function decodeParams(query: string): Record<string, string | string[]> {\n    const o: Record<string, string | string[]> = {};\n    const params = new URLSearchParams(query);\n    for (const key of params.keys()) {\n        const val = params.getAll(key);\n        o[key] = val.length === 1 ? val[0] : val;\n    }\n    return o;\n}\n\n/**\n * Encodes a URI according to a set of template variables. Variables will be\n * passed through encodeURIComponent.\n * @param pathTemplate - The path with template variables e.g. '/foo/$bar'.\n * @param variables - The key/value pairs to replace the template\n * variables with. E.g. `{ \"$bar\": \"baz\" }`.\n * @returns The result of replacing all template variables e.g. '/foo/baz'.\n */\nexport function encodeUri(pathTemplate: string, variables: Record<string, Optional<string>>): string {\n    for (const key in variables) {\n        if (!variables.hasOwnProperty(key)) {\n            continue;\n        }\n        const value = variables[key];\n        if (value === undefined || value === null) {\n            continue;\n        }\n        pathTemplate = pathTemplate.replace(key, encodeURIComponent(value));\n    }\n    return pathTemplate;\n}\n\n/**\n * The removeElement() method removes the first element in the array that\n * satisfies (returns true) the provided testing function.\n * @param array - The array.\n * @param fn - Function to execute on each value in the array, with the\n * function signature `fn(element, index, array)`. Return true to\n * remove this element and break.\n * @param reverse - True to search in reverse order.\n * @returns True if an element was removed.\n */\nexport function removeElement<T>(array: T[], fn: (t: T, i?: number, a?: T[]) => boolean, reverse?: boolean): boolean {\n    let i: number;\n    if (reverse) {\n        for (i = array.length - 1; i >= 0; i--) {\n            if (fn(array[i], i, array)) {\n                array.splice(i, 1);\n                return true;\n            }\n        }\n    } else {\n        for (i = 0; i < array.length; i++) {\n            if (fn(array[i], i, array)) {\n                array.splice(i, 1);\n                return true;\n            }\n        }\n    }\n    return false;\n}\n\n/**\n * Checks if the given thing is a function.\n * @param value - The thing to check.\n * @returns True if it is a function.\n */\nexport function isFunction(value: any): boolean {\n    return Object.prototype.toString.call(value) === \"[object Function]\";\n}\n\n/**\n * Checks that the given object has the specified keys.\n * @param obj - The object to check.\n * @param keys - The list of keys that 'obj' must have.\n * @throws If the object is missing keys.\n */\n// note using 'keys' here would shadow the 'keys' function defined above\nexport function checkObjectHasKeys(obj: object, keys: string[]): void {\n    for (const key of keys) {\n        if (!obj.hasOwnProperty(key)) {\n            throw new Error(\"Missing required key: \" + key);\n        }\n    }\n}\n\n/**\n * Deep copy the given object. The object MUST NOT have circular references and\n * MUST NOT have functions.\n * @param obj - The object to deep copy.\n * @returns A copy of the object without any references to the original.\n */\nexport function deepCopy<T>(obj: T): T {\n    return JSON.parse(JSON.stringify(obj));\n}\n\n/**\n * Compare two objects for equality. The objects MUST NOT have circular references.\n *\n * @param x - The first object to compare.\n * @param y - The second object to compare.\n *\n * @returns true if the two objects are equal\n */\nexport function deepCompare(x: any, y: any): boolean {\n    // Inspired by\n    // http://stackoverflow.com/questions/1068834/object-comparison-in-javascript#1144249\n\n    // Compare primitives and functions.\n    // Also check if both arguments link to the same object.\n    if (x === y) {\n        return true;\n    }\n\n    if (typeof x !== typeof y) {\n        return false;\n    }\n\n    // special-case NaN (since NaN !== NaN)\n    if (typeof x === \"number\" && isNaN(x) && isNaN(y)) {\n        return true;\n    }\n\n    // special-case null (since typeof null == 'object', but null.constructor\n    // throws)\n    if (x === null || y === null) {\n        return x === y;\n    }\n\n    // everything else is either an unequal primitive, or an object\n    if (!(x instanceof Object)) {\n        return false;\n    }\n\n    // check they are the same type of object\n    if (x.constructor !== y.constructor || x.prototype !== y.prototype) {\n        return false;\n    }\n\n    // special-casing for some special types of object\n    if (x instanceof RegExp || x instanceof Date) {\n        return x.toString() === y.toString();\n    }\n\n    // the object algorithm works for Array, but it's sub-optimal.\n    if (Array.isArray(x)) {\n        if (x.length !== y.length) {\n            return false;\n        }\n\n        for (let i = 0; i < x.length; i++) {\n            if (!deepCompare(x[i], y[i])) {\n                return false;\n            }\n        }\n    } else {\n        // check that all of y's direct keys are in x\n        for (const p in y) {\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) {\n                return false;\n            }\n        }\n\n        // finally, compare each of x's keys with y\n        for (const p in x) {\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p) || !deepCompare(x[p], y[p])) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\n// Dev note: This returns an array of tuples, but jsdoc doesn't like that. https://github.com/jsdoc/jsdoc/issues/1703\n/**\n * Creates an array of object properties/values (entries) then\n * sorts the result by key, recursively. The input object must\n * ensure it does not have loops. If the input is not an object\n * then it will be returned as-is.\n * @param obj - The object to get entries of\n * @returns The entries, sorted by key.\n */\nexport function deepSortedObjectEntries(obj: any): [string, any][] {\n    if (typeof obj !== \"object\") return obj;\n\n    // Apparently these are object types...\n    if (obj === null || obj === undefined || Array.isArray(obj)) return obj;\n\n    const pairs: [string, any][] = [];\n    for (const [k, v] of Object.entries(obj)) {\n        pairs.push([k, deepSortedObjectEntries(v)]);\n    }\n\n    // lexicographicCompare is faster than localeCompare, so let's use that.\n    pairs.sort((a, b) => lexicographicCompare(a[0], b[0]));\n\n    return pairs;\n}\n\n/**\n * Returns whether the given value is a finite number without type-coercion\n *\n * @param value - the value to test\n * @returns whether or not value is a finite number without type-coercion\n */\nexport function isNumber(value: any): value is number {\n    return typeof value === \"number\" && isFinite(value);\n}\n\n/**\n * Removes zero width chars, diacritics and whitespace from the string\n * Also applies an unhomoglyph on the string, to prevent similar looking chars\n * @param str - the string to remove hidden characters from\n * @returns a string with the hidden characters removed\n */\nexport function removeHiddenChars(str: string): string {\n    if (typeof str === \"string\") {\n        return unhomoglyph(str.normalize(\"NFD\").replace(removeHiddenCharsRegex, \"\"));\n    }\n    return \"\";\n}\n\n/**\n * Removes the direction override characters from a string\n * @returns string with chars removed\n */\nexport function removeDirectionOverrideChars(str: string): string {\n    if (typeof str === \"string\") {\n        return str.replace(/[\\u202d-\\u202e]/g, \"\");\n    }\n    return \"\";\n}\n\nexport function normalize(str: string): string {\n    // Note: we have to match the filter with the removeHiddenChars() because the\n    // function strips spaces and other characters (M becomes RN for example, in lowercase).\n    return (\n        removeHiddenChars(str.toLowerCase())\n            // Strip all punctuation\n            .replace(/[\\\\'!\"#$%&()*+,\\-./:;<=>?@[\\]^_`{|}~\\u2000-\\u206f\\u2e00-\\u2e7f]/g, \"\")\n            // We also doubly convert to lowercase to work around oddities of the library.\n            .toLowerCase()\n    );\n}\n\n// Regex matching bunch of unicode control characters and otherwise misleading/invisible characters.\n// Includes:\n// various width spaces U+2000 - U+200D\n// LTR and RTL marks U+200E and U+200F\n// LTR/RTL and other directional formatting marks U+202A - U+202F\n// Arabic Letter RTL mark U+061C\n// Combining characters U+0300 - U+036F\n// Zero width no-break space (BOM) U+FEFF\n// Blank/invisible characters (U2800, U2062-U2063)\n// eslint-disable-next-line no-misleading-character-class\nconst removeHiddenCharsRegex = /[\\u2000-\\u200F\\u202A-\\u202F\\u0300-\\u036F\\uFEFF\\u061C\\u2800\\u2062-\\u2063\\s]/g;\n\nexport function escapeRegExp(string: string): string {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n\n/**\n * Converts Matrix glob-style string to a regular expression\n * https://spec.matrix.org/v1.7/appendices/#glob-style-matching\n * @param glob - Matrix glob-style string\n * @returns regular expression\n */\nexport function globToRegexp(glob: string): string {\n    return escapeRegExp(glob).replace(/\\\\\\*/g, \".*\").replace(/\\?/g, \".\");\n}\n\nexport function ensureNoTrailingSlash(url: string): string;\nexport function ensureNoTrailingSlash(url: undefined): undefined;\nexport function ensureNoTrailingSlash(url?: string): string | undefined;\nexport function ensureNoTrailingSlash(url?: string): string | undefined {\n    if (url?.endsWith(\"/\")) {\n        return url.slice(0, -1);\n    } else {\n        return url;\n    }\n}\n\n/**\n * Returns a promise which resolves with a given value after the given number of ms\n */\nexport function sleep<T>(ms: number, value?: T): Promise<T> {\n    return new Promise((resolve) => {\n        setTimeout(resolve, ms, value);\n    });\n}\n\n/**\n * Utility to log the duration of a promise.\n *\n * @param logger - The logger to log to.\n * @param name - The name of the operation.\n * @param block - The block to execute.\n */\nexport async function logDuration<T>(logger: BaseLogger, name: string, block: () => Promise<T>): Promise<T> {\n    const start = Date.now();\n    try {\n        return await block();\n    } finally {\n        const end = Date.now();\n        logger.debug(`[Perf]: ${name} took ${end - start}ms`);\n    }\n}\n\n/**\n * Utility to log the duration of a synchronous block.\n *\n * @param logger - The logger to log to.\n * @param name - The name of the operation.\n * @param block - The block to execute.\n */\nexport function logDurationSync<T>(logger: BaseLogger, name: string, block: () => T): T {\n    const start = Date.now();\n    try {\n        return block();\n    } finally {\n        const end = Date.now();\n        logger.debug(`[Perf]: ${name} took ${end - start}ms`);\n    }\n}\n\n/**\n * Promise/async version of {@link setImmediate}.\n *\n * Implementation is based on `setTimeout` for wider compatibility.\n * @deprecated Use {@link sleep} instead.\n */\nexport function immediate(): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve));\n}\n\nexport function isNullOrUndefined(val: any): boolean {\n    return val === null || val === undefined;\n}\n\nexport type IDeferred<T> = PromiseWithResolvers<T>;\n\n/**\n * Creates a deferred promise. This is a promise that can be resolved or rejected.\n * @deprecated use {@link Promise.withResolvers} instead.\n */\nexport function defer<T = void>(): IDeferred<T> {\n    return Promise.withResolvers<T>();\n}\n\nexport async function promiseMapSeries<T>(\n    promises: Array<T | Promise<T>>,\n    fn: (t: T) => Promise<unknown> | undefined, // if async we don't care about the type as we only await resolution\n): Promise<void> {\n    for (const o of promises) {\n        await fn(await o);\n    }\n}\n\nexport function promiseTry<T>(fn: () => T | Promise<T>): Promise<T> {\n    return Promise.resolve(fn());\n}\n\n// Creates and awaits all promises, running no more than `chunkSize` at the same time\nexport async function chunkPromises<T>(fns: (() => Promise<T>)[], chunkSize: number): Promise<T[]> {\n    const results: T[] = [];\n    for (let i = 0; i < fns.length; i += chunkSize) {\n        results.push(...(await Promise.all(fns.slice(i, i + chunkSize).map((fn) => fn()))));\n    }\n    return results;\n}\n\n/**\n * Retries the function until it succeeds or is interrupted. The given function must return\n * a promise which throws/rejects on error, otherwise the retry will assume the request\n * succeeded. The promise chain returned will contain the successful promise. The given function\n * should always return a new promise.\n * @param promiseFn - The function to call to get a fresh promise instance. Takes an\n * attempt count as an argument, for logging/debugging purposes.\n * @returns The promise for the retried operation.\n */\nexport function simpleRetryOperation<T>(promiseFn: (attempt: number) => Promise<T>): Promise<T> {\n    return promiseRetry(\n        (attempt: number) => {\n            return promiseFn(attempt);\n        },\n        {\n            forever: true,\n            factor: 2,\n            minTimeout: 3000, // ms\n            maxTimeout: 15000, // ms\n        },\n    );\n}\n\n// String averaging inspired by https://stackoverflow.com/a/2510816\n// Dev note: We make the alphabet a string because it's easier to write syntactically\n// than arrays. Thankfully, strings implement the useful parts of the Array interface\n// anyhow.\n\n/**\n * The default alphabet used by string averaging in this SDK. This matches\n * all usefully printable ASCII characters (0x20-0x7E, inclusive).\n */\nexport const DEFAULT_ALPHABET = ((): string => {\n    let str = \"\";\n    for (let c = 0x20; c <= 0x7e; c++) {\n        str += String.fromCharCode(c);\n    }\n    return str;\n})();\n\n/**\n * Pads a string using the given alphabet as a base. The returned string will be\n * padded at the end with the first character in the alphabet.\n *\n * This is intended for use with string averaging.\n * @param s - The string to pad.\n * @param n - The length to pad to.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The padded string.\n */\nexport function alphabetPad(s: string, n: number, alphabet = DEFAULT_ALPHABET): string {\n    return s.padEnd(n, alphabet[0]);\n}\n\n/**\n * Converts a baseN number to a string, where N is the alphabet's length.\n *\n * This is intended for use with string averaging.\n * @param n - The baseN number.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The baseN number encoded as a string from the alphabet.\n */\nexport function baseToString(n: bigint, alphabet = DEFAULT_ALPHABET): string {\n    // Developer note: the stringToBase() function offsets the character set by 1 so that repeated\n    // characters (ie: \"aaaaaa\" in a..z) don't come out as zero. We have to reverse this here as\n    // otherwise we'll be wrong in our conversion. Undoing a +1 before an exponent isn't very fun\n    // though, so we rely on a lengthy amount of `x - 1` and integer division rules to reach a\n    // sane state. This also means we have to do rollover detection: see below.\n\n    const len = BigInt(alphabet.length);\n    if (n <= len) {\n        return alphabet[Number(n) - 1] ?? \"\";\n    }\n\n    let d = n / len;\n    let r = Number(n % len) - 1;\n\n    // Rollover detection: if the remainder is negative, it means that the string needs\n    // to roll over by 1 character downwards (ie: in a..z, the previous to \"aaa\" would be\n    // \"zz\").\n    if (r < 0) {\n        d -= BigInt(Math.abs(r)); // abs() is just to be clear what we're doing. Could also `+= r`.\n        r = Number(len) - 1;\n    }\n\n    return baseToString(d, alphabet) + alphabet[r];\n}\n\n/**\n * Converts a string to a baseN number, where N is the alphabet's length.\n *\n * This is intended for use with string averaging.\n * @param s - The string to convert to a number.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The baseN number.\n */\nexport function stringToBase(s: string, alphabet = DEFAULT_ALPHABET): bigint {\n    const len = BigInt(alphabet.length);\n\n    // In our conversion to baseN we do a couple performance optimizations to avoid using\n    // excess CPU and such. To create baseN numbers, the input string needs to be reversed\n    // so the exponents stack up appropriately, as the last character in the unreversed\n    // string has less impact than the first character (in \"abc\" the A is a lot more important\n    // for lexicographic sorts). We also do a trick with the character codes to optimize the\n    // alphabet lookup, avoiding an index scan of `alphabet.indexOf(reversedStr[i])` - we know\n    // that the alphabet and (theoretically) the input string are constrained on character sets\n    // and thus can do simple subtraction to end up with the same result.\n\n    // Developer caution: we carefully cast to BigInt here to avoid losing precision. We cannot\n    // rely on Math.pow() (for example) to be capable of handling our insane numbers.\n\n    let result = BigInt(0);\n    for (let i = s.length - 1, j = BigInt(0); i >= 0; i--, j++) {\n        const charIndex = s.charCodeAt(i) - alphabet.charCodeAt(0);\n\n        // We add 1 to the char index to offset the whole numbering scheme. We unpack this in\n        // the baseToString() function.\n        result += BigInt(1 + charIndex) * len ** j;\n    }\n    return result;\n}\n\n/**\n * Averages two strings, returning the midpoint between them. This is accomplished by\n * converting both to baseN numbers (where N is the alphabet's length) then averaging\n * those before re-encoding as a string.\n * @param a - The first string.\n * @param b - The second string.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The midpoint between the strings, as a string.\n */\nexport function averageBetweenStrings(a: string, b: string, alphabet = DEFAULT_ALPHABET): string {\n    const padN = Math.max(a.length, b.length);\n    const baseA = stringToBase(alphabetPad(a, padN, alphabet), alphabet);\n    const baseB = stringToBase(alphabetPad(b, padN, alphabet), alphabet);\n    const avg = (baseA + baseB) / BigInt(2);\n\n    // Detect integer division conflicts. This happens when two numbers are divided too close so\n    // we lose a .5 precision. We need to add a padding character in these cases.\n    if (avg === baseA || avg == baseB) {\n        return baseToString(avg, alphabet) + alphabet[0];\n    }\n\n    return baseToString(avg, alphabet);\n}\n\n/**\n * Finds the next string using the alphabet provided. This is done by converting the\n * string to a baseN number, where N is the alphabet's length, then adding 1 before\n * converting back to a string.\n * @param s - The string to start at.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The string which follows the input string.\n */\nexport function nextString(s: string, alphabet = DEFAULT_ALPHABET): string {\n    return baseToString(stringToBase(s, alphabet) + BigInt(1), alphabet);\n}\n\n/**\n * Finds the previous string using the alphabet provided. This is done by converting the\n * string to a baseN number, where N is the alphabet's length, then subtracting 1 before\n * converting back to a string.\n * @param s - The string to start at.\n * @param alphabet - The alphabet to use as a single string.\n * @returns The string which precedes the input string.\n */\nexport function prevString(s: string, alphabet = DEFAULT_ALPHABET): string {\n    return baseToString(stringToBase(s, alphabet) - BigInt(1), alphabet);\n}\n\n/**\n * Compares strings lexicographically as a sort-safe function.\n * @param a - The first (reference) string.\n * @param b - The second (compare) string.\n * @returns Negative if the reference string is before the compare string;\n * positive if the reference string is after; and zero if equal.\n */\nexport function lexicographicCompare(a: string, b: string): number {\n    // Dev note: this exists because I'm sad that you can use math operators on strings, so I've\n    // hidden the operation in this function.\n    if (a < b) {\n        return -1;\n    } else if (a > b) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\n/**\n * This function is similar to Object.assign() but it assigns recursively and\n * allows you to ignore nullish values from the source\n *\n * @returns the target object\n */\nexport function recursivelyAssign<T1 extends T2, T2 extends Record<string, any>>(\n    target: T1,\n    source: T2,\n    ignoreNullish = false,\n): T1 & T2 {\n    for (const [sourceKey, sourceValue] of Object.entries(source)) {\n        if (target[sourceKey] instanceof Object && sourceValue) {\n            recursivelyAssign(target[sourceKey], sourceValue);\n            continue;\n        }\n        if ((sourceValue !== null && sourceValue !== undefined) || !ignoreNullish) {\n            safeSet(target, sourceKey, sourceValue);\n            continue;\n        }\n    }\n    return target as T1 & T2;\n}\n\nfunction getContentTimestampWithFallback(event: MatrixEvent): number {\n    return M_TIMESTAMP.findIn<number>(event.getContent()) ?? -1;\n}\n\n/**\n * Sort events by their content m.ts property\n * Latest timestamp first\n */\nexport function sortEventsByLatestContentTimestamp(left: MatrixEvent, right: MatrixEvent): number {\n    return getContentTimestampWithFallback(right) - getContentTimestampWithFallback(left);\n}\n\nexport function isSupportedReceiptType(receiptType: string): boolean {\n    return [ReceiptType.Read, ReceiptType.ReadPrivate].includes(receiptType as ReceiptType);\n}\n\n/**\n * Determines whether two maps are equal.\n * @param eq - The equivalence relation to compare values by. Defaults to strict equality.\n */\nexport function mapsEqual<K, V>(x: Map<K, V>, y: Map<K, V>, eq = (v1: V, v2: V): boolean => v1 === v2): boolean {\n    if (x.size !== y.size) return false;\n    for (const [k, v1] of x) {\n        const v2 = y.get(k);\n        if (v2 === undefined || !eq(v1, v2)) return false;\n    }\n    return true;\n}\n\nfunction processMapToObjectValue(value: any): any {\n    if (value instanceof Map) {\n        // Value is a Map. Recursively map it to an object.\n        return recursiveMapToObject(value);\n    } else if (Array.isArray(value)) {\n        // Value is an Array. Recursively map the value (e.g. to cover Array of Arrays).\n        return value.map((v) => processMapToObjectValue(v));\n    } else {\n        return value;\n    }\n}\n\n/**\n * Recursively converts Maps to plain objects.\n * Also supports sub-lists of Maps.\n */\nexport function recursiveMapToObject(map: Map<any, any>): Record<any, any> {\n    const targetMap = new Map();\n\n    for (const [key, value] of map) {\n        targetMap.set(key, processMapToObjectValue(value));\n    }\n\n    return Object.fromEntries(targetMap.entries());\n}\n\nexport function unsafeProp<K extends keyof any | undefined>(prop: K): boolean {\n    return prop === \"__proto__\" || prop === \"prototype\" || prop === \"constructor\";\n}\n\nexport function safeSet<O extends Record<any, any>, K extends keyof O>(obj: O, prop: K, value: O[K]): void {\n    if (unsafeProp(prop)) {\n        throw new Error(\"Trying to modify prototype or constructor\");\n    }\n\n    obj[prop] = value;\n}\n\nexport function noUnsafeEventProps(event: Partial<IEvent>): boolean {\n    return !(unsafeProp(event.room_id) || unsafeProp(event.sender) || unsafeProp(event.event_id));\n}\n\nexport class MapWithDefault<K, V> extends Map<K, V> {\n    public constructor(private createDefault: () => V) {\n        super();\n    }\n\n    /**\n     * Returns the value if the key already exists.\n     * If not, it creates a new value under that key using the ctor callback and returns it.\n     */\n    public getOrCreate(key: K): V {\n        if (!this.has(key)) {\n            this.set(key, this.createDefault());\n        }\n\n        return this.get(key)!;\n    }\n}\n","'use strict';\nconst retry = require('retry');\n\nconst networkErrorMsgs = [\n\t'Failed to fetch', // Chrome\n\t'NetworkError when attempting to fetch resource.', // Firefox\n\t'The Internet connection appears to be offline.', // Safari\n\t'Network request failed' // `cross-fetch`\n];\n\nclass AbortError extends Error {\n\tconstructor(message) {\n\t\tsuper();\n\n\t\tif (message instanceof Error) {\n\t\t\tthis.originalError = message;\n\t\t\t({message} = message);\n\t\t} else {\n\t\t\tthis.originalError = new Error(message);\n\t\t\tthis.originalError.stack = this.stack;\n\t\t}\n\n\t\tthis.name = 'AbortError';\n\t\tthis.message = message;\n\t}\n}\n\nconst decorateErrorWithCounts = (error, attemptNumber, options) => {\n\t// Minus 1 from attemptNumber because the first attempt does not count as a retry\n\tconst retriesLeft = options.retries - (attemptNumber - 1);\n\n\terror.attemptNumber = attemptNumber;\n\terror.retriesLeft = retriesLeft;\n\treturn error;\n};\n\nconst isNetworkError = errorMessage => networkErrorMsgs.includes(errorMessage);\n\nconst pRetry = (input, options) => new Promise((resolve, reject) => {\n\toptions = {\n\t\tonFailedAttempt: () => {},\n\t\tretries: 10,\n\t\t...options\n\t};\n\n\tconst operation = retry.operation(options);\n\n\toperation.attempt(async attemptNumber => {\n\t\ttry {\n\t\t\tresolve(await input(attemptNumber));\n\t\t} catch (error) {\n\t\t\tif (!(error instanceof Error)) {\n\t\t\t\treject(new TypeError(`Non-error was thrown: \"${error}\". You should only throw errors.`));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (error instanceof AbortError) {\n\t\t\t\toperation.stop();\n\t\t\t\treject(error.originalError);\n\t\t\t} else if (error instanceof TypeError && !isNetworkError(error.message)) {\n\t\t\t\toperation.stop();\n\t\t\t\treject(error);\n\t\t\t} else {\n\t\t\t\tdecorateErrorWithCounts(error, attemptNumber, options);\n\n\t\t\t\ttry {\n\t\t\t\t\tawait options.onFailedAttempt(error);\n\t\t\t\t} catch (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!operation.retry(error)) {\n\t\t\t\t\treject(operation.mainError());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n});\n\nmodule.exports = pRetry;\n// TODO: remove this in the next major version\nmodule.exports.default = pRetry;\n\nmodule.exports.AbortError = AbortError;\n","module.exports = require('./lib/retry');","var RetryOperation = require('./retry_operation');\n\nexports.operation = function(options) {\n  var timeouts = exports.timeouts(options);\n  return new RetryOperation(timeouts, {\n      forever: options && (options.forever || options.retries === Infinity),\n      unref: options && options.unref,\n      maxRetryTime: options && options.maxRetryTime\n  });\n};\n\nexports.timeouts = function(options) {\n  if (options instanceof Array) {\n    return [].concat(options);\n  }\n\n  var opts = {\n    retries: 10,\n    factor: 2,\n    minTimeout: 1 * 1000,\n    maxTimeout: Infinity,\n    randomize: false\n  };\n  for (var key in options) {\n    opts[key] = options[key];\n  }\n\n  if (opts.minTimeout > opts.maxTimeout) {\n    throw new Error('minTimeout is greater than maxTimeout');\n  }\n\n  var timeouts = [];\n  for (var i = 0; i < opts.retries; i++) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  if (options && options.forever && !timeouts.length) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  // sort the array numerically ascending\n  timeouts.sort(function(a,b) {\n    return a - b;\n  });\n\n  return timeouts;\n};\n\nexports.createTimeout = function(attempt, opts) {\n  var random = (opts.randomize)\n    ? (Math.random() + 1)\n    : 1;\n\n  var timeout = Math.round(random * Math.max(opts.minTimeout, 1) * Math.pow(opts.factor, attempt));\n  timeout = Math.min(timeout, opts.maxTimeout);\n\n  return timeout;\n};\n\nexports.wrap = function(obj, options, methods) {\n  if (options instanceof Array) {\n    methods = options;\n    options = null;\n  }\n\n  if (!methods) {\n    methods = [];\n    for (var key in obj) {\n      if (typeof obj[key] === 'function') {\n        methods.push(key);\n      }\n    }\n  }\n\n  for (var i = 0; i < methods.length; i++) {\n    var method   = methods[i];\n    var original = obj[method];\n\n    obj[method] = function retryWrapper(original) {\n      var op       = exports.operation(options);\n      var args     = Array.prototype.slice.call(arguments, 1);\n      var callback = args.pop();\n\n      args.push(function(err) {\n        if (op.retry(err)) {\n          return;\n        }\n        if (err) {\n          arguments[0] = op.mainError();\n        }\n        callback.apply(this, arguments);\n      });\n\n      op.attempt(function() {\n        original.apply(obj, args);\n      });\n    }.bind(obj, original);\n    obj[method].options = options;\n  }\n};\n","function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = { forever: options };\n  }\n\n  this._originalTimeouts = JSON.parse(JSON.stringify(timeouts));\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._maxRetryTime = options && options.maxRetryTime || Infinity;\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n  this._operationStart = null;\n  this._timer = null;\n\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\n\nRetryOperation.prototype.reset = function() {\n  this._attempts = 1;\n  this._timeouts = this._originalTimeouts.slice(0);\n}\n\nRetryOperation.prototype.stop = function() {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n  if (this._timer) {\n    clearTimeout(this._timer);\n  }\n\n  this._timeouts       = [];\n  this._cachedTimeouts = null;\n};\n\nRetryOperation.prototype.retry = function(err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  if (!err) {\n    return false;\n  }\n  var currentTime = new Date().getTime();\n  if (err && currentTime - this._operationStart >= this._maxRetryTime) {\n    this._errors.push(err);\n    this._errors.unshift(new Error('RetryOperation timeout occurred'));\n    return false;\n  }\n\n  this._errors.push(err);\n\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(0, this._errors.length - 1);\n      timeout = this._cachedTimeouts.slice(-1);\n    } else {\n      return false;\n    }\n  }\n\n  var self = this;\n  this._timer = setTimeout(function() {\n    self._attempts++;\n\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function() {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n\n      if (self._options.unref) {\n          self._timeout.unref();\n      }\n    }\n\n    self._fn(self._attempts);\n  }, timeout);\n\n  if (this._options.unref) {\n      this._timer.unref();\n  }\n\n  return true;\n};\n\nRetryOperation.prototype.attempt = function(fn, timeoutOps) {\n  this._fn = fn;\n\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function() {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n\n  this._operationStart = new Date().getTime();\n\n  this._fn(this._attempts);\n};\n\nRetryOperation.prototype.try = function(fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = function(fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = RetryOperation.prototype.try;\n\nRetryOperation.prototype.errors = function() {\n  return this._errors;\n};\n\nRetryOperation.prototype.attempts = function() {\n  return this._attempts;\n};\n\nRetryOperation.prototype.mainError = function() {\n  if (this._errors.length === 0) {\n    return null;\n  }\n\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n\n    counts[message] = count;\n\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n\n  return mainError;\n};\n","'use strict';\n\n\nvar data = require('./data.json');\n\nfunction escapeRegexp(str) {\n  return str.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n}\n\nvar REPLACE_RE = RegExp(Object.keys(data).map(escapeRegexp).join('|'), 'g');\n\nfunction replace_fn(match) {\n  return data[match];\n}\n\nfunction unhomoglyph(str) {\n  return str.replace(REPLACE_RE, replace_fn);\n}\n\nmodule.exports = unhomoglyph;\n","/*\r\nCopyright 2024 New Vector Ltd.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\n/**\r\n * Because we've been saving a lot of additional logger data in the localStorage for no particular reason\r\n * we need to, hopefully, unbrick user's devices by geting rid of unnecessary data.\r\n * */\r\n\r\nif (window.localStorage) {\r\n    Object.keys(window.localStorage).forEach((key) => {\r\n        if (key.startsWith(\"loglevel:\")) {\r\n            window.localStorage.removeItem(key);\r\n        }\r\n    });\r\n}\r\n","/*!\r\n * modernizr v3.13.0\r\n * Build https://modernizr.com/download?-cors-cryptography-cssanimations-cssfilters-displaytable-es5date-es5function-es5object-es5undefined-es6array-es6collections-es6string-fetch-flexbox-json-localstorage-objectfit-promises-resizeobserver-sandbox-svg-svgasimg-svgfilters-urlparser-urlsearchparams-webaudio-dontmin\r\n *\r\n * Copyright (c)\r\n *  Faruk Ates\r\n *  Paul Irish\r\n *  Alex Sexton\r\n *  Ryan Seddon\r\n *  Patrick Kettner\r\n *  Stu Cox\r\n *  Richard Herrera\r\n *  Veeck\r\n\r\n * MIT License\r\n */\r\n\r\n/*\r\n * Modernizr tests which native CSS3 and HTML5 features are available in the\r\n * current UA and makes the results available to you in two ways: as properties on\r\n * a global `Modernizr` object, and as classes on the `<html>` element. This\r\n * information allows you to progressively enhance your pages with a granular level\r\n * of control over the experience.\r\n*/\r\n\r\n;(function(scriptGlobalObject, window, document, undefined){\r\n\r\n  var tests = [];\r\n  \r\n\r\n  /**\r\n   * ModernizrProto is the constructor for Modernizr\r\n   *\r\n   * @class\r\n   * @access public\r\n   */\r\n  var ModernizrProto = {\r\n    _version: '3.13.0',\r\n\r\n    // Any settings that don't work as separate modules\r\n    // can go in here as configuration.\r\n    _config: {\r\n      'classPrefix': '',\r\n      'enableClasses': false,\r\n      'enableJSClass': true,\r\n      'usePrefixes': true\r\n    },\r\n\r\n    // Queue of tests\r\n    _q: [],\r\n\r\n    // Stub these for people who are listening\r\n    on: function(test, cb) {\r\n      // I don't really think people should do this, but we can\r\n      // safe guard it a bit.\r\n      // -- NOTE:: this gets WAY overridden in src/addTest for actual async tests.\r\n      // This is in case people listen to synchronous tests. I would leave it out,\r\n      // but the code to *disallow* sync tests in the real version of this\r\n      // function is actually larger than this.\r\n      var self = this;\r\n      setTimeout(function() {\r\n        cb(self[test]);\r\n      }, 0);\r\n    },\r\n\r\n    addTest: function(name, fn, options) {\r\n      tests.push({name: name, fn: fn, options: options});\r\n    },\r\n\r\n    addAsyncTest: function(fn) {\r\n      tests.push({name: null, fn: fn});\r\n    }\r\n  };\r\n\r\n  \r\n\r\n  // Fake some of Object.create so we can force non test results to be non \"own\" properties.\r\n  var Modernizr = function() {};\r\n  Modernizr.prototype = ModernizrProto;\r\n\r\n  // Leak modernizr globally when you `require` it rather than force it here.\r\n  // Overwrite name so constructor name is nicer :D\r\n  Modernizr = new Modernizr();\r\n\r\n  \r\n\r\n  var classes = [];\r\n  \r\n\r\n  /**\r\n   * is returns a boolean if the typeof an obj is exactly type.\r\n   *\r\n   * @access private\r\n   * @function is\r\n   * @param {*} obj - A thing we want to check the type of\r\n   * @param {string} type - A string to compare the typeof against\r\n   * @returns {boolean} true if the typeof the first parameter is exactly the specified type, false otherwise\r\n   */\r\n  function is(obj, type) {\r\n    return typeof obj === type;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * Run through all tests and detect their support in the current UA.\r\n   *\r\n   * @access private\r\n   * @returns {void}\r\n   */\r\n  function testRunner() {\r\n    var featureNames;\r\n    var feature;\r\n    var aliasIdx;\r\n    var result;\r\n    var nameIdx;\r\n    var featureName;\r\n    var featureNameSplit;\r\n\r\n    for (var featureIdx in tests) {\r\n      if (tests.hasOwnProperty(featureIdx)) {\r\n        featureNames = [];\r\n        feature = tests[featureIdx];\r\n        // run the test, throw the return value into the Modernizr,\r\n        // then based on that boolean, define an appropriate className\r\n        // and push it into an array of classes we'll join later.\r\n        //\r\n        // If there is no name, it's an 'async' test that is run,\r\n        // but not directly added to the object. That should\r\n        // be done with a post-run addTest call.\r\n        if (feature.name) {\r\n          featureNames.push(feature.name.toLowerCase());\r\n\r\n          if (feature.options && feature.options.aliases && feature.options.aliases.length) {\r\n            // Add all the aliases into the names list\r\n            for (aliasIdx = 0; aliasIdx < feature.options.aliases.length; aliasIdx++) {\r\n              featureNames.push(feature.options.aliases[aliasIdx].toLowerCase());\r\n            }\r\n          }\r\n        }\r\n\r\n        // Run the test, or use the raw value if it's not a function\r\n        result = is(feature.fn, 'function') ? feature.fn() : feature.fn;\r\n\r\n        // Set each of the names on the Modernizr object\r\n        for (nameIdx = 0; nameIdx < featureNames.length; nameIdx++) {\r\n          featureName = featureNames[nameIdx];\r\n          // Support dot properties as sub tests. We don't do checking to make sure\r\n          // that the implied parent tests have been added. You must call them in\r\n          // order (either in the test, or make the parent test a dependency).\r\n          //\r\n          // Cap it to TWO to make the logic simple and because who needs that kind of subtesting\r\n          // hashtag famous last words\r\n          featureNameSplit = featureName.split('.');\r\n\r\n          if (featureNameSplit.length === 1) {\r\n            Modernizr[featureNameSplit[0]] = result;\r\n          } else {\r\n            // cast to a Boolean, if not one already or if it doesnt exist yet (like inputtypes)\r\n            if (!Modernizr[featureNameSplit[0]] || Modernizr[featureNameSplit[0]] && !(Modernizr[featureNameSplit[0]] instanceof Boolean)) {\r\n              Modernizr[featureNameSplit[0]] = new Boolean(Modernizr[featureNameSplit[0]]);\r\n            }\r\n\r\n            Modernizr[featureNameSplit[0]][featureNameSplit[1]] = result;\r\n          }\r\n\r\n          classes.push((result ? '' : 'no-') + featureNameSplit.join('-'));\r\n        }\r\n      }\r\n    }\r\n  }\r\n  ;\r\n\r\n  /**\r\n   * If the browsers follow the spec, then they would expose vendor-specific styles as:\r\n   *   elem.style.WebkitBorderRadius\r\n   * instead of something like the following (which is technically incorrect):\r\n   *   elem.style.webkitBorderRadius\r\n   *\r\n   * WebKit ghosts their properties in lowercase but Opera & Moz do not.\r\n   * Microsoft uses a lowercase `ms` instead of the correct `Ms` in IE8+\r\n   *   erik.eae.net/archives/2008/03/10/21.48.10/\r\n   *\r\n   * More here: github.com/Modernizr/Modernizr/issues/issue/21\r\n   *\r\n   * @access private\r\n   * @returns {string} The string representing the vendor-specific style properties\r\n   */\r\n  var omPrefixes = 'Moz O ms Webkit';\r\n  \r\n\r\n  var cssomPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.split(' ') : []);\r\n  ModernizrProto._cssomPrefixes = cssomPrefixes;\r\n  \r\n\r\n  /**\r\n   * contains checks to see if a string contains another string\r\n   *\r\n   * @access private\r\n   * @function contains\r\n   * @param {string} str - The string we want to check for substrings\r\n   * @param {string} substr - The substring we want to search the first string for\r\n   * @returns {boolean} true if and only if the first string 'str' contains the second string 'substr'\r\n   */\r\n  function contains(str, substr) {\r\n    return !!~('' + str).indexOf(substr);\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * docElement is a convenience wrapper to grab the root element of the document\r\n   *\r\n   * @access private\r\n   * @returns {HTMLElement|SVGElement} The root element of the document\r\n   */\r\n  var docElement = document.documentElement;\r\n  \r\n\r\n  /**\r\n   * A convenience helper to check if the document we are running in is an SVG document\r\n   *\r\n   * @access private\r\n   * @returns {boolean}\r\n   */\r\n  var isSVG = docElement.nodeName.toLowerCase() === 'svg';\r\n\r\n  \r\n\r\n  /**\r\n   * createElement is a convenience wrapper around document.createElement. Since we\r\n   * use createElement all over the place, this allows for (slightly) smaller code\r\n   * as well as abstracting away issues with creating elements in contexts other than\r\n   * HTML documents (e.g. SVG documents).\r\n   *\r\n   * @access private\r\n   * @function createElement\r\n   * @returns {HTMLElement|SVGElement} An HTML or SVG element\r\n   */\r\n  function createElement() {\r\n    if (typeof document.createElement !== 'function') {\r\n      // This is the case in IE7, where the type of createElement is \"object\".\r\n      // For this reason, we cannot call apply() as Object is not a Function.\r\n      return document.createElement(arguments[0]);\r\n    } else if (isSVG) {\r\n      return document.createElementNS.call(document, 'http://www.w3.org/2000/svg', arguments[0]);\r\n    } else {\r\n      return document.createElement.apply(document, arguments);\r\n    }\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * Create our \"modernizr\" element that we do most feature tests on.\r\n   *\r\n   * @access private\r\n   */\r\n  var modElem = {\r\n    elem: createElement('modernizr')\r\n  };\r\n\r\n  // Clean up this element\r\n  Modernizr._q.push(function() {\r\n    delete modElem.elem;\r\n  });\r\n\r\n  \r\n\r\n  var mStyle = {\r\n    style: modElem.elem.style\r\n  };\r\n\r\n  // kill ref for gc, must happen before mod.elem is removed, so we unshift on to\r\n  // the front of the queue.\r\n  Modernizr._q.unshift(function() {\r\n    delete mStyle.style;\r\n  });\r\n\r\n  \r\n\r\n  /**\r\n   * getBody returns the body of a document, or an element that can stand in for\r\n   * the body if a real body does not exist\r\n   *\r\n   * @access private\r\n   * @function getBody\r\n   * @returns {HTMLElement|SVGElement} Returns the real body of a document, or an\r\n   * artificially created element that stands in for the body\r\n   */\r\n  function getBody() {\r\n    // After page load injecting a fake body doesn't work so check if body exists\r\n    var body = document.body;\r\n\r\n    if (!body) {\r\n      // Can't use the real body create a fake one.\r\n      body = createElement(isSVG ? 'svg' : 'body');\r\n      body.fake = true;\r\n    }\r\n\r\n    return body;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * injectElementWithStyles injects an element with style element and some CSS rules\r\n   *\r\n   * @access private\r\n   * @function injectElementWithStyles\r\n   * @param {string} rule - String representing a css rule\r\n   * @param {Function} callback - A function that is used to test the injected element\r\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\r\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\r\n   * @returns {boolean} the result of the specified callback test\r\n   */\r\n  function injectElementWithStyles(rule, callback, nodes, testnames) {\r\n    var mod = 'modernizr';\r\n    var style;\r\n    var ret;\r\n    var node;\r\n    var docOverflow;\r\n    var div = createElement('div');\r\n    var body = getBody();\r\n\r\n    if (parseInt(nodes, 10)) {\r\n      // In order not to give false positives we create a node for each test\r\n      // This also allows the method to scale for unspecified uses\r\n      while (nodes--) {\r\n        node = createElement('div');\r\n        node.id = testnames ? testnames[nodes] : mod + (nodes + 1);\r\n        div.appendChild(node);\r\n      }\r\n    }\r\n\r\n    style = createElement('style');\r\n    style.type = 'text/css';\r\n    style.id = 's' + mod;\r\n\r\n    // IE6 will false positive on some tests due to the style element inside the test div somehow interfering offsetHeight, so insert it into body or fakebody.\r\n    // Opera will act all quirky when injecting elements in documentElement when page is served as xml, needs fakebody too. #270\r\n    (!body.fake ? div : body).appendChild(style);\r\n    body.appendChild(div);\r\n\r\n    if (style.styleSheet) {\r\n      style.styleSheet.cssText = rule;\r\n    } else {\r\n      style.appendChild(document.createTextNode(rule));\r\n    }\r\n    div.id = mod;\r\n\r\n    if (body.fake) {\r\n      //avoid crashing IE8, if background image is used\r\n      body.style.background = '';\r\n      //Safari 5.13/5.1.4 OSX stops loading if ::-webkit-scrollbar is used and scrollbars are visible\r\n      body.style.overflow = 'hidden';\r\n      docOverflow = docElement.style.overflow;\r\n      docElement.style.overflow = 'hidden';\r\n      docElement.appendChild(body);\r\n    }\r\n\r\n    ret = callback(div, rule);\r\n    // If this is done after page load we don't want to remove the body so check if body exists\r\n    if (body.fake && body.parentNode) {\r\n      body.parentNode.removeChild(body);\r\n      docElement.style.overflow = docOverflow;\r\n      // Trigger layout so kinetic scrolling isn't disabled in iOS6+\r\n      // eslint-disable-next-line\r\n      docElement.offsetHeight;\r\n    } else {\r\n      div.parentNode.removeChild(div);\r\n    }\r\n\r\n    return !!ret;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * domToCSS takes a camelCase string and converts it to hyphen-case\r\n   * e.g. boxSizing -> box-sizing\r\n   *\r\n   * @access private\r\n   * @function domToCSS\r\n   * @param {string} name - String name of camelCase prop we want to convert\r\n   * @returns {string} The hyphen-case version of the supplied name\r\n   */\r\n  function domToCSS(name) {\r\n    return name.replace(/([A-Z])/g, function(str, m1) {\r\n      return '-' + m1.toLowerCase();\r\n    }).replace(/^ms-/, '-ms-');\r\n  }\r\n\r\n  ;\r\n\r\n\r\n  /**\r\n   * wrapper around getComputedStyle, to fix issues with Firefox returning null when\r\n   * called inside of a hidden iframe\r\n   *\r\n   * @access private\r\n   * @function computedStyle\r\n   * @param {HTMLElement|SVGElement} elem - The element we want to find the computed styles of\r\n   * @param {string|null} [pseudo] - An optional pseudo element selector (e.g. :before), of null if none\r\n   * @param {string} prop - A CSS property\r\n   * @returns {CSSStyleDeclaration} the value of the specified CSS property\r\n   */\r\n  function computedStyle(elem, pseudo, prop) {\r\n    var result;\r\n\r\n    if ('getComputedStyle' in window) {\r\n      result = getComputedStyle.call(window, elem, pseudo);\r\n      var console = window.console;\r\n\r\n      if (result !== null) {\r\n        if (prop) {\r\n          result = result.getPropertyValue(prop);\r\n        }\r\n      } else {\r\n        if (console) {\r\n          var method = console.error ? 'error' : 'log';\r\n          console[method].call(console, 'getComputedStyle returning null, its possible modernizr test results are inaccurate');\r\n        }\r\n      }\r\n    } else {\r\n      result = !pseudo && elem.currentStyle && elem.currentStyle[prop];\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * nativeTestProps allows for us to use native feature detection functionality if available.\r\n   * some prefixed form, or false, in the case of an unsupported rule\r\n   *\r\n   * @access private\r\n   * @function nativeTestProps\r\n   * @param {Array} props - An array of property names\r\n   * @param {string} value - A string representing the value we want to check via @supports\r\n   * @returns {boolean|undefined} A boolean when @supports exists, undefined otherwise\r\n   */\r\n  // Accepts a list of property names and a single value\r\n  // Returns `undefined` if native detection not available\r\n  function nativeTestProps(props, value) {\r\n    var i = props.length;\r\n    // Start with the JS API: https://www.w3.org/TR/css3-conditional/#the-css-interface\r\n    if ('CSS' in window && 'supports' in window.CSS) {\r\n      // Try every prefixed variant of the property\r\n      while (i--) {\r\n        if (window.CSS.supports(domToCSS(props[i]), value)) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n    // Otherwise fall back to at-rule (for Opera 12.x)\r\n    else if ('CSSSupportsRule' in window) {\r\n      // Build a condition string for every prefixed variant\r\n      var conditionText = [];\r\n      while (i--) {\r\n        conditionText.push('(' + domToCSS(props[i]) + ':' + value + ')');\r\n      }\r\n      conditionText = conditionText.join(' or ');\r\n      return injectElementWithStyles('@supports (' + conditionText + ') { #modernizr { position: absolute; } }', function(node) {\r\n        return computedStyle(node, null, 'position') === 'absolute';\r\n      });\r\n    }\r\n    return undefined;\r\n  }\r\n  ;\r\n\r\n  /**\r\n   * cssToDOM takes a hyphen-case string and converts it to camelCase\r\n   * e.g. box-sizing -> boxSizing\r\n   *\r\n   * @access private\r\n   * @function cssToDOM\r\n   * @param {string} name - String name of hyphen-case prop we want to convert\r\n   * @returns {string} The camelCase version of the supplied name\r\n   */\r\n  function cssToDOM(name) {\r\n    return name.replace(/([a-z])-([a-z])/g, function(str, m1, m2) {\r\n      return m1 + m2.toUpperCase();\r\n    }).replace(/^-/, '');\r\n  }\r\n\r\n  ;\r\n\r\n  // testProps is a generic CSS / DOM property test.\r\n\r\n  // In testing support for a given CSS property, it's legit to test:\r\n  //    `elem.style[styleName] !== undefined`\r\n  // If the property is supported it will return an empty string,\r\n  // if unsupported it will return undefined.\r\n\r\n  // We'll take advantage of this quick test and skip setting a style\r\n  // on our modernizr element, but instead just testing undefined vs\r\n  // empty string.\r\n\r\n  // Property names can be provided in either camelCase or hyphen-case.\r\n\r\n  function testProps(props, prefixed, value, skipValueTest) {\r\n    skipValueTest = is(skipValueTest, 'undefined') ? false : skipValueTest;\r\n\r\n    // Try native detect first\r\n    if (!is(value, 'undefined')) {\r\n      var result = nativeTestProps(props, value);\r\n      if (!is(result, 'undefined')) {\r\n        return result;\r\n      }\r\n    }\r\n\r\n    // Otherwise do it properly\r\n    var afterInit, i, propsLength, prop, before;\r\n\r\n    // If we don't have a style element, that means we're running async or after\r\n    // the core tests, so we'll need to create our own elements to use.\r\n\r\n    // Inside of an SVG element, in certain browsers, the `style` element is only\r\n    // defined for valid tags. Therefore, if `modernizr` does not have one, we\r\n    // fall back to a less used element and hope for the best.\r\n    // For strict XHTML browsers the hardly used samp element is used.\r\n    var elems = ['modernizr', 'tspan', 'samp'];\r\n    while (!mStyle.style && elems.length) {\r\n      afterInit = true;\r\n      mStyle.modElem = createElement(elems.shift());\r\n      mStyle.style = mStyle.modElem.style;\r\n    }\r\n\r\n    // Delete the objects if we created them.\r\n    function cleanElems() {\r\n      if (afterInit) {\r\n        delete mStyle.style;\r\n        delete mStyle.modElem;\r\n      }\r\n    }\r\n\r\n    propsLength = props.length;\r\n    for (i = 0; i < propsLength; i++) {\r\n      prop = props[i];\r\n      before = mStyle.style[prop];\r\n\r\n      if (contains(prop, '-')) {\r\n        prop = cssToDOM(prop);\r\n      }\r\n\r\n      if (mStyle.style[prop] !== undefined) {\r\n\r\n        // If value to test has been passed in, do a set-and-check test.\r\n        // 0 (integer) is a valid property value, so check that `value` isn't\r\n        // undefined, rather than just checking it's truthy.\r\n        if (!skipValueTest && !is(value, 'undefined')) {\r\n\r\n          // Needs a try catch block because of old IE. This is slow, but will\r\n          // be avoided in most cases because `skipValueTest` will be used.\r\n          try {\r\n            mStyle.style[prop] = value;\r\n          } catch (e) {}\r\n\r\n          // If the property value has changed, we assume the value used is\r\n          // supported. If `value` is empty string, it'll fail here (because\r\n          // it hasn't changed), which matches how browsers have implemented\r\n          // CSS.supports()\r\n          if (mStyle.style[prop] !== before) {\r\n            cleanElems();\r\n            return prefixed === 'pfx' ? prop : true;\r\n          }\r\n        }\r\n        // Otherwise just return true, or the property name if this is a\r\n        // `prefixed()` call\r\n        else {\r\n          cleanElems();\r\n          return prefixed === 'pfx' ? prop : true;\r\n        }\r\n      }\r\n    }\r\n    cleanElems();\r\n    return false;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * List of JavaScript DOM values used for tests\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr._domPrefixes\r\n   * @optionName Modernizr._domPrefixes\r\n   * @optionProp domPrefixes\r\n   * @access public\r\n   * @example\r\n   *\r\n   * Modernizr._domPrefixes is exactly the same as [_prefixes](#modernizr-_prefixes), but rather\r\n   * than hyphen-case properties, all properties are their Capitalized variant\r\n   *\r\n   * ```js\r\n   * Modernizr._domPrefixes === [ \"Moz\", \"O\", \"ms\", \"Webkit\" ];\r\n   * ```\r\n   */\r\n  var domPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.toLowerCase().split(' ') : []);\r\n  ModernizrProto._domPrefixes = domPrefixes;\r\n  \r\n\r\n  /**\r\n   * fnBind is a super small [bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind) polyfill.\r\n   *\r\n   * @access private\r\n   * @function fnBind\r\n   * @param {Function} fn - a function you want to change `this` reference to\r\n   * @param {object} that - the `this` you want to call the function with\r\n   * @returns {Function} The wrapped version of the supplied function\r\n   */\r\n  function fnBind(fn, that) {\r\n    return function() {\r\n      return fn.apply(that, arguments);\r\n    };\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * testDOMProps is a generic DOM property test; if a browser supports\r\n   *   a certain property, it won't return undefined for it.\r\n   *\r\n   * @access private\r\n   * @function testDOMProps\r\n   * @param {Array<string>} props - An array of properties to test for\r\n   * @param {object} obj - An object or Element you want to use to test the parameters again\r\n   * @param {boolean|object} elem - An Element to bind the property lookup again. Use `false` to prevent the check\r\n   * @returns {boolean|*} returns `false` if the prop is unsupported, otherwise the value that is supported\r\n   */\r\n  function testDOMProps(props, obj, elem) {\r\n    var item;\r\n\r\n    for (var i in props) {\r\n      if (props[i] in obj) {\r\n\r\n        // return the property name as a string\r\n        if (elem === false) {\r\n          return props[i];\r\n        }\r\n\r\n        item = obj[props[i]];\r\n\r\n        // let's bind a function\r\n        if (is(item, 'function')) {\r\n          // bind to obj unless overridden\r\n          return fnBind(item, elem || obj);\r\n        }\r\n\r\n        // return the unbound function or obj or value\r\n        return item;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  ;\r\n\r\n  /**\r\n   * testPropsAll tests a list of DOM properties we want to check against.\r\n   * We specify literally ALL possible (known and/or likely) properties on\r\n   * the element including the non-vendor prefixed one, for forward-\r\n   * compatibility.\r\n   *\r\n   * @access private\r\n   * @function testPropsAll\r\n   * @param {string} prop - A string of the property to test for\r\n   * @param {string|object} [prefixed] - An object to check the prefixed properties on. Use a string to skip\r\n   * @param {HTMLElement|SVGElement} [elem] - An element used to test the property and value against\r\n   * @param {string} [value] - A string of a css value\r\n   * @param {boolean} [skipValueTest] - An boolean representing if you want to test if value sticks when set\r\n   * @returns {string|boolean} returns the string version of the property, or `false` if it is unsupported\r\n   */\r\n  function testPropsAll(prop, prefixed, elem, value, skipValueTest) {\r\n\r\n    var ucProp = prop.charAt(0).toUpperCase() + prop.slice(1),\r\n      props = (prop + ' ' + cssomPrefixes.join(ucProp + ' ') + ucProp).split(' ');\r\n\r\n    // did they call .prefixed('boxSizing') or are we just testing a prop?\r\n    if (is(prefixed, 'string') || is(prefixed, 'undefined')) {\r\n      return testProps(props, prefixed, value, skipValueTest);\r\n\r\n      // otherwise, they called .prefixed('requestAnimationFrame', window[, elem])\r\n    } else {\r\n      props = (prop + ' ' + (domPrefixes).join(ucProp + ' ') + ucProp).split(' ');\r\n      return testDOMProps(props, prefixed, elem);\r\n    }\r\n  }\r\n\r\n  // Modernizr.testAllProps() investigates whether a given style property,\r\n  // or any of its vendor-prefixed variants, is recognized\r\n  //\r\n  // Note that the property names must be provided in the camelCase variant.\r\n  // Modernizr.testAllProps('boxSizing')\r\n  ModernizrProto.testAllProps = testPropsAll;\r\n\r\n  \r\n\r\n  /**\r\n   * testAllProps determines whether a given CSS property is supported in the browser\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.testAllProps\r\n   * @optionName Modernizr.testAllProps()\r\n   * @optionProp testAllProps\r\n   * @access public\r\n   * @function testAllProps\r\n   * @param {string} prop - String naming the property to test (either camelCase or hyphen-case)\r\n   * @param {string} [value] - String of the value to test\r\n   * @param {boolean} [skipValueTest=false] - Whether to skip testing that the value is supported when using non-native detection\r\n   * @returns {string|boolean} returns the string version of the property, or `false` if it is unsupported\r\n   * @example\r\n   *\r\n   * testAllProps determines whether a given CSS property, in some prefixed form,\r\n   * is supported by the browser.\r\n   *\r\n   * ```js\r\n   * testAllProps('boxSizing')  // true\r\n   * ```\r\n   *\r\n   * It can optionally be given a CSS value in string form to test if a property\r\n   * value is valid\r\n   *\r\n   * ```js\r\n   * testAllProps('display', 'block') // true\r\n   * testAllProps('display', 'penguin') // false\r\n   * ```\r\n   *\r\n   * A boolean can be passed as a third parameter to skip the value check when\r\n   * native detection (@supports) isn't available.\r\n   *\r\n   * ```js\r\n   * testAllProps('shapeOutside', 'content-box', true);\r\n   * ```\r\n   */\r\n  function testAllProps(prop, value, skipValueTest) {\r\n    return testPropsAll(prop, undefined, undefined, value, skipValueTest);\r\n  }\r\n\r\n  ModernizrProto.testAllProps = testAllProps;\r\n\r\n  \r\n/*!\r\n{\r\n  \"name\": \"CSS Animations\",\r\n  \"property\": \"cssanimations\",\r\n  \"caniuse\": \"css-animation\",\r\n  \"polyfills\": [\"transformie\", \"csssandpaper\"],\r\n  \"tags\": [\"css\"],\r\n  \"warnings\": [\"Android < 4 will pass this test, but can only animate a single property at a time\"],\r\n  \"notes\": [{\r\n    \"name\": \"Article: 'Dispelling the Android CSS animation myths'\",\r\n    \"href\": \"https://web.archive.org/web/20180602074607/https://daneden.me/2011/12/14/putting-up-with-androids-bullshit/\"\r\n  }]\r\n}\r\n!*/\r\n/* DOC\r\nDetects whether or not elements can be animated using CSS\r\n*/\r\n\r\n  Modernizr.addTest('cssanimations', testAllProps('animationName', 'a', true));\r\n\r\n\r\n  /**\r\n   * testStyles injects an element with style element and some CSS rules\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.testStyles\r\n   * @optionName Modernizr.testStyles()\r\n   * @optionProp testStyles\r\n   * @access public\r\n   * @function testStyles\r\n   * @param {string} rule - String representing a css rule\r\n   * @param {Function} callback - A function that is used to test the injected element\r\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\r\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\r\n   * @returns {boolean}\r\n   * @example\r\n   *\r\n   * `Modernizr.testStyles` takes a CSS rule and injects it onto the current page\r\n   * along with (possibly multiple) DOM elements. This lets you check for features\r\n   * that can not be detected by simply checking the [IDL](https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Interface_development_guide/IDL_interface_rules).\r\n   *\r\n   * ```js\r\n   * Modernizr.testStyles('#modernizr { width: 9px; color: papayawhip; }', function(elem, rule) {\r\n   *   // elem is the first DOM node in the page (by default #modernizr)\r\n   *   // rule is the first argument you supplied - the CSS rule in string form\r\n   *\r\n   *   addTest('widthworks', elem.style.width === '9px')\r\n   * });\r\n   * ```\r\n   *\r\n   * If your test requires multiple nodes, you can include a third argument\r\n   * indicating how many additional div elements to include on the page. The\r\n   * additional nodes are injected as children of the `elem` that is returned as\r\n   * the first argument to the callback.\r\n   *\r\n   * ```js\r\n   * Modernizr.testStyles('#modernizr {width: 1px}; #modernizr2 {width: 2px}', function(elem) {\r\n   *   document.getElementById('modernizr').style.width === '1px'; // true\r\n   *   document.getElementById('modernizr2').style.width === '2px'; // true\r\n   *   elem.firstChild === document.getElementById('modernizr2'); // true\r\n   * }, 1);\r\n   * ```\r\n   *\r\n   * By default, all of the additional elements have an ID of `modernizr[n]`, where\r\n   * `n` is its index (e.g. the first additional, second overall is `#modernizr2`,\r\n   * the second additional is `#modernizr3`, etc.).\r\n   * If you want to have more meaningful IDs for your function, you can provide\r\n   * them as the fourth argument, as an array of strings\r\n   *\r\n   * ```js\r\n   * Modernizr.testStyles('#foo {width: 10px}; #bar {height: 20px}', function(elem) {\r\n   *   elem.firstChild === document.getElementById('foo'); // true\r\n   *   elem.lastChild === document.getElementById('bar'); // true\r\n   * }, 2, ['foo', 'bar']);\r\n   * ```\r\n   */\r\n  var testStyles = ModernizrProto.testStyles = injectElementWithStyles;\r\n  \r\n/*!\r\n{\r\n  \"name\": \"CSS Display table\",\r\n  \"property\": \"displaytable\",\r\n  \"caniuse\": \"css-table\",\r\n  \"authors\": [\"scottjehl\"],\r\n  \"tags\": [\"css\"],\r\n  \"builderAliases\": [\"css_displaytable\"],\r\n  \"notes\": [{\r\n    \"name\": \"Detects for all additional table display values\",\r\n    \"href\": \"https://pastebin.com/Gk9PeVaQ\"\r\n  }]\r\n}\r\n!*/\r\n/* DOC\r\n`display: table` and `table-cell` test. (both are tested under one name `table-cell` )\r\n*/\r\n\r\n  // If a document is in rtl mode this test will fail so we force ltr mode on the injected\r\n  // element https://github.com/Modernizr/Modernizr/issues/716\r\n  testStyles('#modernizr{display: table; direction: ltr}#modernizr div{display: table-cell; padding: 10px}', function(elem) {\r\n    var ret;\r\n    var child = elem.childNodes;\r\n    ret = child[0].offsetLeft < child[1].offsetLeft;\r\n    Modernizr.addTest('displaytable', ret, {aliases: ['display-table']});\r\n  }, 2);\r\n\r\n\r\n  /**\r\n   * List of property values to set for css tests. See ticket #21\r\n   * https://github.com/modernizr/modernizr/issues/21\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr._prefixes\r\n   * @optionName Modernizr._prefixes\r\n   * @optionProp prefixes\r\n   * @access public\r\n   * @example\r\n   *\r\n   * Modernizr._prefixes is the internal list of prefixes that we test against\r\n   * inside of things like [prefixed](#modernizr-prefixed) and [prefixedCSS](#-code-modernizr-prefixedcss). It is simply\r\n   * an array of hyphen-case vendor prefixes you can use within your code.\r\n   *\r\n   * Some common use cases include\r\n   *\r\n   * Generating all possible prefixed version of a CSS property\r\n   * ```js\r\n   * var rule = Modernizr._prefixes.join('transform: rotate(20deg); ');\r\n   *\r\n   * rule === 'transform: rotate(20deg); webkit-transform: rotate(20deg); moz-transform: rotate(20deg); o-transform: rotate(20deg); ms-transform: rotate(20deg);'\r\n   * ```\r\n   *\r\n   * Generating all possible prefixed version of a CSS value\r\n   * ```js\r\n   * rule = 'display:' +  Modernizr._prefixes.join('flex; display:') + 'flex';\r\n   *\r\n   * rule === 'display:flex; display:-webkit-flex; display:-moz-flex; display:-o-flex; display:-ms-flex; display:flex'\r\n   * ```\r\n   */\r\n  // we use ['',''] rather than an empty array in order to allow a pattern of .`join()`ing prefixes to test\r\n  // values in feature detects to continue to work\r\n  var prefixes = (ModernizrProto._config.usePrefixes ? ' -webkit- -moz- -o- -ms- '.split(' ') : ['','']);\r\n\r\n  // expose these for the plugin API. Look in the source for how to join() them against your input\r\n  ModernizrProto._prefixes = prefixes;\r\n\r\n  \r\n/*!\r\n{\r\n  \"name\": \"CSS Supports\",\r\n  \"property\": \"supports\",\r\n  \"caniuse\": \"css-featurequeries\",\r\n  \"tags\": [\"css\"],\r\n  \"builderAliases\": [\"css_supports\"],\r\n  \"notes\": [{\r\n    \"name\": \"W3C Spec (The @supports rule)\",\r\n    \"href\": \"https://dev.w3.org/csswg/css3-conditional/#at-supports\"\r\n  }, {\r\n    \"name\": \"Related Github Issue\",\r\n    \"href\": \"https://github.com/Modernizr/Modernizr/issues/648\"\r\n  }, {\r\n    \"name\": \"W3C Spec (The CSSSupportsRule interface)\",\r\n    \"href\": \"https://dev.w3.org/csswg/css3-conditional/#the-csssupportsrule-interface\"\r\n  }]\r\n}\r\n!*/\r\n\r\n  var newSyntax = 'CSS' in window && 'supports' in window.CSS;\r\n  var oldSyntax = 'supportsCSS' in window;\r\n  Modernizr.addTest('supports', newSyntax || oldSyntax);\r\n\r\n/*!\r\n{\r\n  \"name\": \"CSS Filters\",\r\n  \"property\": \"cssfilters\",\r\n  \"caniuse\": \"css-filters\",\r\n  \"polyfills\": [\"polyfilter\"],\r\n  \"tags\": [\"css\"],\r\n  \"builderAliases\": [\"css_filters\"],\r\n  \"notes\": [{\r\n    \"name\": \"MDN Docs\",\r\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/CSS/filter\"\r\n  }]\r\n}\r\n!*/\r\n\r\n  Modernizr.addTest('cssfilters', function() {\r\n    if (Modernizr.supports) {\r\n      return testAllProps('filter', 'blur(2px)');\r\n    } else {\r\n      var el = createElement('a');\r\n      el.style.cssText = prefixes.join('filter:blur(2px); ');\r\n      // https://github.com/Modernizr/Modernizr/issues/615\r\n      // documentMode is needed for false positives in oldIE, please see issue above\r\n      return !!el.style.length && ((document.documentMode === undefined || document.documentMode > 9));\r\n    }\r\n  });\r\n\r\n\r\n/*!\r\n{\r\n  \"name\": \"Flexbox\",\r\n  \"property\": \"flexbox\",\r\n  \"caniuse\": \"flexbox\",\r\n  \"tags\": [\"css\"],\r\n  \"notes\": [{\r\n    \"name\": \"The _new_ flexbox\",\r\n    \"href\": \"https://www.w3.org/TR/css-flexbox-1/\"\r\n  }],\r\n  \"warnings\": [\r\n    \"A `true` result for this detect does not imply that the `flex-wrap` property is supported; see the `flexwrap` detect.\"\r\n  ]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for the Flexible Box Layout model, a.k.a. Flexbox, which allows easy manipulation of layout order and sizing within a container.\r\n*/\r\n\r\n  Modernizr.addTest('flexbox', testAllProps('flexBasis', '1px', true));\r\n\r\n\r\n  /**\r\n   * atRule returns a given CSS property at-rule (eg @keyframes), possibly in\r\n   * some prefixed form, or false, in the case of an unsupported rule\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.atRule\r\n   * @optionName Modernizr.atRule()\r\n   * @optionProp atRule\r\n   * @access public\r\n   * @function atRule\r\n   * @param {string} prop - String name of the @-rule to test for\r\n   * @returns {string|boolean} The string representing the (possibly prefixed)\r\n   * valid version of the @-rule, or `false` when it is unsupported.\r\n   * @example\r\n   * ```js\r\n   *  var keyframes = Modernizr.atRule('@keyframes');\r\n   *\r\n   *  if (keyframes) {\r\n   *    // keyframes are supported\r\n   *    // could be `@-webkit-keyframes` or `@keyframes`\r\n   *  } else {\r\n   *    // keyframes === `false`\r\n   *  }\r\n   * ```\r\n   */\r\n  var atRule = function(prop) {\r\n    var length = prefixes.length;\r\n    var cssrule = window.CSSRule;\r\n    var rule;\r\n\r\n    if (typeof cssrule === 'undefined') {\r\n      return undefined;\r\n    }\r\n\r\n    if (!prop) {\r\n      return false;\r\n    }\r\n\r\n    // remove literal @ from beginning of provided property\r\n    prop = prop.replace(/^@/, '');\r\n\r\n    // CSSRules use underscores instead of dashes\r\n    rule = prop.replace(/-/g, '_').toUpperCase() + '_RULE';\r\n\r\n    if (rule in cssrule) {\r\n      return '@' + prop;\r\n    }\r\n\r\n    for (var i = 0; i < length; i++) {\r\n      // prefixes gives us something like -o-, and we want O_\r\n      var prefix = prefixes[i];\r\n      var thisRule = prefix.toUpperCase() + '_' + rule;\r\n\r\n      if (thisRule in cssrule) {\r\n        return '@-' + prefix.toLowerCase() + '-' + prop;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  ModernizrProto.atRule = atRule;\r\n\r\n  \r\n\r\n  /**\r\n   * prefixed returns the prefixed or nonprefixed property name variant of your input\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.prefixed\r\n   * @optionName Modernizr.prefixed()\r\n   * @optionProp prefixed\r\n   * @access public\r\n   * @function prefixed\r\n   * @param {string} prop - String name of the property to test for\r\n   * @param {object} [obj] - An object to test for the prefixed properties on\r\n   * @param {HTMLElement} [elem] - An element used to test specific properties against\r\n   * @returns {string|boolean} The string representing the (possibly prefixed) valid\r\n   * version of the property, or `false` when it is unsupported.\r\n   * @example\r\n   *\r\n   * Modernizr.prefixed takes a string css value in the DOM style camelCase (as\r\n   * opposed to the css style hyphen-case) form and returns the (possibly prefixed)\r\n   * version of that property that the browser actually supports.\r\n   *\r\n   * For example, in older Firefox...\r\n   * ```js\r\n   * prefixed('boxSizing')\r\n   * ```\r\n   * returns 'MozBoxSizing'\r\n   *\r\n   * In newer Firefox, as well as any other browser that support the unprefixed\r\n   * version would simply return `boxSizing`. Any browser that does not support\r\n   * the property at all, it will return `false`.\r\n   *\r\n   * By default, prefixed is checked against a DOM element. If you want to check\r\n   * for a property on another object, just pass it as a second argument\r\n   *\r\n   * ```js\r\n   * var rAF = prefixed('requestAnimationFrame', window);\r\n   *\r\n   * raf(function() {\r\n   *  renderFunction();\r\n   * })\r\n   * ```\r\n   *\r\n   * Note that this will return _the actual function_ - not the name of the function.\r\n   * If you need the actual name of the property, pass in `false` as a third argument\r\n   *\r\n   * ```js\r\n   * var rAFProp = prefixed('requestAnimationFrame', window, false);\r\n   *\r\n   * rafProp === 'WebkitRequestAnimationFrame' // in older webkit\r\n   * ```\r\n   *\r\n   * One common use case for prefixed is if you're trying to determine which transition\r\n   * end event to bind to, you might do something like...\r\n   * ```js\r\n   * var transEndEventNames = {\r\n   *     'WebkitTransition' : 'webkitTransitionEnd', * Saf 6, Android Browser\r\n   *     'MozTransition'    : 'transitionend',       * only for FF < 15\r\n   *     'transition'       : 'transitionend'        * IE10, Opera, Chrome, FF 15+, Saf 7+\r\n   * };\r\n   *\r\n   * var transEndEventName = transEndEventNames[ Modernizr.prefixed('transition') ];\r\n   * ```\r\n   *\r\n   * If you want a similar lookup, but in hyphen-case, you can use [prefixedCSS](#modernizr-prefixedcss).\r\n   */\r\n  var prefixed = ModernizrProto.prefixed = function(prop, obj, elem) {\r\n    if (prop.indexOf('@') === 0) {\r\n      return atRule(prop);\r\n    }\r\n\r\n    if (prop.indexOf('-') !== -1) {\r\n      // Convert hyphen-case to camelCase\r\n      prop = cssToDOM(prop);\r\n    }\r\n    if (!obj) {\r\n      return testPropsAll(prop, 'pfx');\r\n    } else {\r\n      // Testing DOM property e.g. Modernizr.prefixed('requestAnimationFrame', window) // 'mozRequestAnimationFrame'\r\n      return testPropsAll(prop, obj, elem);\r\n    }\r\n  };\r\n\r\n  \r\n/*!\r\n{\r\n  \"name\": \"CSS Object Fit\",\r\n  \"caniuse\": \"object-fit\",\r\n  \"property\": \"objectfit\",\r\n  \"tags\": [\"css\"],\r\n  \"builderAliases\": [\"css_objectfit\"],\r\n  \"notes\": [{\r\n    \"name\": \"Opera Article on Object Fit\",\r\n    \"href\": \"https://dev.opera.com/articles/css3-object-fit-object-position/\"\r\n  }]\r\n}\r\n!*/\r\n\r\n  Modernizr.addTest('objectfit', !!prefixed('objectFit'), {aliases: ['object-fit']});\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES5 Date\",\r\n  \"property\": \"es5date\",\r\n  \"notes\": [{\r\n    \"name\": \"ECMAScript 5.1 Language Specification\",\r\n    \"href\": \"https://www.ecma-international.org/ecma-262/5.1/\"\r\n  }],\r\n  \"polyfills\": [\"es5shim\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"tags\": [\"es5\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 5 Date per specification.\r\n*/\r\n\r\n  Modernizr.addTest('es5date', function() {\r\n    var isoDate = '2013-04-12T06:06:37.307Z',\r\n      canParseISODate = false;\r\n    try {\r\n      canParseISODate = !!Date.parse(isoDate);\r\n    } catch (e) {\r\n      // no ISO date parsing yet\r\n    }\r\n    return !!(Date.now &&\r\n      Date.prototype &&\r\n      Date.prototype.toISOString &&\r\n      Date.prototype.toJSON &&\r\n      canParseISODate);\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES5 Function\",\r\n  \"property\": \"es5function\",\r\n  \"notes\": [{\r\n    \"name\": \"ECMAScript 5.1 Language Specification\",\r\n    \"href\": \"https://www.ecma-international.org/ecma-262/5.1/\"\r\n  }],\r\n  \"polyfills\": [\"es5shim\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"tags\": [\"es5\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 5 Function per specification.\r\n*/\r\n\r\n  Modernizr.addTest('es5function', function() {\r\n    return !!(Function.prototype && Function.prototype.bind);\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES5 Object\",\r\n  \"property\": \"es5object\",\r\n  \"notes\": [{\r\n    \"name\": \"ECMAScript 5.1 Language Specification\",\r\n    \"href\": \"https://www.ecma-international.org/ecma-262/5.1/\"\r\n  }],\r\n  \"polyfills\": [\"es5shim\", \"es5sham\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"tags\": [\"es5\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 5 Object per specification.\r\n*/\r\n\r\n  Modernizr.addTest('es5object', function() {\r\n    return !!(Object.keys &&\r\n      Object.create &&\r\n      Object.getPrototypeOf &&\r\n      Object.getOwnPropertyNames &&\r\n      Object.isSealed &&\r\n      Object.isFrozen &&\r\n      Object.isExtensible &&\r\n      Object.getOwnPropertyDescriptor &&\r\n      Object.defineProperty &&\r\n      Object.defineProperties &&\r\n      Object.seal &&\r\n      Object.freeze &&\r\n      Object.preventExtensions);\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES5 Immutable Undefined\",\r\n  \"property\": \"es5undefined\",\r\n  \"notes\": [{\r\n    \"name\": \"ECMAScript 5.1 Language Specification\",\r\n    \"href\": \"https://www.ecma-international.org/ecma-262/5.1/\"\r\n  }, {\r\n    \"name\": \"original implementation of detect code\",\r\n    \"href\": \"https://kangax.github.io/compat-table/es5/\"\r\n  }],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"tags\": [\"es5\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser prevents assignment to global `undefined` per ECMAScript 5.\r\n*/\r\n\r\n  Modernizr.addTest('es5undefined', function() {\r\n    var result, originalUndefined;\r\n    try {\r\n      originalUndefined = window.undefined;\r\n      window.undefined = 12345;\r\n      result = typeof window.undefined === 'undefined';\r\n      window.undefined = originalUndefined;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n    return result;\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES6 Array\",\r\n  \"property\": \"es6array\",\r\n  \"notes\": [{\r\n    \"name\": \"unofficial ECMAScript 6 draft specification\",\r\n    \"href\": \"https://web.archive.org/web/20180825202128/https://tc39.github.io/ecma262/\"\r\n  }],\r\n  \"polyfills\": [\"es6shim\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"warnings\": [\"ECMAScript 6 is still a only a draft, so this detect may not match the final specification or implementations.\"],\r\n  \"tags\": [\"es6\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 6 Array per specification.\r\n*/\r\n\r\n  Modernizr.addTest('es6array', !!(Array.prototype &&\r\n    Array.prototype.copyWithin &&\r\n    Array.prototype.fill &&\r\n    Array.prototype.find &&\r\n    Array.prototype.findIndex &&\r\n    Array.prototype.keys &&\r\n    Array.prototype.entries &&\r\n    Array.prototype.values &&\r\n    Array.from &&\r\n    Array.of));\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES6 Collections\",\r\n  \"property\": \"es6collections\",\r\n  \"notes\": [{\r\n    \"name\": \"unofficial ECMAScript 6 draft specification\",\r\n    \"href\": \"https://web.archive.org/web/20180825202128/https://tc39.github.io/ecma262/\"\r\n  }],\r\n  \"polyfills\": [\"es6shim\", \"weakmap\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"warnings\": [\"ECMAScript 6 is still a only a draft, so this detect may not match the final specification or implementations.\"],\r\n  \"tags\": [\"es6\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 6 Map, Set, WeakMap and WeakSet\r\n*/\r\n\r\n  Modernizr.addTest('es6collections', !!(\r\n    window.Map && window.Set && window.WeakMap && window.WeakSet\r\n  ));\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES6 Promises\",\r\n  \"property\": \"promises\",\r\n  \"caniuse\": \"promises\",\r\n  \"polyfills\": [\"es6promises\"],\r\n  \"authors\": [\"Krister Kari\", \"Jake Archibald\"],\r\n  \"tags\": [\"es6\"],\r\n  \"notes\": [{\r\n    \"name\": \"The ES6 promises spec\",\r\n    \"href\": \"https://github.com/domenic/promises-unwrapping\"\r\n  }, {\r\n    \"name\": \"Chromium dashboard - ES6 Promises\",\r\n    \"href\": \"https://www.chromestatus.com/features/5681726336532480\"\r\n  }, {\r\n    \"name\": \"JavaScript Promises: an Introduction\",\r\n    \"href\": \"https://developers.google.com/web/fundamentals/primers/promises/\"\r\n  }]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 6 Promises per specification.\r\n*/\r\n\r\n  Modernizr.addTest('promises', function() {\r\n    return 'Promise' in window &&\r\n    // Some of these methods are missing from\r\n    // Firefox/Chrome experimental implementations\r\n    'resolve' in window.Promise &&\r\n    'reject' in window.Promise &&\r\n    'all' in window.Promise &&\r\n    'race' in window.Promise &&\r\n    // Older version of the spec had a resolver object\r\n    // as the arg rather than a function\r\n    (function() {\r\n      var resolve;\r\n      new window.Promise(function(r) { resolve = r; });\r\n      return typeof resolve === 'function';\r\n    }());\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ES6 String\",\r\n  \"property\": \"es6string\",\r\n  \"notes\": [{\r\n    \"name\": \"unofficial ECMAScript 6 draft specification\",\r\n    \"href\": \"https://web.archive.org/web/20180825202128/https://tc39.github.io/ecma262/\"\r\n  }],\r\n  \"polyfills\": [\"es6shim\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"warnings\": [\"ECMAScript 6 is still a only a draft, so this detect may not match the final specification or implementations.\"],\r\n  \"tags\": [\"es6\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements ECMAScript 6 String per specification.\r\n*/\r\n\r\n  Modernizr.addTest('es6string', !!(String.fromCodePoint &&\r\n    String.raw &&\r\n    String.prototype.codePointAt &&\r\n    String.prototype.repeat &&\r\n    String.prototype.startsWith &&\r\n    String.prototype.endsWith &&\r\n    String.prototype.includes));\r\n\r\n/*!\r\n{\r\n  \"name\": \"SVG\",\r\n  \"property\": \"svg\",\r\n  \"caniuse\": \"svg\",\r\n  \"tags\": [\"svg\"],\r\n  \"authors\": [\"Erik Dahlstrom\"],\r\n  \"polyfills\": [\r\n    \"svgweb\",\r\n    \"raphael\",\r\n    \"amplesdk\",\r\n    \"canvg\",\r\n    \"svg-boilerplate\",\r\n    \"sie\",\r\n    \"dojogfx\",\r\n    \"fabricjs\"\r\n  ]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for SVG in `<embed>` or `<object>` elements.\r\n*/\r\n\r\n  Modernizr.addTest('svg', !!document.createElementNS && !!document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect);\r\n\r\n\r\n  /**\r\n   * hasOwnProp is a shim for hasOwnProperty that is needed for Safari 2.0 support\r\n   *\r\n   * @author kangax\r\n   * @access private\r\n   * @function hasOwnProp\r\n   * @param {object} object - The object to check for a property\r\n   * @param {string} property - The property to check for\r\n   * @returns {boolean}\r\n   */\r\n\r\n  // hasOwnProperty shim by kangax needed for Safari 2.0 support\r\n  var hasOwnProp;\r\n\r\n  (function() {\r\n    var _hasOwnProperty = ({}).hasOwnProperty;\r\n    /* istanbul ignore else */\r\n    /* we have no way of testing IE 5.5 or safari 2,\r\n     * so just assume the else gets hit */\r\n    if (!is(_hasOwnProperty, 'undefined') && !is(_hasOwnProperty.call, 'undefined')) {\r\n      hasOwnProp = function(object, property) {\r\n        return _hasOwnProperty.call(object, property);\r\n      };\r\n    }\r\n    else {\r\n      hasOwnProp = function(object, property) { /* yes, this can give false positives/negatives, but most of the time we don't care about those */\r\n        return ((property in object) && is(object.constructor.prototype[property], 'undefined'));\r\n      };\r\n    }\r\n  })();\r\n\r\n  \r\n\r\n  /**\r\n   * setClasses takes an array of class names and adds them to the root element\r\n   *\r\n   * @access private\r\n   * @function setClasses\r\n   * @param {string[]} classes - Array of class names\r\n   */\r\n  // Pass in an and array of class names, e.g.:\r\n  //  ['no-webp', 'borderradius', ...]\r\n  function setClasses(classes) {\r\n    var className = docElement.className;\r\n    var classPrefix = Modernizr._config.classPrefix || '';\r\n\r\n    if (isSVG) {\r\n      className = className.baseVal;\r\n    }\r\n\r\n    // Change `no-js` to `js` (independently of the `enableClasses` option)\r\n    // Handle classPrefix on this too\r\n    if (Modernizr._config.enableJSClass) {\r\n      var reJS = new RegExp('(^|\\\\s)' + classPrefix + 'no-js(\\\\s|$)');\r\n      className = className.replace(reJS, '$1' + classPrefix + 'js$2');\r\n    }\r\n\r\n    if (Modernizr._config.enableClasses) {\r\n      // Add the new classes\r\n      if (classes.length > 0) {\r\n        className += ' ' + classPrefix + classes.join(' ' + classPrefix);\r\n      }\r\n      if (isSVG) {\r\n        docElement.className.baseVal = className;\r\n      } else {\r\n        docElement.className = className;\r\n      }\r\n    }\r\n  }\r\n\r\n  ;\r\n\r\n\r\n  // _l tracks listeners for async tests, as well as tests that execute after the initial run\r\n  ModernizrProto._l = {};\r\n\r\n  /**\r\n   * Modernizr.on is a way to listen for the completion of async tests. Being\r\n   * asynchronous, they may not finish before your scripts run. As a result you\r\n   * will get a possibly false negative `undefined` value.\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.on\r\n   * @access public\r\n   * @function on\r\n   * @param {string} feature - String name of the feature detect\r\n   * @param {Function} cb - Callback function returning a Boolean - true if feature is supported, false if not\r\n   * @returns {void}\r\n   * @example\r\n   *\r\n   * ```js\r\n   * Modernizr.on('flash', function( result ) {\r\n   *   if (result) {\r\n   *    // the browser has flash\r\n   *   } else {\r\n   *     // the browser does not have flash\r\n   *   }\r\n   * });\r\n   * ```\r\n   */\r\n  ModernizrProto.on = function(feature, cb) {\r\n    // Create the list of listeners if it doesn't exist\r\n    if (!this._l[feature]) {\r\n      this._l[feature] = [];\r\n    }\r\n\r\n    // Push this test on to the listener list\r\n    this._l[feature].push(cb);\r\n\r\n    // If it's already been resolved, trigger it on next tick\r\n    if (Modernizr.hasOwnProperty(feature)) {\r\n      // Next Tick\r\n      setTimeout(function() {\r\n        Modernizr._trigger(feature, Modernizr[feature]);\r\n      }, 0);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * _trigger is the private function used to signal test completion and run any\r\n   * callbacks registered through [Modernizr.on](#modernizr-on)\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr._trigger\r\n   * @access private\r\n   * @function _trigger\r\n   * @param {string} feature - string name of the feature detect\r\n   * @param {Function|boolean} [res] - A feature detection function, or the boolean =\r\n   * result of a feature detection function\r\n   * @returns {void}\r\n   */\r\n  ModernizrProto._trigger = function(feature, res) {\r\n    if (!this._l[feature]) {\r\n      return;\r\n    }\r\n\r\n    var cbs = this._l[feature];\r\n\r\n    // Force async\r\n    setTimeout(function() {\r\n      var i, cb;\r\n      for (i = 0; i < cbs.length; i++) {\r\n        cb = cbs[i];\r\n        cb(res);\r\n      }\r\n    }, 0);\r\n\r\n    // Don't trigger these again\r\n    delete this._l[feature];\r\n  };\r\n\r\n  /**\r\n   * addTest allows you to define your own feature detects that are not currently\r\n   * included in Modernizr (under the covers it's the exact same code Modernizr\r\n   * uses for its own [feature detections](https://github.com/Modernizr/Modernizr/tree/master/feature-detects)).\r\n   * Just like the official detects, the result\r\n   * will be added onto the Modernizr object, as well as an appropriate className set on\r\n   * the html element when configured to do so\r\n   *\r\n   * @memberOf Modernizr\r\n   * @name Modernizr.addTest\r\n   * @optionName Modernizr.addTest()\r\n   * @optionProp addTest\r\n   * @access public\r\n   * @function addTest\r\n   * @param {string|object} feature - The string name of the feature detect, or an\r\n   * object of feature detect names and test\r\n   * @param {Function|boolean} test - Function returning true if feature is supported,\r\n   * false if not. Otherwise a boolean representing the results of a feature detection\r\n   * @returns {object} the Modernizr object to allow chaining\r\n   * @example\r\n   *\r\n   * The most common way of creating your own feature detects is by calling\r\n   * `Modernizr.addTest` with a string (preferably just lowercase, without any\r\n   * punctuation), and a function you want executed that will return a boolean result\r\n   *\r\n   * ```js\r\n   * Modernizr.addTest('itsTuesday', function() {\r\n   *  var d = new Date();\r\n   *  return d.getDay() === 2;\r\n   * });\r\n   * ```\r\n   *\r\n   * When the above is run, it will set Modernizr.itstuesday to `true` when it is tuesday,\r\n   * and to `false` every other day of the week. One thing to notice is that the names of\r\n   * feature detect functions are always lowercased when added to the Modernizr object. That\r\n   * means that `Modernizr.itsTuesday` will not exist, but `Modernizr.itstuesday` will.\r\n   *\r\n   *\r\n   *  Since we only look at the returned value from any feature detection function,\r\n   *  you do not need to actually use a function. For simple detections, just passing\r\n   *  in a statement that will return a boolean value works just fine.\r\n   *\r\n   * ```js\r\n   * Modernizr.addTest('hasjquery', 'jQuery' in window);\r\n   * ```\r\n   *\r\n   * Just like before, when the above runs `Modernizr.hasjquery` will be true if\r\n   * jQuery has been included on the page. Not using a function saves a small amount\r\n   * of overhead for the browser, as well as making your code much more readable.\r\n   *\r\n   * Finally, you also have the ability to pass in an object of feature names and\r\n   * their tests. This is handy if you want to add multiple detections in one go.\r\n   * The keys should always be a string, and the value can be either a boolean or\r\n   * function that returns a boolean.\r\n   *\r\n   * ```js\r\n   * var detects = {\r\n   *  'hasjquery': 'jQuery' in window,\r\n   *  'itstuesday': function() {\r\n   *    var d = new Date();\r\n   *    return d.getDay() === 2;\r\n   *  }\r\n   * }\r\n   *\r\n   * Modernizr.addTest(detects);\r\n   * ```\r\n   *\r\n   * There is really no difference between the first methods and this one, it is\r\n   * just a convenience to let you write more readable code.\r\n   */\r\n  function addTest(feature, test) {\r\n\r\n    if (typeof feature === 'object') {\r\n      for (var key in feature) {\r\n        if (hasOwnProp(feature, key)) {\r\n          addTest(key, feature[ key ]);\r\n        }\r\n      }\r\n    } else {\r\n\r\n      feature = feature.toLowerCase();\r\n      var featureNameSplit = feature.split('.');\r\n      var last = Modernizr[featureNameSplit[0]];\r\n\r\n      // Again, we don't check for parent test existence. Get that right, though.\r\n      if (featureNameSplit.length === 2) {\r\n        last = last[featureNameSplit[1]];\r\n      }\r\n\r\n      if (typeof last !== 'undefined') {\r\n        // we're going to quit if you're trying to overwrite an existing test\r\n        // if we were to allow it, we'd do this:\r\n        //   var re = new RegExp(\"\\\\b(no-)?\" + feature + \"\\\\b\");\r\n        //   docElement.className = docElement.className.replace( re, '' );\r\n        // but, no rly, stuff 'em.\r\n        return Modernizr;\r\n      }\r\n\r\n      test = typeof test === 'function' ? test() : test;\r\n\r\n      // Set the value (this is the magic, right here).\r\n      if (featureNameSplit.length === 1) {\r\n        Modernizr[featureNameSplit[0]] = test;\r\n      } else {\r\n        // cast to a Boolean, if not one already\r\n        if (Modernizr[featureNameSplit[0]] && !(Modernizr[featureNameSplit[0]] instanceof Boolean)) {\r\n          Modernizr[featureNameSplit[0]] = new Boolean(Modernizr[featureNameSplit[0]]);\r\n        }\r\n\r\n        Modernizr[featureNameSplit[0]][featureNameSplit[1]] = test;\r\n      }\r\n\r\n      // Set a single class (either `feature` or `no-feature`)\r\n      setClasses([(!!test && test !== false ? '' : 'no-') + featureNameSplit.join('-')]);\r\n\r\n      // Trigger the event\r\n      Modernizr._trigger(feature, test);\r\n    }\r\n\r\n    return Modernizr; // allow chaining.\r\n  }\r\n\r\n  // After all the tests are run, add self to the Modernizr prototype\r\n  Modernizr._q.push(function() {\r\n    ModernizrProto.addTest = addTest;\r\n  });\r\n\r\n  \r\n\r\n/*!\r\n{\r\n  \"name\": \"SVG as an <img> tag source\",\r\n  \"property\": \"svgasimg\",\r\n  \"caniuse\": \"svg-img\",\r\n  \"tags\": [\"svg\"],\r\n  \"aliases\": [\"svgincss\"],\r\n  \"authors\": [\"Chris Coyier\"],\r\n  \"notes\": [{\r\n    \"name\": \"HTML5 Spec\",\r\n    \"href\": \"https://www.w3.org/TR/html5/embedded-content-0.html#the-img-element\"\r\n  }]\r\n}\r\n!*/\r\n\r\n\r\n  // Original Async test by Stu Cox\r\n  // https://gist.github.com/chriscoyier/8774501\r\n\r\n  // Now a Sync test based on good results here\r\n  // https://codepen.io/chriscoyier/pen/bADFx\r\n\r\n  // Note http://www.w3.org/TR/SVG11/feature#Image is *supposed* to represent\r\n  // support for the `<image>` tag in SVG, not an SVG file linked from an `<img>`\r\n  // tag in HTML – but it’s a heuristic which works\r\n  Modernizr.addTest('svgasimg', document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#Image', '1.1'));\r\n\r\n/*!\r\n{\r\n  \"name\": \"SVG filters\",\r\n  \"property\": \"svgfilters\",\r\n  \"caniuse\": \"svg-filters\",\r\n  \"tags\": [\"svg\"],\r\n  \"builderAliases\": [\"svg_filters\"],\r\n  \"authors\": [\"Erik Dahlstrom\"],\r\n  \"notes\": [{\r\n    \"name\": \"W3C Spec\",\r\n    \"href\": \"https://www.w3.org/TR/SVG11/filters.html\"\r\n  }]\r\n}\r\n!*/\r\n\r\n  // Should fail in Safari: https://stackoverflow.com/questions/9739955/feature-detecting-support-for-svg-filters.\r\n  Modernizr.addTest('svgfilters', function() {\r\n    var result = false;\r\n    try {\r\n      result = 'SVGFEColorMatrixElement' in window &&\r\n        SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE === 2;\r\n    }\r\n    catch (e) {}\r\n    return result;\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"URL parser\",\r\n  \"property\": \"urlparser\",\r\n  \"notes\": [{\r\n    \"name\": \"WHATWG Spec\",\r\n    \"href\": \"https://url.spec.whatwg.org/\"\r\n  }],\r\n  \"polyfills\": [\"urlparser\"],\r\n  \"authors\": [\"Ron Waldon (@jokeyrhyme)\"],\r\n  \"tags\": [\"url\"]\r\n}\r\n!*/\r\n/* DOC\r\nCheck if browser implements the URL constructor for parsing URLs.\r\n*/\r\n\r\n  Modernizr.addTest('urlparser', function() {\r\n    var url;\r\n    try {\r\n      // have to actually try use it, because Safari defines a dud constructor\r\n      url = new URL('http://modernizr.com/');\r\n      return url.href === 'http://modernizr.com/';\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  });\r\n\r\n/*!\r\n{\r\n  \"property\": \"urlsearchparams\",\r\n  \"caniuse\": \"urlsearchparams\",\r\n  \"tags\": [\"querystring\", \"url\"],\r\n  \"authors\": [\"Cătălin Mariș\"],\r\n  \"name\": \"URLSearchParams API\",\r\n  \"notes\": [{\r\n    \"name\": \"WHATWG Spec\",\r\n    \"href\": \"https://url.spec.whatwg.org/#interface-urlsearchparams\"\r\n  }, {\r\n    \"name\": \"MDN Docs\",\r\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams\"\r\n  }]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for an API that provides utility methods for working with the query string of a URL.\r\n*/\r\n\r\n  Modernizr.addTest('urlsearchparams', 'URLSearchParams' in window);\r\n\r\n/*!\r\n{\r\n  \"name\": \"Cross-Origin Resource Sharing\",\r\n  \"property\": \"cors\",\r\n  \"caniuse\": \"cors\",\r\n  \"authors\": [\"Theodoor van Donge\"],\r\n  \"notes\": [{\r\n    \"name\": \"MDN Docs\",\r\n    \"href\": \"https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS\"\r\n  }],\r\n  \"polyfills\": [\"pmxdr\", \"ppx\", \"flxhr\"]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for Cross-Origin Resource Sharing: method of performing XMLHttpRequests across domains.\r\n*/\r\n\r\n  Modernizr.addTest('cors', 'XMLHttpRequest' in window && 'withCredentials' in new XMLHttpRequest());\r\n\r\n/*!\r\n{\r\n  \"name\": \"Web Cryptography\",\r\n  \"property\": \"cryptography\",\r\n  \"caniuse\": \"cryptography\",\r\n  \"tags\": [\"crypto\"],\r\n  \"authors\": [\"roblarsen\"],\r\n  \"notes\": [{\r\n    \"name\": \"W3C Editor's Draft Spec\",\r\n    \"href\": \"https://www.w3.org/TR/WebCryptoAPI/\"\r\n  }],\r\n  \"polyfills\": [\"polycrypt\"]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for the cryptographic functionality available under window.crypto.subtle\r\n*/\r\n\r\n  var crypto = prefixed('crypto', window);\r\n  Modernizr.addTest('crypto', !!prefixed('subtle', crypto));\r\n\r\n/*!\r\n{\r\n  \"name\": \"iframe[sandbox] Attribute\",\r\n  \"property\": \"sandbox\",\r\n  \"caniuse\": \"iframe-sandbox\",\r\n  \"tags\": [\"iframe\"],\r\n  \"builderAliases\": [\"iframe_sandbox\"],\r\n  \"notes\": [\r\n  {\r\n    \"name\": \"WHATWG Spec\",\r\n    \"href\": \"https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\"\r\n  }],\r\n  \"knownBugs\": [\"False-positive on Firefox < 29\"]\r\n}\r\n!*/\r\n/* DOC\r\nTest for `sandbox` attribute in iframes.\r\n*/\r\n\r\n  Modernizr.addTest('sandbox', 'sandbox' in createElement('iframe'));\r\n\r\n/*!\r\n{\r\n  \"name\": \"JSON\",\r\n  \"property\": \"json\",\r\n  \"caniuse\": \"json\",\r\n  \"notes\": [{\r\n    \"name\": \"MDN Docs\",\r\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Glossary/JSON\"\r\n  }],\r\n  \"polyfills\": [\"json2\"]\r\n}\r\n!*/\r\n/* DOC\r\nDetects native support for JSON handling functions.\r\n*/\r\n\r\n  // this will also succeed if you've loaded the JSON2.js polyfill ahead of time\r\n  //   ... but that should be obvious. :)\r\n\r\n  Modernizr.addTest('json', 'JSON' in window && 'parse' in JSON && 'stringify' in JSON);\r\n\r\n/*!\r\n{\r\n  \"name\": \"Fetch API\",\r\n  \"property\": \"fetch\",\r\n  \"tags\": [\"network\"],\r\n  \"caniuse\": \"fetch\",\r\n  \"notes\": [{\r\n    \"name\": \"WHATWG Spec\",\r\n    \"href\": \"https://fetch.spec.whatwg.org/\"\r\n  }],\r\n  \"polyfills\": [\"fetch\"]\r\n}\r\n!*/\r\n/* DOC\r\nDetects support for the fetch API, a modern replacement for XMLHttpRequest.\r\n*/\r\n\r\n  Modernizr.addTest('fetch', 'fetch' in window);\r\n\r\n/*!\r\n{\r\n  \"name\": \"Local Storage\",\r\n  \"property\": \"localstorage\",\r\n  \"caniuse\": \"namevalue-storage\",\r\n  \"tags\": [\"storage\"],\r\n  \"polyfills\": [\r\n    \"joshuabell-polyfill\",\r\n    \"cupcake\",\r\n    \"storagepolyfill\",\r\n    \"amplifyjs\",\r\n    \"yui-cacheoffline\"\r\n  ]\r\n}\r\n!*/\r\n\r\n  // In FF4, if disabled, window.localStorage should === null.\r\n\r\n  // Normally, we could not test that directly and need to do a\r\n  //   `('localStorage' in window)` test first because otherwise Firefox will\r\n  //   throw bugzil.la/365772 if cookies are disabled\r\n\r\n  // Similarly, in Chrome with \"Block third-party cookies and site data\" enabled,\r\n  // attempting to access `window.sessionStorage` will throw an exception. crbug.com/357625\r\n\r\n  // Also in iOS5 Private Browsing mode, attempting to use localStorage.setItem\r\n  // will throw the exception:\r\n  //   QUOTA_EXCEEDED_ERROR DOM Exception 22.\r\n  // Peculiarly, getItem and removeItem calls do not throw.\r\n\r\n  // Because we are forced to try/catch this, we'll go aggressive.\r\n\r\n  // Just FWIW: IE8 Compat mode supports these features completely:\r\n  //   www.quirksmode.org/dom/html5.html\r\n  // But IE8 doesn't support either with local files\r\n\r\n  Modernizr.addTest('localstorage', function() {\r\n    var mod = 'modernizr';\r\n    try {\r\n      localStorage.setItem(mod, mod);\r\n      localStorage.removeItem(mod);\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  });\r\n\r\n/*!\r\n{\r\n  \"name\": \"ResizeObserver\",\r\n  \"property\": \"resizeobserver\",\r\n  \"caniuse\": \"resizeobserver\",\r\n  \"tags\": [\"ResizeObserver\"],\r\n  \"authors\": [\"Christian Andersson\"],\r\n  \"notes\": [{\r\n    \"name\": \"W3C Spec\",\r\n    \"href\": \"https://www.w3.org/TR/resize-observer/\"\r\n  }, {\r\n    \"name\": \"MDN Docs\",\r\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver\"\r\n  }, {\r\n    \"name\": \"Web.dev Article\",\r\n    \"href\": \"https://web.dev/resize-observer/\"\r\n  }, {\r\n    \"name\": \"Digital Ocean tutorial\",\r\n    \"href\": \"https://www.digitalocean.com/community/tutorials/js-resize-observer\"\r\n  }]\r\n}\r\n!*/\r\n\r\n/* DOC\r\nDetects support for ResizeObserver.\r\n*/\r\n\r\n  Modernizr.addTest('resizeobserver', 'ResizeObserver' in window);\r\n\r\n/*!\r\n{\r\n  \"name\": \"Web Audio API\",\r\n  \"property\": \"webaudio\",\r\n  \"caniuse\": \"audio-api\",\r\n  \"polyfills\": [\"xaudiojs\", \"dynamicaudiojs\", \"audiolibjs\"],\r\n  \"tags\": [\"audio\", \"media\"],\r\n  \"builderAliases\": [\"audio_webaudio_api\"],\r\n  \"authors\": [\"Addy Osmani\"],\r\n  \"notes\": [{\r\n    \"name\": \"W3C Spec\",\r\n    \"href\": \"https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html\"\r\n  }]\r\n}\r\n!*/\r\n/* DOC\r\nDetects the older non standard webaudio API, (as opposed to the standards based AudioContext API)\r\n*/\r\n\r\n  Modernizr.addTest('webaudio', function() {\r\n    var prefixed = 'webkitAudioContext' in window;\r\n    var unprefixed = 'AudioContext' in window;\r\n\r\n    if (Modernizr._config.usePrefixes) {\r\n      return prefixed || unprefixed;\r\n    }\r\n    return unprefixed;\r\n  });\r\n\r\n\r\n  // Run each test\r\n  testRunner();\r\n\r\n  delete ModernizrProto.addTest;\r\n  delete ModernizrProto.addAsyncTest;\r\n\r\n  // Run the things that are supposed to run after the tests\r\n  for (var i = 0; i < Modernizr._q.length; i++) {\r\n    Modernizr._q[i]();\r\n  }\r\n\r\n  // Leak Modernizr namespace\r\n  scriptGlobalObject.Modernizr = Modernizr;\r\n\r\n\r\n;\r\n\r\n})(window, window, document);\r\n","/*\r\nCopyright 2018-2024 New Vector Ltd.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport { type QueryDict, decodeParams } from \"matrix-js-sdk/src/utils\";\r\n\r\n// We want to support some name / value pairs in the fragment\r\n// so we're re-using query string like format\r\n//\r\nexport function parseQsFromFragment(location: Location): { location: string; params: QueryDict } {\r\n    // if we have a fragment, it will start with '#', which we need to drop.\r\n    // (if we don't, this will return '').\r\n    const fragment = location.hash.substring(1);\r\n\r\n    // our fragment may contain a query-param-like section. we need to fish\r\n    // this out *before* URI-decoding because the params may contain ? and &\r\n    // characters which are only URI-encoded once.\r\n    const hashparts = fragment.split(\"?\");\r\n\r\n    const result = {\r\n        location: decodeURIComponent(hashparts[0]),\r\n        params: <QueryDict>{},\r\n    };\r\n\r\n    if (hashparts.length > 1) {\r\n        result.params = decodeParams(hashparts[1]);\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function parseQs(location: Location): QueryDict {\r\n    return decodeParams(location.search.substring(1));\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","__webpack_require__.H = {};\n__webpack_require__.G = (chunkId) => {\n\tObject.keys(__webpack_require__.H).map((key) => {\n\t\t__webpack_require__.H[key](chunkId);\n\t});\n}","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"bundles/\" + __webpack_require__.h() + \"/\" + ({\"1869\":\"styles\",\"2585\":\"intl-segmenter-polyfill\",\"2702\":\"element-web-app\",\"3304\":\"playback.worker\",\"3444\":\"indexeddb.worker\",\"4980\":\"blurhash.worker\",\"5385\":\"init\",\"5607\":\"error-view\"}[chunkId] || chunkId) + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"bundles/\" + __webpack_require__.h() + \"/\" + {\"1869\":\"styles\",\"5607\":\"error-view\"}[chunkId] + \".css\";\n};","__webpack_require__.h = () => (\"14d44db70ea60b163e50\")","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.v = (exports, wasmModuleId, wasmModuleHash, importsObj) => {\n\n\tvar req = fetch(__webpack_require__.p + \"bundles/\" + __webpack_require__.h() + \"/\" + wasmModuleHash + \".wasm\");\n\tvar fallback = () => (req\n\t\t.then((x) => (x.arrayBuffer()))\n\t\t.then((bytes) => (WebAssembly.instantiate(bytes, importsObj)))\n\t\t.then((res) => (Object.assign(exports, res.instance.exports))));\n\treturn req.then((res) => {\n\t\tif (typeof WebAssembly.instantiateStreaming === \"function\") {\n\n\t\t\treturn WebAssembly.instantiateStreaming(res, importsObj)\n\t\t\t\t.then(\n\t\t\t\t\t(res) => (Object.assign(exports, res.instance.exports)),\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tif(res.headers.get(\"Content-Type\") !== \"application/wasm\") {\n\t\t\t\t\t\t\tconsole.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\t\t\t\t\t\t\treturn fallback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}\n\t\treturn fallback();\n\t});\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../../\";","(() => {\n  if (typeof __webpack_require__ !== 'undefined') {\n    var oldGetScript = __webpack_require__.u;\n    var oldLoadScript = __webpack_require__.e;\n    var queryMap = {};\n    var countMap = {};\n    var getRetryDelay = function () {\n      return 500;\n    };\n    __webpack_require__.u = function (chunkId) {\n      var result = oldGetScript(chunkId);\n      return (\n        result +\n        (queryMap.hasOwnProperty(chunkId) ? '?' + queryMap[chunkId] : '')\n      );\n    };\n    __webpack_require__.e = function (chunkId) {\n      var result = oldLoadScript(chunkId);\n      return result.catch(function (error) {\n        var retries = countMap.hasOwnProperty(chunkId) ? countMap[chunkId] : 3;\n        if (retries < 1) {\n          var realSrc = oldGetScript(chunkId);\n          error.message =\n            'Loading chunk ' +\n            chunkId +\n            ' failed after 3 retries.\\n(' +\n            realSrc +\n            ')';\n          error.request = realSrc;\n          throw error;\n        }\n        return new Promise(function (resolve) {\n          var retryAttempt = 3 - retries + 1;\n          setTimeout(function () {\n            var retryAttemptString = '&retry-attempt=' + retryAttempt;\n            var cacheBust = (() => Date.now())();\n            +retryAttemptString;\n            queryMap[chunkId] = cacheBust;\n            countMap[chunkId] = retries - 1;\n            resolve(__webpack_require__.e(chunkId));\n          }, getRetryDelay(retryAttempt));\n        });\n      });\n    };\n  }\n})();\n","if (typeof document === \"undefined\") return;\nvar createStylesheet = (chunkId, fullhref, oldTag, resolve, reject) => {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tif (__webpack_require__.nc) {\n\t\tlinkTag.nonce = __webpack_require__.nc;\n\t}\n\tvar onLinkComplete = (event) => {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && event.type;\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + errorType + \": \" + realHref + \")\");\n\t\t\terr.name = \"ChunkLoadError\";\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tif (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\n\tif (oldTag) {\n\t\toldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);\n\t} else {\n\t\tdocument.head.appendChild(linkTag);\n\t}\n\treturn linkTag;\n};\nvar findStylesheet = (href, fullhref) => {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = (chunkId) => {\n\treturn new Promise((resolve, reject) => {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, null, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t3023: 0\n};\n\n__webpack_require__.f.miniCss = (chunkId, promises) => {\n\tvar cssChunks = {\"1869\":1,\"5607\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(() => {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, (e) => {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr\n\n// no prefetching\n\n__webpack_require__.H.miniCss = (chunkId) => {\n\tif((!__webpack_require__.o(installedCssChunks, chunkId) || installedCssChunks[chunkId] === undefined) && /^(1869|3023|5607)$/.test(chunkId)) {\n\t\tinstalledCssChunks[chunkId] = null;\n\t\tvar link = document.createElement('link');\n\t\tlink.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tlink.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tlink.rel = \"preload\";\n\t\tlink.as = \"style\";\n\t\tlink.href = __webpack_require__.p + __webpack_require__.miniCssF(chunkId);\n\t\tdocument.head.appendChild(link);\n\t}\n};","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t3023: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n__webpack_require__.H.j = (chunkId) => {\n\tif((!__webpack_require__.o(installedChunks, chunkId) || installedChunks[chunkId] === undefined) && true) {\n\t\tinstalledChunks[chunkId] = null;\n\t\tvar link = document.createElement('link');\n\n\t\tlink.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tlink.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tlink.rel = \"preload\";\n\t\tlink.as = \"script\";\n\t\tlink.href = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\tdocument.head.appendChild(link);\n\t}\n};\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunksoc_connect\"] = self[\"webpackChunksoc_connect\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2020 The connect.socjsc.com Foundation C.I.C.\r\nCopyright 2019 Michael Telatynski <7t3chguy@gmail.com>\r\nCopyright 2018, 2019 New Vector Ltd\r\nCopyright 2017 Vector Creations Ltd\r\nCopyright 2015, 2016 OpenMarket Ltd\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport { logger } from \"matrix-js-sdk/src/logger\";\r\nimport { shouldPolyfill as shouldPolyFillIntlSegmenter } from \"@formatjs/intl-segmenter/should-polyfill\";\r\n\r\n// These are things that can run before the skin loads - be careful not to reference the react-sdk though.\r\nimport { parseQsFromFragment } from \"./url_utils\";\r\nimport \"./modernizr\";\r\n\r\n// Require common CSS here; this will make webpack process it into bundle.css.\r\n// Our own CSS (which is themed) is imported via separate webpack entry points\r\n// in webpack.config.js\r\n// eslint-disable-next-line @typescript-eslint/no-require-imports\r\nrequire(\"katex/dist/katex.css\");\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-require-imports\r\nrequire(\"./localstorage-fix\");\r\n\r\nasync function settled(...promises: Array<Promise<any>>): Promise<void> {\r\n    for (const prom of promises) {\r\n        try {\r\n            await prom;\r\n        } catch (e) {\r\n            logger.error(e);\r\n        }\r\n    }\r\n}\r\n\r\nfunction checkBrowserFeatures(): boolean {\r\n    if (!window.Modernizr) {\r\n        logger.error(\"Cannot check features - Modernizr global is missing.\");\r\n        return false;\r\n    }\r\n\r\n    // Custom checks atop Modernizr because it doesn't have checks in it for\r\n    // some features we depend on.\r\n    // Modernizr requires rules to be lowercase with no punctuation.\r\n    // ES2018: http://262.ecma-international.org/9.0/#sec-promise.prototype.finally\r\n    window.Modernizr.addTest(\"promiseprototypefinally\", () => typeof window.Promise?.prototype?.finally === \"function\");\r\n    // ES2020: http://262.ecma-international.org/#sec-promise.allsettled\r\n    window.Modernizr.addTest(\"promiseallsettled\", () => typeof window.Promise?.allSettled === \"function\");\r\n    // ES2024: https://2ality.com/2024/05/proposal-promise-with-resolvers.html\r\n    window.Modernizr.addTest(\"promisewithresolvers\", () => typeof window.Promise?.withResolvers === \"function\");\r\n    // ES2018: https://262.ecma-international.org/9.0/#sec-get-regexp.prototype.dotAll\r\n    window.Modernizr.addTest(\r\n        \"regexpdotall\",\r\n        () => window.RegExp?.prototype && !!Object.getOwnPropertyDescriptor(window.RegExp.prototype, \"dotAll\")?.get,\r\n    );\r\n    // ES2019: http://262.ecma-international.org/10.0/#sec-object.fromentries\r\n    window.Modernizr.addTest(\"objectfromentries\", () => typeof window.Object?.fromEntries === \"function\");\r\n    // ES2024: https://402.ecma-international.org/9.0/#sec-intl.segmenter\r\n    // The built-in modernizer 'intl' check only checks for the presence of the Intl object, not the Segmenter,\r\n    // and older Firefox has the former but not the latter, so we add our own.\r\n    // This is polyfilled now, but we still want to show the warning because we want to remove the polyfill\r\n    // at some point.\r\n    window.Modernizr.addTest(\"intlsegmenter\", () => typeof window.Intl?.Segmenter === \"function\");\r\n\r\n    // Basic test for WebAssembly support. We could also try instantiating a simple module,\r\n    // although this would start to make (more) assumptions about how rust-crypto loads its wasm.\r\n    window.Modernizr.addTest(\"wasm\", () => typeof WebAssembly === \"object\" && typeof WebAssembly.Module === \"function\");\r\n\r\n    // Check that the session is in a secure context otherwise most Crypto & WebRTC APIs will be unavailable\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/Window/isSecureContext\r\n    window.Modernizr.addTest(\"securecontext\", () => window.isSecureContext);\r\n\r\n    const featureList = Object.keys(window.Modernizr) as Array<keyof ModernizrStatic>;\r\n\r\n    let featureComplete = true;\r\n    for (const feature of featureList) {\r\n        if (window.Modernizr[feature] === undefined) {\r\n            logger.error(\r\n                \"Looked for feature '%s' but Modernizr has no results for this. \" + \"Has it been configured correctly?\",\r\n                feature,\r\n            );\r\n            return false;\r\n        }\r\n        if (window.Modernizr[feature] === false) {\r\n            logger.error(\"Browser missing feature: '%s'\", feature);\r\n            // toggle flag rather than return early so we log all missing features rather than just the first.\r\n            featureComplete = false;\r\n        }\r\n    }\r\n    return featureComplete;\r\n}\r\n\r\nconst supportedBrowser = checkBrowserFeatures();\r\n\r\n// React depends on Map & Set which we check for using modernizr's es6collections\r\n// if modernizr fails we may not have a functional react to show the error message.\r\n// try in react but fallback to an `alert`\r\n// We start loading stuff but don't block on it until as late as possible to allow\r\n// the browser to use as much parallelism as it can.\r\n// Load parallelism is based on research in https://github.com/element-hq/element-web/issues/12253\r\nasync function start(): Promise<void> {\r\n    if (shouldPolyFillIntlSegmenter()) {\r\n        await import(/* webpackChunkName: \"intl-segmenter-polyfill\" */ \"@formatjs/intl-segmenter/polyfill-force\");\r\n    }\r\n\r\n    // load init.ts async so that its code is not executed immediately and we can catch any exceptions\r\n    const {\r\n        rageshakePromise,\r\n        setupLogStorage,\r\n        preparePlatform,\r\n        loadConfig,\r\n        loadLanguage,\r\n        loadTheme,\r\n        loadApp,\r\n        loadModules,\r\n        loadPlugins,\r\n        showError,\r\n        showIncompatibleBrowser,\r\n        _t,\r\n        extractErrorMessageFromError,\r\n    } = await import(\r\n        /* webpackChunkName: \"init\" */\r\n        /* webpackPreload: true */\r\n        \"./init\"\r\n    );\r\n\r\n    // Now perform the next stage of initialisation. This has its own try/catch in which we render\r\n    // a react error page on failure.\r\n    try {\r\n        // give rageshake a chance to load/fail, we don't actually assert rageshake loads, we allow it to fail if no IDB\r\n        await settled(rageshakePromise);\r\n\r\n        const fragparts = parseQsFromFragment(window.location);\r\n\r\n        // don't try to redirect to the native apps if we're\r\n        // verifying a 3pid (but after we've loaded the config)\r\n        // or if the user is following a deep link\r\n        // (https://github.com/element-hq/element-web/issues/7378)\r\n        const preventRedirect = fragparts.params.client_secret || fragparts.location.length > 0;\r\n\r\n        if (!preventRedirect) {\r\n            const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n            const isAndroid = /Android/.test(navigator.userAgent);\r\n            if (isIos || isAndroid) {\r\n                if (document.cookie.indexOf(\"element_mobile_redirect_to_guide=false\") === -1) {\r\n                    window.location.href = \"mobile_guide/\";\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        // set the platform for react sdk\r\n        preparePlatform();\r\n        // load config requires the platform to be ready\r\n        const loadConfigPromise = loadConfig();\r\n        await settled(loadConfigPromise); // wait for it to settle\r\n        // keep initialising so that we can show any possible error with as many features (theme, i18n) as possible\r\n\r\n        // now that the config is ready, try to persist logs\r\n        const persistLogsPromise = setupLogStorage();\r\n\r\n        // Load language after loading config.json so that settingsDefaults.language can be applied\r\n        const loadLanguagePromise = loadLanguage();\r\n        // as quickly as we possibly can, set a default theme...\r\n        const loadThemePromise = loadTheme();\r\n        // await things settling so that any errors we have to render have features like i18n running\r\n        await settled(loadThemePromise, loadLanguagePromise);\r\n\r\n        const loadModulesPromise = loadModules();\r\n        await settled(loadModulesPromise);\r\n        const loadPluginsPromise = loadPlugins();\r\n        await settled(loadPluginsPromise);\r\n\r\n        let acceptBrowser = supportedBrowser;\r\n        if (!acceptBrowser && window.localStorage) {\r\n            acceptBrowser = Boolean(window.localStorage.getItem(\"mx_accepts_unsupported_browser\"));\r\n        }\r\n\r\n        // ##########################\r\n        // error handling begins here\r\n        // ##########################\r\n        if (!acceptBrowser) {\r\n            await new Promise<void>((resolve, reject) => {\r\n                logger.error(\"Browser is missing required features.\");\r\n                // take to a different landing page to AWOOOOOGA at the user\r\n                showIncompatibleBrowser(() => {\r\n                    if (window.localStorage) {\r\n                        window.localStorage.setItem(\"mx_accepts_unsupported_browser\", String(true));\r\n                    }\r\n                    logger.log(\"User accepts the compatibility risks.\");\r\n                    resolve();\r\n                }).catch(reject);\r\n            });\r\n        }\r\n\r\n        try {\r\n            // await config here\r\n            await loadConfigPromise;\r\n        } catch (error) {\r\n            // Now that we've loaded the theme (CSS), display the config syntax error if needed.\r\n            if (error instanceof SyntaxError) {\r\n                // This uses the default brand since the app config is unavailable.\r\n                return showError(_t(\"error|misconfigured\"), [\r\n                    _t(\"error|invalid_json\"),\r\n                    _t(\"error|invalid_json_detail\", {\r\n                        message: error.message || _t(\"error|invalid_json_generic\"),\r\n                    }),\r\n                ]);\r\n            }\r\n            return showError(_t(\"error|cannot_load_config\"));\r\n        }\r\n\r\n        // ##################################\r\n        // app load critical path starts here\r\n        // assert things started successfully\r\n        // ##################################\r\n        await loadPluginsPromise;\r\n        await loadModulesPromise;\r\n        await loadThemePromise;\r\n        await loadLanguagePromise;\r\n\r\n        // We don't care if the log persistence made it through successfully, but we do want to\r\n        // make sure it had a chance to load before we move on. It's prepared much higher up in\r\n        // the process, making this the first time we check that it did something.\r\n        await settled(persistLogsPromise);\r\n\r\n        // Finally, load the app. All of the other react-sdk imports are in this file which causes the skinner to\r\n        // run on the components.\r\n        await loadApp(fragparts.params);\r\n    } catch (err) {\r\n        logger.error(err);\r\n        // Like the compatibility page, AWOOOOOGA at the user\r\n        // This uses the default brand since the app config is unavailable.\r\n        await showError(_t(\"error|misconfigured\"), [\r\n            extractErrorMessageFromError(err, _t(\"error|app_launch_unexpected_error\")),\r\n        ]);\r\n    }\r\n}\r\n\r\nstart().catch((err) => {\r\n    // If we get here, things have gone terribly wrong and we cannot load the app javascript at all.\r\n    // Show a different, very simple iframed-static error page. Or actually, one of two different ones\r\n    // depending on whether the browser is supported (ie. we think we should be able to load but\r\n    // failed) or unsupported (where we tried anyway and, lo and behold, we failed).\r\n    logger.error(err);\r\n    // show the static error in an iframe to not lose any context / console data\r\n    // with some basic styling to make the iframe full page\r\n    document.body.style.removeProperty(\"height\");\r\n    const iframe = document.createElement(\"iframe\");\r\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n    // @ts-ignore - typescript seems to only like the IE syntax for iframe sandboxing\r\n    iframe[\"sandbox\"] = \"\";\r\n    iframe.src = supportedBrowser ? \"static/unable-to-load.html\" : \"static/incompatible-browser.html\";\r\n    iframe.style.width = \"100%\";\r\n    iframe.style.height = \"100%\";\r\n    iframe.style.position = \"absolute\";\r\n    iframe.style.top = \"0\";\r\n    iframe.style.left = \"0\";\r\n    iframe.style.right = \"0\";\r\n    iframe.style.bottom = \"0\";\r\n    iframe.style.border = \"0\";\r\n    document.getElementById(\"matrixchat\")?.appendChild(iframe);\r\n});\r\n"],"names":["leafPrototypes","getProto","inProgress","dataWebpackPrefix","chunkToChildrenMap","_defineProperty","e","r","t","Object","defineProperty","value","enumerable","configurable","writable","toPrimitive","Symbol","i","call","TypeError","String","Number","toPropertyKey","_typeof","o","iterator","constructor","prototype","exports","Intl","Segmenter","noop","undefinedType","isIE","window","navigator","test","userAgent","logMethods","_loggersByName","defaultLogger","bindMethod","obj","methodName","method","bind","Function","apply","arguments","traceForIE","console","log","trace","realMethod","undefined","replaceLoggingMethods","level","this","getLevel","length","methodFactory","name","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","Logger","factory","inheritedLevel","defaultLevel","userLevel","self","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","location","indexOf","exec","slice","clearPersistedLevel","removeItem","normalizeLevel","input","setLevel","persist","setDefaultLevel","resetLevel","enableAll","TRACE","disableAll","rebuild","childName","initialLevel","getLogger","logger","_log","noConflict","getLoggers","LocationAssetType","M_ASSET","UnstableValue","M_TIMESTAMP","M_LOCATION","ReceiptType","MAIN_ROOM_TIMELINE","NamespacedValue","stable","unstable","Error","altName","names","push","matches","val","findIn","includedIn","arr","included","includes","ServerControlledNamespacedValue","args","setPreferUnstable","preferUnstable","super","loglevel","logLevel","loggerName","prefix","unshift","getPrefixedLogger","prefixLogger","getChild","childPrefix","childLogger","DEBUG","LogSpan","parent","msg","info","warn","error","interns","Map","internaliseString","str","toString","has","set","get","encodeParams","params","urlSearchParams","searchParams","URLSearchParams","key","entries","Array","isArray","forEach","v","append","replaceParam","dict","result","_objectSpread","decodeParams","query","keys","getAll","encodeUri","pathTemplate","variables","hasOwnProperty","replace","removeElement","array","fn","reverse","splice","checkObjectHasKeys","deepCopy","JSON","parse","stringify","deepCompare","x","y","isNaN","RegExp","Date","p","deepSortedObjectEntries","pairs","k","sort","a","b","lexicographicCompare","isNumber","isFinite","removeHiddenChars","unhomoglyph","normalize","removeHiddenCharsRegex","removeDirectionOverrideChars","toLowerCase","escapeRegExp","string","globToRegexp","glob","ensureNoTrailingSlash","url","endsWith","sleep","ms","Promise","resolve","setTimeout","async","logDuration","block","start","now","end","logDurationSync","isNullOrUndefined","defer","withResolvers","promiseMapSeries","promises","promiseTry","simpleRetryOperation","promiseFn","promiseRetry","attempt","forever","factor","minTimeout","maxTimeout","DEFAULT_ALPHABET","c","fromCharCode","alphabetPad","s","n","alphabet","padEnd","baseToString","len","BigInt","_alphabet","d","Math","abs","stringToBase","j","charIndex","charCodeAt","averageBetweenStrings","padN","max","baseA","baseB","avg","nextString","prevString","recursivelyAssign","target","source","ignoreNullish","sourceKey","sourceValue","safeSet","getContentTimestampWithFallback","event","_M_TIMESTAMP$findIn","getContent","sortEventsByLatestContentTimestamp","left","right","isSupportedReceiptType","receiptType","Read","ReadPrivate","mapsEqual","eq","v1","v2","size","processMapToObjectValue","recursiveMapToObject","map","targetMap","fromEntries","unsafeProp","prop","noUnsafeEventProps","room_id","sender","event_id","MapWithDefault","createDefault","getOrCreate","retry","networkErrorMsgs","AbortError","message","originalError","stack","pRetry","options","reject","onFailedAttempt","retries","operation","attemptNumber","stop","errorMessage","retriesLeft","decorateErrorWithCounts","mainError","module","RetryOperation","timeouts","Infinity","unref","maxRetryTime","concat","opts","randomize","createTimeout","random","timeout","round","pow","min","wrap","methods","original","op","callback","pop","err","_originalTimeouts","_timeouts","_options","_maxRetryTime","_fn","_errors","_attempts","_operationTimeout","_operationTimeoutCb","_timeout","_operationStart","_timer","_cachedTimeouts","reset","clearTimeout","currentTime","getTime","shift","timeoutOps","cb","try","errors","attempts","counts","mainErrorCount","count","data","REPLACE_RE","join","replace_fn","match","startsWith","scriptGlobalObject","tests","ModernizrProto","_version","_config","_q","on","addTest","addAsyncTest","Modernizr","classes","is","type","omPrefixes","cssomPrefixes","usePrefixes","split","_cssomPrefixes","docElement","documentElement","isSVG","nodeName","createElement","createElementNS","modElem","elem","mStyle","style","injectElementWithStyles","rule","nodes","testnames","ret","node","docOverflow","mod","div","body","fake","getBody","parseInt","id","appendChild","styleSheet","cssText","createTextNode","background","overflow","parentNode","removeChild","offsetHeight","domToCSS","m1","nativeTestProps","props","CSS","supports","conditionText","pseudo","getComputedStyle","getPropertyValue","currentStyle","computedStyle","cssToDOM","m2","domPrefixes","fnBind","that","testPropsAll","prefixed","skipValueTest","ucProp","charAt","afterInit","propsLength","before","elems","cleanElems","testProps","item","testDOMProps","testAllProps","_domPrefixes","testStyles","child","childNodes","offsetLeft","aliases","prefixes","_prefixes","newSyntax","oldSyntax","el","documentMode","atRule","cssrule","CSSRule","hasOwnProp","_hasOwnProperty","feature","featureNameSplit","last","Boolean","className","classPrefix","baseVal","enableJSClass","reJS","enableClasses","setClasses","_trigger","canParseISODate","toISOString","toJSON","create","getPrototypeOf","getOwnPropertyNames","isSealed","isFrozen","isExtensible","getOwnPropertyDescriptor","defineProperties","seal","freeze","preventExtensions","originalUndefined","copyWithin","fill","find","findIndex","values","from","of","Set","WeakMap","WeakSet","fromCodePoint","raw","codePointAt","repeat","createSVGRect","object","property","_l","res","cbs","implementation","hasFeature","SVGFEColorMatrixElement","SVG_FECOLORMATRIX_TYPE_SATURATE","URL","href","XMLHttpRequest","crypto","setItem","unprefixed","featureNames","aliasIdx","nameIdx","featureIdx","testRunner","parseQsFromFragment","hashparts","hash","substring","decodeURIComponent","parseQs","search","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","m","amdD","amdO","H","G","chunkId","getter","__esModule","mode","then","ns","def","current","definition","f","all","reduce","u","h","miniCssF","g","globalThis","l","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","setAttribute","src","onScriptComplete","prev","onerror","onload","doneFns","head","toStringTag","nmd","paths","children","wasmModuleId","wasmModuleHash","importsObj","req","fetch","fallback","arrayBuffer","bytes","WebAssembly","instantiate","assign","instance","instantiateStreaming","headers","scriptUrl","importScripts","currentScript","tagName","oldGetScript","oldLoadScript","queryMap","countMap","catch","realSrc","request","cacheBust","loadStylesheet","fullhref","existingLinkTags","dataHref","tag","rel","existingStyleTags","findStylesheet","oldTag","linkTag","nonce","errorType","realHref","code","insertBefore","nextSibling","createStylesheet","installedCssChunks","miniCss","link","as","baseURI","installedChunks","installedChunkData","promise","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","some","chunkLoadingGlobal","preload","chunks","settled","prom","require","supportedBrowser","_window$Promise","finally","_window$Promise2","allSettled","_window$Promise3","_window$RegExp","_Object$getOwnPropert","_window$Object","_window$Intl","Module","isSecureContext","featureList","featureComplete","checkBrowserFeatures","shouldPolyFillIntlSegmenter","rageshakePromise","setupLogStorage","preparePlatform","loadConfig","loadLanguage","loadTheme","loadApp","loadModules","loadPlugins","showError","showIncompatibleBrowser","_t","extractErrorMessageFromError","fragparts","client_secret","isIos","MSStream","isAndroid","loadConfigPromise","persistLogsPromise","loadLanguagePromise","loadThemePromise","loadModulesPromise","loadPluginsPromise","acceptBrowser","getItem","SyntaxError","_document$getElementB","removeProperty","iframe","width","height","position","top","bottom","border","getElementById"],"sourceRoot":""}